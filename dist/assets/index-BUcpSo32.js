function fj(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function pj(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var F0={exports:{}},Yc={},U0={exports:{}},we={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Do=Symbol.for("react.element"),gj=Symbol.for("react.portal"),xj=Symbol.for("react.fragment"),yj=Symbol.for("react.strict_mode"),vj=Symbol.for("react.profiler"),wj=Symbol.for("react.provider"),bj=Symbol.for("react.context"),Nj=Symbol.for("react.forward_ref"),jj=Symbol.for("react.suspense"),_j=Symbol.for("react.memo"),Sj=Symbol.for("react.lazy"),eg=Symbol.iterator;function Ej(t){return t===null||typeof t!="object"?null:(t=eg&&t[eg]||t["@@iterator"],typeof t=="function"?t:null)}var B0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$0=Object.assign,z0={};function Ki(t,e,r){this.props=t,this.context=e,this.refs=z0,this.updater=r||B0}Ki.prototype.isReactComponent={};Ki.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ki.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function q0(){}q0.prototype=Ki.prototype;function hm(t,e,r){this.props=t,this.context=e,this.refs=z0,this.updater=r||B0}var mm=hm.prototype=new q0;mm.constructor=hm;$0(mm,Ki.prototype);mm.isPureReactComponent=!0;var tg=Array.isArray,W0=Object.prototype.hasOwnProperty,fm={current:null},H0={key:!0,ref:!0,__self:!0,__source:!0};function K0(t,e,r){var n,i={},a=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)W0.call(e,n)&&!H0.hasOwnProperty(n)&&(i[n]=e[n]);var c=arguments.length-2;if(c===1)i.children=r;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];i.children=u}if(t&&t.defaultProps)for(n in c=t.defaultProps,c)i[n]===void 0&&(i[n]=c[n]);return{$$typeof:Do,type:t,key:a,ref:o,props:i,_owner:fm.current}}function Cj(t,e){return{$$typeof:Do,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function pm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Do}function kj(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var rg=/\/+/g;function rd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?kj(""+t.key):e.toString(36)}function $l(t,e,r,n,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Do:case gj:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+rd(o,0):n,tg(i)?(r="",t!=null&&(r=t.replace(rg,"$&/")+"/"),$l(i,e,r,"",function(d){return d})):i!=null&&(pm(i)&&(i=Cj(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(rg,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",tg(t))for(var c=0;c<t.length;c++){a=t[c];var u=n+rd(a,c);o+=$l(a,e,r,u,i)}else if(u=Ej(t),typeof u=="function")for(t=u.call(t),c=0;!(a=t.next()).done;)a=a.value,u=n+rd(a,c++),o+=$l(a,e,r,u,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function vl(t,e,r){if(t==null)return t;var n=[],i=0;return $l(t,n,"","",function(a){return e.call(r,a,i++)}),n}function Ij(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ut={current:null},zl={transition:null},Tj={ReactCurrentDispatcher:Ut,ReactCurrentBatchConfig:zl,ReactCurrentOwner:fm};function G0(){throw Error("act(...) is not supported in production builds of React.")}we.Children={map:vl,forEach:function(t,e,r){vl(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return vl(t,function(){e++}),e},toArray:function(t){return vl(t,function(e){return e})||[]},only:function(t){if(!pm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};we.Component=Ki;we.Fragment=xj;we.Profiler=vj;we.PureComponent=hm;we.StrictMode=yj;we.Suspense=jj;we.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tj;we.act=G0;we.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=$0({},t.props),i=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=fm.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)W0.call(e,u)&&!H0.hasOwnProperty(u)&&(n[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];n.children=c}return{$$typeof:Do,type:t.type,key:i,ref:a,props:n,_owner:o}};we.createContext=function(t){return t={$$typeof:bj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:wj,_context:t},t.Consumer=t};we.createElement=K0;we.createFactory=function(t){var e=K0.bind(null,t);return e.type=t,e};we.createRef=function(){return{current:null}};we.forwardRef=function(t){return{$$typeof:Nj,render:t}};we.isValidElement=pm;we.lazy=function(t){return{$$typeof:Sj,_payload:{_status:-1,_result:t},_init:Ij}};we.memo=function(t,e){return{$$typeof:_j,type:t,compare:e===void 0?null:e}};we.startTransition=function(t){var e=zl.transition;zl.transition={};try{t()}finally{zl.transition=e}};we.unstable_act=G0;we.useCallback=function(t,e){return Ut.current.useCallback(t,e)};we.useContext=function(t){return Ut.current.useContext(t)};we.useDebugValue=function(){};we.useDeferredValue=function(t){return Ut.current.useDeferredValue(t)};we.useEffect=function(t,e){return Ut.current.useEffect(t,e)};we.useId=function(){return Ut.current.useId()};we.useImperativeHandle=function(t,e,r){return Ut.current.useImperativeHandle(t,e,r)};we.useInsertionEffect=function(t,e){return Ut.current.useInsertionEffect(t,e)};we.useLayoutEffect=function(t,e){return Ut.current.useLayoutEffect(t,e)};we.useMemo=function(t,e){return Ut.current.useMemo(t,e)};we.useReducer=function(t,e,r){return Ut.current.useReducer(t,e,r)};we.useRef=function(t){return Ut.current.useRef(t)};we.useState=function(t){return Ut.current.useState(t)};we.useSyncExternalStore=function(t,e,r){return Ut.current.useSyncExternalStore(t,e,r)};we.useTransition=function(){return Ut.current.useTransition()};we.version="18.3.1";U0.exports=we;var _=U0.exports;const Q0=pj(_),Aj=fj({__proto__:null,default:Q0},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pj=_,Rj=Symbol.for("react.element"),Dj=Symbol.for("react.fragment"),Oj=Object.prototype.hasOwnProperty,Lj=Pj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mj={key:!0,ref:!0,__self:!0,__source:!0};function Y0(t,e,r){var n,i={},a=null,o=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Oj.call(e,n)&&!Mj.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Rj,type:t,key:a,ref:o,props:i,_owner:Lj.current}}Yc.Fragment=Dj;Yc.jsx=Y0;Yc.jsxs=Y0;F0.exports=Yc;var s=F0.exports,$d={},J0={exports:{}},or={},X0={exports:{}},Z0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,L){var U=O.length;O.push(L);e:for(;0<U;){var M=U-1>>>1,V=O[M];if(0<i(V,L))O[M]=L,O[U]=V,U=M;else break e}}function r(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var L=O[0],U=O.pop();if(U!==L){O[0]=U;e:for(var M=0,V=O.length,z=V>>>1;M<z;){var K=2*(M+1)-1,X=O[K],Q=K+1,ie=O[Q];if(0>i(X,U))Q<V&&0>i(ie,X)?(O[M]=ie,O[Q]=U,M=Q):(O[M]=X,O[K]=U,M=K);else if(Q<V&&0>i(ie,U))O[M]=ie,O[Q]=U,M=Q;else break e}}return L}function i(O,L){var U=O.sortIndex-L.sortIndex;return U!==0?U:O.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],m=1,p=null,x=3,j=!1,I=!1,b=!1,R=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function f(O){for(var L=r(d);L!==null;){if(L.callback===null)n(d);else if(L.startTime<=O)n(d),L.sortIndex=L.expirationTime,e(u,L);else break;L=r(d)}}function E(O){if(b=!1,f(O),!I)if(r(u)!==null)I=!0,re(P);else{var L=r(d);L!==null&&ce(E,L.startTime-O)}}function P(O,L){I=!1,b&&(b=!1,v(w),w=-1),j=!0;var U=x;try{for(f(L),p=r(u);p!==null&&(!(p.expirationTime>L)||O&&!D());){var M=p.callback;if(typeof M=="function"){p.callback=null,x=p.priorityLevel;var V=M(p.expirationTime<=L);L=t.unstable_now(),typeof V=="function"?p.callback=V:p===r(u)&&n(u),f(L)}else n(u);p=r(u)}if(p!==null)var z=!0;else{var K=r(d);K!==null&&ce(E,K.startTime-L),z=!1}return z}finally{p=null,x=U,j=!1}}var F=!1,N=null,w=-1,T=5,A=-1;function D(){return!(t.unstable_now()-A<T)}function C(){if(N!==null){var O=t.unstable_now();A=O;var L=!0;try{L=N(!0,O)}finally{L?S():(F=!1,N=null)}}else F=!1}var S;if(typeof y=="function")S=function(){y(C)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,W=H.port2;H.port1.onmessage=C,S=function(){W.postMessage(null)}}else S=function(){R(C,0)};function re(O){N=O,F||(F=!0,S())}function ce(O,L){w=R(function(){O(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){I||j||(I=!0,re(P))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(O){switch(x){case 1:case 2:case 3:var L=3;break;default:L=x}var U=x;x=L;try{return O()}finally{x=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,L){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var U=x;x=O;try{return L()}finally{x=U}},t.unstable_scheduleCallback=function(O,L,U){var M=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?M+U:M):U=M,O){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=U+V,O={id:m++,callback:L,priorityLevel:O,startTime:U,expirationTime:V,sortIndex:-1},U>M?(O.sortIndex=U,e(d,O),r(u)===null&&O===r(d)&&(b?(v(w),w=-1):b=!0,ce(E,U-M))):(O.sortIndex=V,e(u,O),I||j||(I=!0,re(P))),O},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(O){var L=x;return function(){var U=x;x=L;try{return O.apply(this,arguments)}finally{x=U}}}})(Z0);X0.exports=Z0;var Vj=X0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fj=_,ar=Vj;function J(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ey=new Set,so={};function Vn(t,e){Ii(t,e),Ii(t+"Capture",e)}function Ii(t,e){for(so[t]=e,t=0;t<e.length;t++)ey.add(e[t])}var os=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zd=Object.prototype.hasOwnProperty,Uj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sg={},ng={};function Bj(t){return zd.call(ng,t)?!0:zd.call(sg,t)?!1:Uj.test(t)?ng[t]=!0:(sg[t]=!0,!1)}function $j(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zj(t,e,r,n){if(e===null||typeof e>"u"||$j(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Bt(t,e,r,n,i,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){yt[t]=new Bt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];yt[e]=new Bt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){yt[t]=new Bt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){yt[t]=new Bt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){yt[t]=new Bt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){yt[t]=new Bt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){yt[t]=new Bt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){yt[t]=new Bt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){yt[t]=new Bt(t,5,!1,t.toLowerCase(),null,!1,!1)});var gm=/[\-:]([a-z])/g;function xm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(gm,xm);yt[e]=new Bt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(gm,xm);yt[e]=new Bt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(gm,xm);yt[e]=new Bt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){yt[t]=new Bt(t,1,!1,t.toLowerCase(),null,!1,!1)});yt.xlinkHref=new Bt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){yt[t]=new Bt(t,1,!1,t.toLowerCase(),null,!0,!0)});function ym(t,e,r,n){var i=yt.hasOwnProperty(e)?yt[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zj(e,r,i,n)&&(r=null),n||i===null?Bj(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var gs=Fj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wl=Symbol.for("react.element"),si=Symbol.for("react.portal"),ni=Symbol.for("react.fragment"),vm=Symbol.for("react.strict_mode"),qd=Symbol.for("react.profiler"),ty=Symbol.for("react.provider"),ry=Symbol.for("react.context"),wm=Symbol.for("react.forward_ref"),Wd=Symbol.for("react.suspense"),Hd=Symbol.for("react.suspense_list"),bm=Symbol.for("react.memo"),Ss=Symbol.for("react.lazy"),sy=Symbol.for("react.offscreen"),ig=Symbol.iterator;function ja(t){return t===null||typeof t!="object"?null:(t=ig&&t[ig]||t["@@iterator"],typeof t=="function"?t:null)}var He=Object.assign,sd;function Pa(t){if(sd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);sd=e&&e[1]||""}return`
`+sd+t}var nd=!1;function id(t,e){if(!t||nd)return"";nd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),a=n.stack.split(`
`),o=i.length-1,c=a.length-1;1<=o&&0<=c&&i[o]!==a[c];)c--;for(;1<=o&&0<=c;o--,c--)if(i[o]!==a[c]){if(o!==1||c!==1)do if(o--,c--,0>c||i[o]!==a[c]){var u=`
`+i[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{nd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Pa(t):""}function qj(t){switch(t.tag){case 5:return Pa(t.type);case 16:return Pa("Lazy");case 13:return Pa("Suspense");case 19:return Pa("SuspenseList");case 0:case 2:case 15:return t=id(t.type,!1),t;case 11:return t=id(t.type.render,!1),t;case 1:return t=id(t.type,!0),t;default:return""}}function Kd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ni:return"Fragment";case si:return"Portal";case qd:return"Profiler";case vm:return"StrictMode";case Wd:return"Suspense";case Hd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ry:return(t.displayName||"Context")+".Consumer";case ty:return(t._context.displayName||"Context")+".Provider";case wm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case bm:return e=t.displayName||null,e!==null?e:Kd(t.type)||"Memo";case Ss:e=t._payload,t=t._init;try{return Kd(t(e))}catch{}}return null}function Wj(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kd(e);case 8:return e===vm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ys(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ny(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Hj(t){var e=ny(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function bl(t){t._valueTracker||(t._valueTracker=Hj(t))}function iy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=ny(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function cc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Gd(t,e){var r=e.checked;return He({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function ag(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ys(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ay(t,e){e=e.checked,e!=null&&ym(t,"checked",e,!1)}function Qd(t,e){ay(t,e);var r=Ys(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Yd(t,e.type,r):e.hasOwnProperty("defaultValue")&&Yd(t,e.type,Ys(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function og(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Yd(t,e,r){(e!=="number"||cc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ra=Array.isArray;function gi(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ys(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Jd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(J(91));return He({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lg(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(J(92));if(Ra(r)){if(1<r.length)throw Error(J(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ys(r)}}function oy(t,e){var r=Ys(e.value),n=Ys(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function cg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ly(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ly(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Nl,cy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Nl=Nl||document.createElement("div"),Nl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Nl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function no(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var za={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kj=["Webkit","ms","Moz","O"];Object.keys(za).forEach(function(t){Kj.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),za[e]=za[t]})});function uy(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||za.hasOwnProperty(t)&&za[t]?(""+e).trim():e+"px"}function dy(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=uy(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Gj=He({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zd(t,e){if(e){if(Gj[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(J(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(J(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(J(61))}if(e.style!=null&&typeof e.style!="object")throw Error(J(62))}}function eh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var th=null;function Nm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var rh=null,xi=null,yi=null;function ug(t){if(t=Mo(t)){if(typeof rh!="function")throw Error(J(280));var e=t.stateNode;e&&(e=tu(e),rh(t.stateNode,t.type,e))}}function hy(t){xi?yi?yi.push(t):yi=[t]:xi=t}function my(){if(xi){var t=xi,e=yi;if(yi=xi=null,ug(t),e)for(t=0;t<e.length;t++)ug(e[t])}}function fy(t,e){return t(e)}function py(){}var ad=!1;function gy(t,e,r){if(ad)return t(e,r);ad=!0;try{return fy(t,e,r)}finally{ad=!1,(xi!==null||yi!==null)&&(py(),my())}}function io(t,e){var r=t.stateNode;if(r===null)return null;var n=tu(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(J(231,e,typeof r));return r}var sh=!1;if(os)try{var _a={};Object.defineProperty(_a,"passive",{get:function(){sh=!0}}),window.addEventListener("test",_a,_a),window.removeEventListener("test",_a,_a)}catch{sh=!1}function Qj(t,e,r,n,i,a,o,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(m){this.onError(m)}}var qa=!1,uc=null,dc=!1,nh=null,Yj={onError:function(t){qa=!0,uc=t}};function Jj(t,e,r,n,i,a,o,c,u){qa=!1,uc=null,Qj.apply(Yj,arguments)}function Xj(t,e,r,n,i,a,o,c,u){if(Jj.apply(this,arguments),qa){if(qa){var d=uc;qa=!1,uc=null}else throw Error(J(198));dc||(dc=!0,nh=d)}}function Fn(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function xy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function dg(t){if(Fn(t)!==t)throw Error(J(188))}function Zj(t){var e=t.alternate;if(!e){if(e=Fn(t),e===null)throw Error(J(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return dg(i),t;if(a===n)return dg(i),e;a=a.sibling}throw Error(J(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,c=i.child;c;){if(c===r){o=!0,r=i,n=a;break}if(c===n){o=!0,n=i,r=a;break}c=c.sibling}if(!o){for(c=a.child;c;){if(c===r){o=!0,r=a,n=i;break}if(c===n){o=!0,n=a,r=i;break}c=c.sibling}if(!o)throw Error(J(189))}}if(r.alternate!==n)throw Error(J(190))}if(r.tag!==3)throw Error(J(188));return r.stateNode.current===r?t:e}function yy(t){return t=Zj(t),t!==null?vy(t):null}function vy(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=vy(t);if(e!==null)return e;t=t.sibling}return null}var wy=ar.unstable_scheduleCallback,hg=ar.unstable_cancelCallback,e_=ar.unstable_shouldYield,t_=ar.unstable_requestPaint,Je=ar.unstable_now,r_=ar.unstable_getCurrentPriorityLevel,jm=ar.unstable_ImmediatePriority,by=ar.unstable_UserBlockingPriority,hc=ar.unstable_NormalPriority,s_=ar.unstable_LowPriority,Ny=ar.unstable_IdlePriority,Jc=null,Mr=null;function n_(t){if(Mr&&typeof Mr.onCommitFiberRoot=="function")try{Mr.onCommitFiberRoot(Jc,t,void 0,(t.current.flags&128)===128)}catch{}}var Er=Math.clz32?Math.clz32:o_,i_=Math.log,a_=Math.LN2;function o_(t){return t>>>=0,t===0?32:31-(i_(t)/a_|0)|0}var jl=64,_l=4194304;function Da(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function mc(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,a=t.pingedLanes,o=r&268435455;if(o!==0){var c=o&~i;c!==0?n=Da(c):(a&=o,a!==0&&(n=Da(a)))}else o=r&~i,o!==0?n=Da(o):a!==0&&(n=Da(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Er(e),i=1<<r,n|=t[r],e&=~i;return n}function l_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function c_(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-Er(a),c=1<<o,u=i[o];u===-1?(!(c&r)||c&n)&&(i[o]=l_(c,e)):u<=e&&(t.expiredLanes|=c),a&=~c}}function ih(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function jy(){var t=jl;return jl<<=1,!(jl&4194240)&&(jl=64),t}function od(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Oo(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Er(e),t[e]=r}function u_(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Er(r),a=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~a}}function _m(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Er(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Te=0;function _y(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Sy,Sm,Ey,Cy,ky,ah=!1,Sl=[],Ms=null,Vs=null,Fs=null,ao=new Map,oo=new Map,Cs=[],d_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mg(t,e){switch(t){case"focusin":case"focusout":Ms=null;break;case"dragenter":case"dragleave":Vs=null;break;case"mouseover":case"mouseout":Fs=null;break;case"pointerover":case"pointerout":ao.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":oo.delete(e.pointerId)}}function Sa(t,e,r,n,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},e!==null&&(e=Mo(e),e!==null&&Sm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function h_(t,e,r,n,i){switch(e){case"focusin":return Ms=Sa(Ms,t,e,r,n,i),!0;case"dragenter":return Vs=Sa(Vs,t,e,r,n,i),!0;case"mouseover":return Fs=Sa(Fs,t,e,r,n,i),!0;case"pointerover":var a=i.pointerId;return ao.set(a,Sa(ao.get(a)||null,t,e,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,oo.set(a,Sa(oo.get(a)||null,t,e,r,n,i)),!0}return!1}function Iy(t){var e=yn(t.target);if(e!==null){var r=Fn(e);if(r!==null){if(e=r.tag,e===13){if(e=xy(r),e!==null){t.blockedOn=e,ky(t.priority,function(){Ey(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ql(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=oh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);th=n,r.target.dispatchEvent(n),th=null}else return e=Mo(r),e!==null&&Sm(e),t.blockedOn=r,!1;e.shift()}return!0}function fg(t,e,r){ql(t)&&r.delete(e)}function m_(){ah=!1,Ms!==null&&ql(Ms)&&(Ms=null),Vs!==null&&ql(Vs)&&(Vs=null),Fs!==null&&ql(Fs)&&(Fs=null),ao.forEach(fg),oo.forEach(fg)}function Ea(t,e){t.blockedOn===e&&(t.blockedOn=null,ah||(ah=!0,ar.unstable_scheduleCallback(ar.unstable_NormalPriority,m_)))}function lo(t){function e(i){return Ea(i,t)}if(0<Sl.length){Ea(Sl[0],t);for(var r=1;r<Sl.length;r++){var n=Sl[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ms!==null&&Ea(Ms,t),Vs!==null&&Ea(Vs,t),Fs!==null&&Ea(Fs,t),ao.forEach(e),oo.forEach(e),r=0;r<Cs.length;r++)n=Cs[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Cs.length&&(r=Cs[0],r.blockedOn===null);)Iy(r),r.blockedOn===null&&Cs.shift()}var vi=gs.ReactCurrentBatchConfig,fc=!0;function f_(t,e,r,n){var i=Te,a=vi.transition;vi.transition=null;try{Te=1,Em(t,e,r,n)}finally{Te=i,vi.transition=a}}function p_(t,e,r,n){var i=Te,a=vi.transition;vi.transition=null;try{Te=4,Em(t,e,r,n)}finally{Te=i,vi.transition=a}}function Em(t,e,r,n){if(fc){var i=oh(t,e,r,n);if(i===null)xd(t,e,n,pc,r),mg(t,n);else if(h_(i,t,e,r,n))n.stopPropagation();else if(mg(t,n),e&4&&-1<d_.indexOf(t)){for(;i!==null;){var a=Mo(i);if(a!==null&&Sy(a),a=oh(t,e,r,n),a===null&&xd(t,e,n,pc,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else xd(t,e,n,null,r)}}var pc=null;function oh(t,e,r,n){if(pc=null,t=Nm(n),t=yn(t),t!==null)if(e=Fn(t),e===null)t=null;else if(r=e.tag,r===13){if(t=xy(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return pc=t,null}function Ty(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(r_()){case jm:return 1;case by:return 4;case hc:case s_:return 16;case Ny:return 536870912;default:return 16}default:return 16}}var Rs=null,Cm=null,Wl=null;function Ay(){if(Wl)return Wl;var t,e=Cm,r=e.length,n,i="value"in Rs?Rs.value:Rs.textContent,a=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[a-n];n++);return Wl=i.slice(t,1<n?1-n:void 0)}function Hl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function El(){return!0}function pg(){return!1}function lr(t){function e(r,n,i,a,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(r=t[c],this[c]=r?r(a):a[c]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?El:pg,this.isPropagationStopped=pg,this}return He(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=El)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=El)},persist:function(){},isPersistent:El}),e}var Gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},km=lr(Gi),Lo=He({},Gi,{view:0,detail:0}),g_=lr(Lo),ld,cd,Ca,Xc=He({},Lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Im,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ca&&(Ca&&t.type==="mousemove"?(ld=t.screenX-Ca.screenX,cd=t.screenY-Ca.screenY):cd=ld=0,Ca=t),ld)},movementY:function(t){return"movementY"in t?t.movementY:cd}}),gg=lr(Xc),x_=He({},Xc,{dataTransfer:0}),y_=lr(x_),v_=He({},Lo,{relatedTarget:0}),ud=lr(v_),w_=He({},Gi,{animationName:0,elapsedTime:0,pseudoElement:0}),b_=lr(w_),N_=He({},Gi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),j_=lr(N_),__=He({},Gi,{data:0}),xg=lr(__),S_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},E_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},C_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function k_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=C_[t])?!!e[t]:!1}function Im(){return k_}var I_=He({},Lo,{key:function(t){if(t.key){var e=S_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Hl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?E_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Im,charCode:function(t){return t.type==="keypress"?Hl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Hl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),T_=lr(I_),A_=He({},Xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yg=lr(A_),P_=He({},Lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Im}),R_=lr(P_),D_=He({},Gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),O_=lr(D_),L_=He({},Xc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),M_=lr(L_),V_=[9,13,27,32],Tm=os&&"CompositionEvent"in window,Wa=null;os&&"documentMode"in document&&(Wa=document.documentMode);var F_=os&&"TextEvent"in window&&!Wa,Py=os&&(!Tm||Wa&&8<Wa&&11>=Wa),vg=" ",wg=!1;function Ry(t,e){switch(t){case"keyup":return V_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dy(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ii=!1;function U_(t,e){switch(t){case"compositionend":return Dy(e);case"keypress":return e.which!==32?null:(wg=!0,vg);case"textInput":return t=e.data,t===vg&&wg?null:t;default:return null}}function B_(t,e){if(ii)return t==="compositionend"||!Tm&&Ry(t,e)?(t=Ay(),Wl=Cm=Rs=null,ii=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Py&&e.locale!=="ko"?null:e.data;default:return null}}var $_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$_[t.type]:e==="textarea"}function Oy(t,e,r,n){hy(n),e=gc(e,"onChange"),0<e.length&&(r=new km("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ha=null,co=null;function z_(t){Hy(t,0)}function Zc(t){var e=li(t);if(iy(e))return t}function q_(t,e){if(t==="change")return e}var Ly=!1;if(os){var dd;if(os){var hd="oninput"in document;if(!hd){var Ng=document.createElement("div");Ng.setAttribute("oninput","return;"),hd=typeof Ng.oninput=="function"}dd=hd}else dd=!1;Ly=dd&&(!document.documentMode||9<document.documentMode)}function jg(){Ha&&(Ha.detachEvent("onpropertychange",My),co=Ha=null)}function My(t){if(t.propertyName==="value"&&Zc(co)){var e=[];Oy(e,co,t,Nm(t)),gy(z_,e)}}function W_(t,e,r){t==="focusin"?(jg(),Ha=e,co=r,Ha.attachEvent("onpropertychange",My)):t==="focusout"&&jg()}function H_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Zc(co)}function K_(t,e){if(t==="click")return Zc(e)}function G_(t,e){if(t==="input"||t==="change")return Zc(e)}function Q_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var kr=typeof Object.is=="function"?Object.is:Q_;function uo(t,e){if(kr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!zd.call(e,i)||!kr(t[i],e[i]))return!1}return!0}function _g(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Sg(t,e){var r=_g(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_g(r)}}function Vy(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Vy(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Fy(){for(var t=window,e=cc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=cc(t.document)}return e}function Am(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Y_(t){var e=Fy(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Vy(r.ownerDocument.documentElement,r)){if(n!==null&&Am(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!t.extend&&a>n&&(i=n,n=a,a=i),i=Sg(r,a);var o=Sg(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var J_=os&&"documentMode"in document&&11>=document.documentMode,ai=null,lh=null,Ka=null,ch=!1;function Eg(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ch||ai==null||ai!==cc(n)||(n=ai,"selectionStart"in n&&Am(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ka&&uo(Ka,n)||(Ka=n,n=gc(lh,"onSelect"),0<n.length&&(e=new km("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=ai)))}function Cl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var oi={animationend:Cl("Animation","AnimationEnd"),animationiteration:Cl("Animation","AnimationIteration"),animationstart:Cl("Animation","AnimationStart"),transitionend:Cl("Transition","TransitionEnd")},md={},Uy={};os&&(Uy=document.createElement("div").style,"AnimationEvent"in window||(delete oi.animationend.animation,delete oi.animationiteration.animation,delete oi.animationstart.animation),"TransitionEvent"in window||delete oi.transitionend.transition);function eu(t){if(md[t])return md[t];if(!oi[t])return t;var e=oi[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Uy)return md[t]=e[r];return t}var By=eu("animationend"),$y=eu("animationiteration"),zy=eu("animationstart"),qy=eu("transitionend"),Wy=new Map,Cg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sn(t,e){Wy.set(t,e),Vn(e,[t])}for(var fd=0;fd<Cg.length;fd++){var pd=Cg[fd],X_=pd.toLowerCase(),Z_=pd[0].toUpperCase()+pd.slice(1);sn(X_,"on"+Z_)}sn(By,"onAnimationEnd");sn($y,"onAnimationIteration");sn(zy,"onAnimationStart");sn("dblclick","onDoubleClick");sn("focusin","onFocus");sn("focusout","onBlur");sn(qy,"onTransitionEnd");Ii("onMouseEnter",["mouseout","mouseover"]);Ii("onMouseLeave",["mouseout","mouseover"]);Ii("onPointerEnter",["pointerout","pointerover"]);Ii("onPointerLeave",["pointerout","pointerover"]);Vn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oa));function kg(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Xj(n,e,void 0,t),t.currentTarget=null}function Hy(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var o=n.length-1;0<=o;o--){var c=n[o],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==a&&i.isPropagationStopped())break e;kg(i,c,d),a=u}else for(o=0;o<n.length;o++){if(c=n[o],u=c.instance,d=c.currentTarget,c=c.listener,u!==a&&i.isPropagationStopped())break e;kg(i,c,d),a=u}}}if(dc)throw t=nh,dc=!1,nh=null,t}function Me(t,e){var r=e[fh];r===void 0&&(r=e[fh]=new Set);var n=t+"__bubble";r.has(n)||(Ky(e,t,2,!1),r.add(n))}function gd(t,e,r){var n=0;e&&(n|=4),Ky(r,t,n,e)}var kl="_reactListening"+Math.random().toString(36).slice(2);function ho(t){if(!t[kl]){t[kl]=!0,ey.forEach(function(r){r!=="selectionchange"&&(eS.has(r)||gd(r,!1,t),gd(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[kl]||(e[kl]=!0,gd("selectionchange",!1,e))}}function Ky(t,e,r,n){switch(Ty(e)){case 1:var i=f_;break;case 4:i=p_;break;default:i=Em}r=i.bind(null,e,r,t),i=void 0,!sh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function xd(t,e,r,n,i){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var c=n.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;c!==null;){if(o=yn(c),o===null)return;if(u=o.tag,u===5||u===6){n=a=o;continue e}c=c.parentNode}}n=n.return}gy(function(){var d=a,m=Nm(r),p=[];e:{var x=Wy.get(t);if(x!==void 0){var j=km,I=t;switch(t){case"keypress":if(Hl(r)===0)break e;case"keydown":case"keyup":j=T_;break;case"focusin":I="focus",j=ud;break;case"focusout":I="blur",j=ud;break;case"beforeblur":case"afterblur":j=ud;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=gg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=y_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=R_;break;case By:case $y:case zy:j=b_;break;case qy:j=O_;break;case"scroll":j=g_;break;case"wheel":j=M_;break;case"copy":case"cut":case"paste":j=j_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=yg}var b=(e&4)!==0,R=!b&&t==="scroll",v=b?x!==null?x+"Capture":null:x;b=[];for(var y=d,f;y!==null;){f=y;var E=f.stateNode;if(f.tag===5&&E!==null&&(f=E,v!==null&&(E=io(y,v),E!=null&&b.push(mo(y,E,f)))),R)break;y=y.return}0<b.length&&(x=new j(x,I,null,r,m),p.push({event:x,listeners:b}))}}if(!(e&7)){e:{if(x=t==="mouseover"||t==="pointerover",j=t==="mouseout"||t==="pointerout",x&&r!==th&&(I=r.relatedTarget||r.fromElement)&&(yn(I)||I[ls]))break e;if((j||x)&&(x=m.window===m?m:(x=m.ownerDocument)?x.defaultView||x.parentWindow:window,j?(I=r.relatedTarget||r.toElement,j=d,I=I?yn(I):null,I!==null&&(R=Fn(I),I!==R||I.tag!==5&&I.tag!==6)&&(I=null)):(j=null,I=d),j!==I)){if(b=gg,E="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(b=yg,E="onPointerLeave",v="onPointerEnter",y="pointer"),R=j==null?x:li(j),f=I==null?x:li(I),x=new b(E,y+"leave",j,r,m),x.target=R,x.relatedTarget=f,E=null,yn(m)===d&&(b=new b(v,y+"enter",I,r,m),b.target=f,b.relatedTarget=R,E=b),R=E,j&&I)t:{for(b=j,v=I,y=0,f=b;f;f=Xn(f))y++;for(f=0,E=v;E;E=Xn(E))f++;for(;0<y-f;)b=Xn(b),y--;for(;0<f-y;)v=Xn(v),f--;for(;y--;){if(b===v||v!==null&&b===v.alternate)break t;b=Xn(b),v=Xn(v)}b=null}else b=null;j!==null&&Ig(p,x,j,b,!1),I!==null&&R!==null&&Ig(p,R,I,b,!0)}}e:{if(x=d?li(d):window,j=x.nodeName&&x.nodeName.toLowerCase(),j==="select"||j==="input"&&x.type==="file")var P=q_;else if(bg(x))if(Ly)P=G_;else{P=H_;var F=W_}else(j=x.nodeName)&&j.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(P=K_);if(P&&(P=P(t,d))){Oy(p,P,r,m);break e}F&&F(t,x,d),t==="focusout"&&(F=x._wrapperState)&&F.controlled&&x.type==="number"&&Yd(x,"number",x.value)}switch(F=d?li(d):window,t){case"focusin":(bg(F)||F.contentEditable==="true")&&(ai=F,lh=d,Ka=null);break;case"focusout":Ka=lh=ai=null;break;case"mousedown":ch=!0;break;case"contextmenu":case"mouseup":case"dragend":ch=!1,Eg(p,r,m);break;case"selectionchange":if(J_)break;case"keydown":case"keyup":Eg(p,r,m)}var N;if(Tm)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else ii?Ry(t,r)&&(w="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(w="onCompositionStart");w&&(Py&&r.locale!=="ko"&&(ii||w!=="onCompositionStart"?w==="onCompositionEnd"&&ii&&(N=Ay()):(Rs=m,Cm="value"in Rs?Rs.value:Rs.textContent,ii=!0)),F=gc(d,w),0<F.length&&(w=new xg(w,t,null,r,m),p.push({event:w,listeners:F}),N?w.data=N:(N=Dy(r),N!==null&&(w.data=N)))),(N=F_?U_(t,r):B_(t,r))&&(d=gc(d,"onBeforeInput"),0<d.length&&(m=new xg("onBeforeInput","beforeinput",null,r,m),p.push({event:m,listeners:d}),m.data=N))}Hy(p,e)})}function mo(t,e,r){return{instance:t,listener:e,currentTarget:r}}function gc(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=io(t,r),a!=null&&n.unshift(mo(t,a,i)),a=io(t,e),a!=null&&n.push(mo(t,a,i))),t=t.return}return n}function Xn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ig(t,e,r,n,i){for(var a=e._reactName,o=[];r!==null&&r!==n;){var c=r,u=c.alternate,d=c.stateNode;if(u!==null&&u===n)break;c.tag===5&&d!==null&&(c=d,i?(u=io(r,a),u!=null&&o.unshift(mo(r,u,c))):i||(u=io(r,a),u!=null&&o.push(mo(r,u,c)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var tS=/\r\n?/g,rS=/\u0000|\uFFFD/g;function Tg(t){return(typeof t=="string"?t:""+t).replace(tS,`
`).replace(rS,"")}function Il(t,e,r){if(e=Tg(e),Tg(t)!==e&&r)throw Error(J(425))}function xc(){}var uh=null,dh=null;function hh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var mh=typeof setTimeout=="function"?setTimeout:void 0,sS=typeof clearTimeout=="function"?clearTimeout:void 0,Ag=typeof Promise=="function"?Promise:void 0,nS=typeof queueMicrotask=="function"?queueMicrotask:typeof Ag<"u"?function(t){return Ag.resolve(null).then(t).catch(iS)}:mh;function iS(t){setTimeout(function(){throw t})}function yd(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),lo(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);lo(e)}function Us(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Pg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Qi=Math.random().toString(36).slice(2),Or="__reactFiber$"+Qi,fo="__reactProps$"+Qi,ls="__reactContainer$"+Qi,fh="__reactEvents$"+Qi,aS="__reactListeners$"+Qi,oS="__reactHandles$"+Qi;function yn(t){var e=t[Or];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ls]||r[Or]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Pg(t);t!==null;){if(r=t[Or])return r;t=Pg(t)}return e}t=r,r=t.parentNode}return null}function Mo(t){return t=t[Or]||t[ls],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function li(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(J(33))}function tu(t){return t[fo]||null}var ph=[],ci=-1;function nn(t){return{current:t}}function Fe(t){0>ci||(t.current=ph[ci],ph[ci]=null,ci--)}function De(t,e){ci++,ph[ci]=t.current,t.current=e}var Js={},At=nn(Js),Gt=nn(!1),Sn=Js;function Ti(t,e){var r=t.type.contextTypes;if(!r)return Js;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Qt(t){return t=t.childContextTypes,t!=null}function yc(){Fe(Gt),Fe(At)}function Rg(t,e,r){if(At.current!==Js)throw Error(J(168));De(At,e),De(Gt,r)}function Gy(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(J(108,Wj(t)||"Unknown",i));return He({},r,n)}function vc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Js,Sn=At.current,De(At,t),De(Gt,Gt.current),!0}function Dg(t,e,r){var n=t.stateNode;if(!n)throw Error(J(169));r?(t=Gy(t,e,Sn),n.__reactInternalMemoizedMergedChildContext=t,Fe(Gt),Fe(At),De(At,t)):Fe(Gt),De(Gt,r)}var Yr=null,ru=!1,vd=!1;function Qy(t){Yr===null?Yr=[t]:Yr.push(t)}function lS(t){ru=!0,Qy(t)}function an(){if(!vd&&Yr!==null){vd=!0;var t=0,e=Te;try{var r=Yr;for(Te=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Yr=null,ru=!1}catch(i){throw Yr!==null&&(Yr=Yr.slice(t+1)),wy(jm,an),i}finally{Te=e,vd=!1}}return null}var ui=[],di=0,wc=null,bc=0,dr=[],hr=0,En=null,Jr=1,Xr="";function pn(t,e){ui[di++]=bc,ui[di++]=wc,wc=t,bc=e}function Yy(t,e,r){dr[hr++]=Jr,dr[hr++]=Xr,dr[hr++]=En,En=t;var n=Jr;t=Xr;var i=32-Er(n)-1;n&=~(1<<i),r+=1;var a=32-Er(e)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Jr=1<<32-Er(e)+i|r<<i|n,Xr=a+t}else Jr=1<<a|r<<i|n,Xr=t}function Pm(t){t.return!==null&&(pn(t,1),Yy(t,1,0))}function Rm(t){for(;t===wc;)wc=ui[--di],ui[di]=null,bc=ui[--di],ui[di]=null;for(;t===En;)En=dr[--hr],dr[hr]=null,Xr=dr[--hr],dr[hr]=null,Jr=dr[--hr],dr[hr]=null}var nr=null,rr=null,$e=!1,jr=null;function Jy(t,e){var r=mr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Og(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,nr=t,rr=Us(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,nr=t,rr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=En!==null?{id:Jr,overflow:Xr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=mr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,nr=t,rr=null,!0):!1;default:return!1}}function gh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function xh(t){if($e){var e=rr;if(e){var r=e;if(!Og(t,e)){if(gh(t))throw Error(J(418));e=Us(r.nextSibling);var n=nr;e&&Og(t,e)?Jy(n,r):(t.flags=t.flags&-4097|2,$e=!1,nr=t)}}else{if(gh(t))throw Error(J(418));t.flags=t.flags&-4097|2,$e=!1,nr=t}}}function Lg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;nr=t}function Tl(t){if(t!==nr)return!1;if(!$e)return Lg(t),$e=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hh(t.type,t.memoizedProps)),e&&(e=rr)){if(gh(t))throw Xy(),Error(J(418));for(;e;)Jy(t,e),e=Us(e.nextSibling)}if(Lg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(J(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){rr=Us(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}rr=null}}else rr=nr?Us(t.stateNode.nextSibling):null;return!0}function Xy(){for(var t=rr;t;)t=Us(t.nextSibling)}function Ai(){rr=nr=null,$e=!1}function Dm(t){jr===null?jr=[t]:jr.push(t)}var cS=gs.ReactCurrentBatchConfig;function ka(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(J(309));var n=r.stateNode}if(!n)throw Error(J(147,t));var i=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var c=i.refs;o===null?delete c[a]:c[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(J(284));if(!r._owner)throw Error(J(290,t))}return t}function Al(t,e){throw t=Object.prototype.toString.call(e),Error(J(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Mg(t){var e=t._init;return e(t._payload)}function Zy(t){function e(v,y){if(t){var f=v.deletions;f===null?(v.deletions=[y],v.flags|=16):f.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=qs(v,y),v.index=0,v.sibling=null,v}function a(v,y,f){return v.index=f,t?(f=v.alternate,f!==null?(f=f.index,f<y?(v.flags|=2,y):f):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function c(v,y,f,E){return y===null||y.tag!==6?(y=Ed(f,v.mode,E),y.return=v,y):(y=i(y,f),y.return=v,y)}function u(v,y,f,E){var P=f.type;return P===ni?m(v,y,f.props.children,E,f.key):y!==null&&(y.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ss&&Mg(P)===y.type)?(E=i(y,f.props),E.ref=ka(v,y,f),E.return=v,E):(E=Zl(f.type,f.key,f.props,null,v.mode,E),E.ref=ka(v,y,f),E.return=v,E)}function d(v,y,f,E){return y===null||y.tag!==4||y.stateNode.containerInfo!==f.containerInfo||y.stateNode.implementation!==f.implementation?(y=Cd(f,v.mode,E),y.return=v,y):(y=i(y,f.children||[]),y.return=v,y)}function m(v,y,f,E,P){return y===null||y.tag!==7?(y=jn(f,v.mode,E,P),y.return=v,y):(y=i(y,f),y.return=v,y)}function p(v,y,f){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Ed(""+y,v.mode,f),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case wl:return f=Zl(y.type,y.key,y.props,null,v.mode,f),f.ref=ka(v,null,y),f.return=v,f;case si:return y=Cd(y,v.mode,f),y.return=v,y;case Ss:var E=y._init;return p(v,E(y._payload),f)}if(Ra(y)||ja(y))return y=jn(y,v.mode,f,null),y.return=v,y;Al(v,y)}return null}function x(v,y,f,E){var P=y!==null?y.key:null;if(typeof f=="string"&&f!==""||typeof f=="number")return P!==null?null:c(v,y,""+f,E);if(typeof f=="object"&&f!==null){switch(f.$$typeof){case wl:return f.key===P?u(v,y,f,E):null;case si:return f.key===P?d(v,y,f,E):null;case Ss:return P=f._init,x(v,y,P(f._payload),E)}if(Ra(f)||ja(f))return P!==null?null:m(v,y,f,E,null);Al(v,f)}return null}function j(v,y,f,E,P){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(f)||null,c(y,v,""+E,P);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case wl:return v=v.get(E.key===null?f:E.key)||null,u(y,v,E,P);case si:return v=v.get(E.key===null?f:E.key)||null,d(y,v,E,P);case Ss:var F=E._init;return j(v,y,f,F(E._payload),P)}if(Ra(E)||ja(E))return v=v.get(f)||null,m(y,v,E,P,null);Al(y,E)}return null}function I(v,y,f,E){for(var P=null,F=null,N=y,w=y=0,T=null;N!==null&&w<f.length;w++){N.index>w?(T=N,N=null):T=N.sibling;var A=x(v,N,f[w],E);if(A===null){N===null&&(N=T);break}t&&N&&A.alternate===null&&e(v,N),y=a(A,y,w),F===null?P=A:F.sibling=A,F=A,N=T}if(w===f.length)return r(v,N),$e&&pn(v,w),P;if(N===null){for(;w<f.length;w++)N=p(v,f[w],E),N!==null&&(y=a(N,y,w),F===null?P=N:F.sibling=N,F=N);return $e&&pn(v,w),P}for(N=n(v,N);w<f.length;w++)T=j(N,v,w,f[w],E),T!==null&&(t&&T.alternate!==null&&N.delete(T.key===null?w:T.key),y=a(T,y,w),F===null?P=T:F.sibling=T,F=T);return t&&N.forEach(function(D){return e(v,D)}),$e&&pn(v,w),P}function b(v,y,f,E){var P=ja(f);if(typeof P!="function")throw Error(J(150));if(f=P.call(f),f==null)throw Error(J(151));for(var F=P=null,N=y,w=y=0,T=null,A=f.next();N!==null&&!A.done;w++,A=f.next()){N.index>w?(T=N,N=null):T=N.sibling;var D=x(v,N,A.value,E);if(D===null){N===null&&(N=T);break}t&&N&&D.alternate===null&&e(v,N),y=a(D,y,w),F===null?P=D:F.sibling=D,F=D,N=T}if(A.done)return r(v,N),$e&&pn(v,w),P;if(N===null){for(;!A.done;w++,A=f.next())A=p(v,A.value,E),A!==null&&(y=a(A,y,w),F===null?P=A:F.sibling=A,F=A);return $e&&pn(v,w),P}for(N=n(v,N);!A.done;w++,A=f.next())A=j(N,v,w,A.value,E),A!==null&&(t&&A.alternate!==null&&N.delete(A.key===null?w:A.key),y=a(A,y,w),F===null?P=A:F.sibling=A,F=A);return t&&N.forEach(function(C){return e(v,C)}),$e&&pn(v,w),P}function R(v,y,f,E){if(typeof f=="object"&&f!==null&&f.type===ni&&f.key===null&&(f=f.props.children),typeof f=="object"&&f!==null){switch(f.$$typeof){case wl:e:{for(var P=f.key,F=y;F!==null;){if(F.key===P){if(P=f.type,P===ni){if(F.tag===7){r(v,F.sibling),y=i(F,f.props.children),y.return=v,v=y;break e}}else if(F.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ss&&Mg(P)===F.type){r(v,F.sibling),y=i(F,f.props),y.ref=ka(v,F,f),y.return=v,v=y;break e}r(v,F);break}else e(v,F);F=F.sibling}f.type===ni?(y=jn(f.props.children,v.mode,E,f.key),y.return=v,v=y):(E=Zl(f.type,f.key,f.props,null,v.mode,E),E.ref=ka(v,y,f),E.return=v,v=E)}return o(v);case si:e:{for(F=f.key;y!==null;){if(y.key===F)if(y.tag===4&&y.stateNode.containerInfo===f.containerInfo&&y.stateNode.implementation===f.implementation){r(v,y.sibling),y=i(y,f.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=Cd(f,v.mode,E),y.return=v,v=y}return o(v);case Ss:return F=f._init,R(v,y,F(f._payload),E)}if(Ra(f))return I(v,y,f,E);if(ja(f))return b(v,y,f,E);Al(v,f)}return typeof f=="string"&&f!==""||typeof f=="number"?(f=""+f,y!==null&&y.tag===6?(r(v,y.sibling),y=i(y,f),y.return=v,v=y):(r(v,y),y=Ed(f,v.mode,E),y.return=v,v=y),o(v)):r(v,y)}return R}var Pi=Zy(!0),ev=Zy(!1),Nc=nn(null),jc=null,hi=null,Om=null;function Lm(){Om=hi=jc=null}function Mm(t){var e=Nc.current;Fe(Nc),t._currentValue=e}function yh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function wi(t,e){jc=t,Om=hi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Kt=!0),t.firstContext=null)}function pr(t){var e=t._currentValue;if(Om!==t)if(t={context:t,memoizedValue:e,next:null},hi===null){if(jc===null)throw Error(J(308));hi=t,jc.dependencies={lanes:0,firstContext:t}}else hi=hi.next=t;return e}var vn=null;function Vm(t){vn===null?vn=[t]:vn.push(t)}function tv(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Vm(e)):(r.next=i.next,i.next=r),e.interleaved=r,cs(t,n)}function cs(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Es=!1;function Fm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ns(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bs(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Se&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,cs(t,r)}return i=n.interleaved,i===null?(e.next=e,Vm(n)):(e.next=i.next,i.next=e),n.interleaved=e,cs(t,r)}function Kl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,_m(t,r)}}function Vg(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=e:a=a.next=e}else i=a=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function _c(t,e,r,n){var i=t.updateQueue;Es=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var u=c,d=u.next;u.next=null,o===null?a=d:o.next=d,o=u;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=d:c.next=d,m.lastBaseUpdate=u))}if(a!==null){var p=i.baseState;o=0,m=d=u=null,c=a;do{var x=c.lane,j=c.eventTime;if((n&x)===x){m!==null&&(m=m.next={eventTime:j,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var I=t,b=c;switch(x=e,j=r,b.tag){case 1:if(I=b.payload,typeof I=="function"){p=I.call(j,p,x);break e}p=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=b.payload,x=typeof I=="function"?I.call(j,p,x):I,x==null)break e;p=He({},p,x);break e;case 2:Es=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,x=i.effects,x===null?i.effects=[c]:x.push(c))}else j={eventTime:j,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(d=m=j,u=p):m=m.next=j,o|=x;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;x=c,c=x.next,x.next=null,i.lastBaseUpdate=x,i.shared.pending=null}}while(!0);if(m===null&&(u=p),i.baseState=u,i.firstBaseUpdate=d,i.lastBaseUpdate=m,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);kn|=o,t.lanes=o,t.memoizedState=p}}function Fg(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(J(191,i));i.call(n)}}}var Vo={},Vr=nn(Vo),po=nn(Vo),go=nn(Vo);function wn(t){if(t===Vo)throw Error(J(174));return t}function Um(t,e){switch(De(go,e),De(po,t),De(Vr,Vo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Xd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Xd(e,t)}Fe(Vr),De(Vr,e)}function Ri(){Fe(Vr),Fe(po),Fe(go)}function sv(t){wn(go.current);var e=wn(Vr.current),r=Xd(e,t.type);e!==r&&(De(po,t),De(Vr,r))}function Bm(t){po.current===t&&(Fe(Vr),Fe(po))}var ze=nn(0);function Sc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wd=[];function $m(){for(var t=0;t<wd.length;t++)wd[t]._workInProgressVersionPrimary=null;wd.length=0}var Gl=gs.ReactCurrentDispatcher,bd=gs.ReactCurrentBatchConfig,Cn=0,qe=null,rt=null,lt=null,Ec=!1,Ga=!1,xo=0,uS=0;function jt(){throw Error(J(321))}function zm(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!kr(t[r],e[r]))return!1;return!0}function qm(t,e,r,n,i,a){if(Cn=a,qe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Gl.current=t===null||t.memoizedState===null?fS:pS,t=r(n,i),Ga){a=0;do{if(Ga=!1,xo=0,25<=a)throw Error(J(301));a+=1,lt=rt=null,e.updateQueue=null,Gl.current=gS,t=r(n,i)}while(Ga)}if(Gl.current=Cc,e=rt!==null&&rt.next!==null,Cn=0,lt=rt=qe=null,Ec=!1,e)throw Error(J(300));return t}function Wm(){var t=xo!==0;return xo=0,t}function Dr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?qe.memoizedState=lt=t:lt=lt.next=t,lt}function gr(){if(rt===null){var t=qe.alternate;t=t!==null?t.memoizedState:null}else t=rt.next;var e=lt===null?qe.memoizedState:lt.next;if(e!==null)lt=e,rt=t;else{if(t===null)throw Error(J(310));rt=t,t={memoizedState:rt.memoizedState,baseState:rt.baseState,baseQueue:rt.baseQueue,queue:rt.queue,next:null},lt===null?qe.memoizedState=lt=t:lt=lt.next=t}return lt}function yo(t,e){return typeof e=="function"?e(t):e}function Nd(t){var e=gr(),r=e.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=t;var n=rt,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var c=o=null,u=null,d=a;do{var m=d.lane;if((Cn&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var p={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=p,o=n):u=u.next=p,qe.lanes|=m,kn|=m}d=d.next}while(d!==null&&d!==a);u===null?o=n:u.next=c,kr(n,e.memoizedState)||(Kt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=u,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do a=i.lane,qe.lanes|=a,kn|=a,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function jd(t){var e=gr(),r=e.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,a=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=t(a,o.action),o=o.next;while(o!==i);kr(a,e.memoizedState)||(Kt=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function nv(){}function iv(t,e){var r=qe,n=gr(),i=e(),a=!kr(n.memoizedState,i);if(a&&(n.memoizedState=i,Kt=!0),n=n.queue,Hm(lv.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||lt!==null&&lt.memoizedState.tag&1){if(r.flags|=2048,vo(9,ov.bind(null,r,n,i,e),void 0,null),ct===null)throw Error(J(349));Cn&30||av(r,e,i)}return i}function av(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=qe.updateQueue,e===null?(e={lastEffect:null,stores:null},qe.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function ov(t,e,r,n){e.value=r,e.getSnapshot=n,cv(e)&&uv(t)}function lv(t,e,r){return r(function(){cv(e)&&uv(t)})}function cv(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!kr(t,r)}catch{return!0}}function uv(t){var e=cs(t,1);e!==null&&Cr(e,t,1,-1)}function Ug(t){var e=Dr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yo,lastRenderedState:t},e.queue=t,t=t.dispatch=mS.bind(null,qe,t),[e.memoizedState,t]}function vo(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=qe.updateQueue,e===null?(e={lastEffect:null,stores:null},qe.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function dv(){return gr().memoizedState}function Ql(t,e,r,n){var i=Dr();qe.flags|=t,i.memoizedState=vo(1|e,r,void 0,n===void 0?null:n)}function su(t,e,r,n){var i=gr();n=n===void 0?null:n;var a=void 0;if(rt!==null){var o=rt.memoizedState;if(a=o.destroy,n!==null&&zm(n,o.deps)){i.memoizedState=vo(e,r,a,n);return}}qe.flags|=t,i.memoizedState=vo(1|e,r,a,n)}function Bg(t,e){return Ql(8390656,8,t,e)}function Hm(t,e){return su(2048,8,t,e)}function hv(t,e){return su(4,2,t,e)}function mv(t,e){return su(4,4,t,e)}function fv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function pv(t,e,r){return r=r!=null?r.concat([t]):null,su(4,4,fv.bind(null,e,t),r)}function Km(){}function gv(t,e){var r=gr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&zm(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function xv(t,e){var r=gr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&zm(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function yv(t,e,r){return Cn&21?(kr(r,e)||(r=jy(),qe.lanes|=r,kn|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Kt=!0),t.memoizedState=r)}function dS(t,e){var r=Te;Te=r!==0&&4>r?r:4,t(!0);var n=bd.transition;bd.transition={};try{t(!1),e()}finally{Te=r,bd.transition=n}}function vv(){return gr().memoizedState}function hS(t,e,r){var n=zs(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},wv(t))bv(e,r);else if(r=tv(t,e,r,n),r!==null){var i=Mt();Cr(r,t,n,i),Nv(r,e,n)}}function mS(t,e,r){var n=zs(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(wv(t))bv(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,c=a(o,r);if(i.hasEagerState=!0,i.eagerState=c,kr(c,o)){var u=e.interleaved;u===null?(i.next=i,Vm(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}r=tv(t,e,i,n),r!==null&&(i=Mt(),Cr(r,t,n,i),Nv(r,e,n))}}function wv(t){var e=t.alternate;return t===qe||e!==null&&e===qe}function bv(t,e){Ga=Ec=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Nv(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,_m(t,r)}}var Cc={readContext:pr,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useInsertionEffect:jt,useLayoutEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useMutableSource:jt,useSyncExternalStore:jt,useId:jt,unstable_isNewReconciler:!1},fS={readContext:pr,useCallback:function(t,e){return Dr().memoizedState=[t,e===void 0?null:e],t},useContext:pr,useEffect:Bg,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Ql(4194308,4,fv.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Ql(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ql(4,2,t,e)},useMemo:function(t,e){var r=Dr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Dr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=hS.bind(null,qe,t),[n.memoizedState,t]},useRef:function(t){var e=Dr();return t={current:t},e.memoizedState=t},useState:Ug,useDebugValue:Km,useDeferredValue:function(t){return Dr().memoizedState=t},useTransition:function(){var t=Ug(!1),e=t[0];return t=dS.bind(null,t[1]),Dr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=qe,i=Dr();if($e){if(r===void 0)throw Error(J(407));r=r()}else{if(r=e(),ct===null)throw Error(J(349));Cn&30||av(n,e,r)}i.memoizedState=r;var a={value:r,getSnapshot:e};return i.queue=a,Bg(lv.bind(null,n,a,t),[t]),n.flags|=2048,vo(9,ov.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=Dr(),e=ct.identifierPrefix;if($e){var r=Xr,n=Jr;r=(n&~(1<<32-Er(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=xo++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=uS++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},pS={readContext:pr,useCallback:gv,useContext:pr,useEffect:Hm,useImperativeHandle:pv,useInsertionEffect:hv,useLayoutEffect:mv,useMemo:xv,useReducer:Nd,useRef:dv,useState:function(){return Nd(yo)},useDebugValue:Km,useDeferredValue:function(t){var e=gr();return yv(e,rt.memoizedState,t)},useTransition:function(){var t=Nd(yo)[0],e=gr().memoizedState;return[t,e]},useMutableSource:nv,useSyncExternalStore:iv,useId:vv,unstable_isNewReconciler:!1},gS={readContext:pr,useCallback:gv,useContext:pr,useEffect:Hm,useImperativeHandle:pv,useInsertionEffect:hv,useLayoutEffect:mv,useMemo:xv,useReducer:jd,useRef:dv,useState:function(){return jd(yo)},useDebugValue:Km,useDeferredValue:function(t){var e=gr();return rt===null?e.memoizedState=t:yv(e,rt.memoizedState,t)},useTransition:function(){var t=jd(yo)[0],e=gr().memoizedState;return[t,e]},useMutableSource:nv,useSyncExternalStore:iv,useId:vv,unstable_isNewReconciler:!1};function br(t,e){if(t&&t.defaultProps){e=He({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function vh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:He({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var nu={isMounted:function(t){return(t=t._reactInternals)?Fn(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Mt(),i=zs(t),a=ns(n,i);a.payload=e,r!=null&&(a.callback=r),e=Bs(t,a,i),e!==null&&(Cr(e,t,i,n),Kl(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Mt(),i=zs(t),a=ns(n,i);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Bs(t,a,i),e!==null&&(Cr(e,t,i,n),Kl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Mt(),n=zs(t),i=ns(r,n);i.tag=2,e!=null&&(i.callback=e),e=Bs(t,i,n),e!==null&&(Cr(e,t,n,r),Kl(e,t,n))}};function $g(t,e,r,n,i,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,o):e.prototype&&e.prototype.isPureReactComponent?!uo(r,n)||!uo(i,a):!0}function jv(t,e,r){var n=!1,i=Js,a=e.contextType;return typeof a=="object"&&a!==null?a=pr(a):(i=Qt(e)?Sn:At.current,n=e.contextTypes,a=(n=n!=null)?Ti(t,i):Js),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=nu,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function zg(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&nu.enqueueReplaceState(e,e.state,null)}function wh(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Fm(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=pr(a):(a=Qt(e)?Sn:At.current,i.context=Ti(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(vh(t,e,a,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&nu.enqueueReplaceState(i,i.state,null),_c(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Di(t,e){try{var r="",n=e;do r+=qj(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function _d(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function bh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var xS=typeof WeakMap=="function"?WeakMap:Map;function _v(t,e,r){r=ns(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Ic||(Ic=!0,Ah=n),bh(t,e)},r}function Sv(t,e,r){r=ns(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){bh(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){bh(t,e),typeof n!="function"&&($s===null?$s=new Set([this]):$s.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function qg(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new xS;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=AS.bind(null,t,e,r),e.then(t,t))}function Wg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Hg(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ns(-1,1),e.tag=2,Bs(r,e,1))),r.lanes|=1),t)}var yS=gs.ReactCurrentOwner,Kt=!1;function Lt(t,e,r,n){e.child=t===null?ev(e,null,r,n):Pi(e,t.child,r,n)}function Kg(t,e,r,n,i){r=r.render;var a=e.ref;return wi(e,i),n=qm(t,e,r,n,a,i),r=Wm(),t!==null&&!Kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,us(t,e,i)):($e&&r&&Pm(e),e.flags|=1,Lt(t,e,n,i),e.child)}function Gg(t,e,r,n,i){if(t===null){var a=r.type;return typeof a=="function"&&!tf(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,Ev(t,e,a,n,i)):(t=Zl(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:uo,r(o,n)&&t.ref===e.ref)return us(t,e,i)}return e.flags|=1,t=qs(a,n),t.ref=e.ref,t.return=e,e.child=t}function Ev(t,e,r,n,i){if(t!==null){var a=t.memoizedProps;if(uo(a,n)&&t.ref===e.ref)if(Kt=!1,e.pendingProps=n=a,(t.lanes&i)!==0)t.flags&131072&&(Kt=!0);else return e.lanes=t.lanes,us(t,e,i)}return Nh(t,e,r,n,i)}function Cv(t,e,r){var n=e.pendingProps,i=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(fi,tr),tr|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,De(fi,tr),tr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,De(fi,tr),tr|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,De(fi,tr),tr|=n;return Lt(t,e,i,r),e.child}function kv(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Nh(t,e,r,n,i){var a=Qt(r)?Sn:At.current;return a=Ti(e,a),wi(e,i),r=qm(t,e,r,n,a,i),n=Wm(),t!==null&&!Kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,us(t,e,i)):($e&&n&&Pm(e),e.flags|=1,Lt(t,e,r,i),e.child)}function Qg(t,e,r,n,i){if(Qt(r)){var a=!0;vc(e)}else a=!1;if(wi(e,i),e.stateNode===null)Yl(t,e),jv(e,r,n),wh(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=pr(d):(d=Qt(r)?Sn:At.current,d=Ti(e,d));var m=r.getDerivedStateFromProps,p=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==n||u!==d)&&zg(e,o,n,d),Es=!1;var x=e.memoizedState;o.state=x,_c(e,n,o,i),u=e.memoizedState,c!==n||x!==u||Gt.current||Es?(typeof m=="function"&&(vh(e,r,m,n),u=e.memoizedState),(c=Es||$g(e,r,c,n,x,u,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=u),o.props=n,o.state=u,o.context=d,n=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,rv(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:br(e.type,c),o.props=d,p=e.pendingProps,x=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=pr(u):(u=Qt(r)?Sn:At.current,u=Ti(e,u));var j=r.getDerivedStateFromProps;(m=typeof j=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==p||x!==u)&&zg(e,o,n,u),Es=!1,x=e.memoizedState,o.state=x,_c(e,n,o,i);var I=e.memoizedState;c!==p||x!==I||Gt.current||Es?(typeof j=="function"&&(vh(e,r,j,n),I=e.memoizedState),(d=Es||$g(e,r,d,n,x,I,u)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,I,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,I,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=I),o.props=n,o.state=I,o.context=u,n=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(e.flags|=1024),n=!1)}return jh(t,e,r,n,a,i)}function jh(t,e,r,n,i,a){kv(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&Dg(e,r,!1),us(t,e,a);n=e.stateNode,yS.current=e;var c=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Pi(e,t.child,null,a),e.child=Pi(e,null,c,a)):Lt(t,e,c,a),e.memoizedState=n.state,i&&Dg(e,r,!0),e.child}function Iv(t){var e=t.stateNode;e.pendingContext?Rg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Rg(t,e.context,!1),Um(t,e.containerInfo)}function Yg(t,e,r,n,i){return Ai(),Dm(i),e.flags|=256,Lt(t,e,r,n),e.child}var _h={dehydrated:null,treeContext:null,retryLane:0};function Sh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Tv(t,e,r){var n=e.pendingProps,i=ze.current,a=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),De(ze,i&1),t===null)return xh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,a?(n=e.mode,a=e.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=ou(o,n,0,null),t=jn(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Sh(r),e.memoizedState=_h,t):Gm(e,o));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return vS(t,e,o,n,c,i,r);if(a){a=n.fallback,o=e.mode,i=t.child,c=i.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=u,e.deletions=null):(n=qs(i,u),n.subtreeFlags=i.subtreeFlags&14680064),c!==null?a=qs(c,a):(a=jn(a,o,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,o=t.child.memoizedState,o=o===null?Sh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~r,e.memoizedState=_h,n}return a=t.child,t=a.sibling,n=qs(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Gm(t,e){return e=ou({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Pl(t,e,r,n){return n!==null&&Dm(n),Pi(e,t.child,null,r),t=Gm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function vS(t,e,r,n,i,a,o){if(r)return e.flags&256?(e.flags&=-257,n=_d(Error(J(422))),Pl(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,i=e.mode,n=ou({mode:"visible",children:n.children},i,0,null),a=jn(a,i,o,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&Pi(e,t.child,null,o),e.child.memoizedState=Sh(o),e.memoizedState=_h,a);if(!(e.mode&1))return Pl(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var c=n.dgst;return n=c,a=Error(J(419)),n=_d(a,n,void 0),Pl(t,e,o,n)}if(c=(o&t.childLanes)!==0,Kt||c){if(n=ct,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,cs(t,i),Cr(n,t,i,-1))}return ef(),n=_d(Error(J(421))),Pl(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=PS.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,rr=Us(i.nextSibling),nr=e,$e=!0,jr=null,t!==null&&(dr[hr++]=Jr,dr[hr++]=Xr,dr[hr++]=En,Jr=t.id,Xr=t.overflow,En=e),e=Gm(e,n.children),e.flags|=4096,e)}function Jg(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),yh(t.return,e,r)}function Sd(t,e,r,n,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function Av(t,e,r){var n=e.pendingProps,i=n.revealOrder,a=n.tail;if(Lt(t,e,n.children,r),n=ze.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Jg(t,r,e);else if(t.tag===19)Jg(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(De(ze,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Sc(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Sd(e,!1,i,r,a);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Sc(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Sd(e,!0,r,null,a);break;case"together":Sd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Yl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function us(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),kn|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(J(153));if(e.child!==null){for(t=e.child,r=qs(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=qs(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function wS(t,e,r){switch(e.tag){case 3:Iv(e),Ai();break;case 5:sv(e);break;case 1:Qt(e.type)&&vc(e);break;case 4:Um(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;De(Nc,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(De(ze,ze.current&1),e.flags|=128,null):r&e.child.childLanes?Tv(t,e,r):(De(ze,ze.current&1),t=us(t,e,r),t!==null?t.sibling:null);De(ze,ze.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Av(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),De(ze,ze.current),n)break;return null;case 22:case 23:return e.lanes=0,Cv(t,e,r)}return us(t,e,r)}var Pv,Eh,Rv,Dv;Pv=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Eh=function(){};Rv=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,wn(Vr.current);var a=null;switch(r){case"input":i=Gd(t,i),n=Gd(t,n),a=[];break;case"select":i=He({},i,{value:void 0}),n=He({},n,{value:void 0}),a=[];break;case"textarea":i=Jd(t,i),n=Jd(t,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=xc)}Zd(r,n);var o;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var c=i[d];for(o in c)c.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(so.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in n){var u=n[d];if(c=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(a||(a=[]),a.push(d,r)),r=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(a=a||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(so.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Me("scroll",t),a||c===u||(a=[])):(a=a||[]).push(d,u))}r&&(a=a||[]).push("style",r);var d=a;(e.updateQueue=d)&&(e.flags|=4)}};Dv=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ia(t,e){if(!$e)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function _t(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function bS(t,e,r){var n=e.pendingProps;switch(Rm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(e),null;case 1:return Qt(e.type)&&yc(),_t(e),null;case 3:return n=e.stateNode,Ri(),Fe(Gt),Fe(At),$m(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Tl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jr!==null&&(Dh(jr),jr=null))),Eh(t,e),_t(e),null;case 5:Bm(e);var i=wn(go.current);if(r=e.type,t!==null&&e.stateNode!=null)Rv(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(J(166));return _t(e),null}if(t=wn(Vr.current),Tl(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[Or]=e,n[fo]=a,t=(e.mode&1)!==0,r){case"dialog":Me("cancel",n),Me("close",n);break;case"iframe":case"object":case"embed":Me("load",n);break;case"video":case"audio":for(i=0;i<Oa.length;i++)Me(Oa[i],n);break;case"source":Me("error",n);break;case"img":case"image":case"link":Me("error",n),Me("load",n);break;case"details":Me("toggle",n);break;case"input":ag(n,a),Me("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Me("invalid",n);break;case"textarea":lg(n,a),Me("invalid",n)}Zd(r,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="children"?typeof c=="string"?n.textContent!==c&&(a.suppressHydrationWarning!==!0&&Il(n.textContent,c,t),i=["children",c]):typeof c=="number"&&n.textContent!==""+c&&(a.suppressHydrationWarning!==!0&&Il(n.textContent,c,t),i=["children",""+c]):so.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Me("scroll",n)}switch(r){case"input":bl(n),og(n,a,!0);break;case"textarea":bl(n),cg(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=xc)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ly(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Or]=e,t[fo]=n,Pv(t,e,!1,!1),e.stateNode=t;e:{switch(o=eh(r,n),r){case"dialog":Me("cancel",t),Me("close",t),i=n;break;case"iframe":case"object":case"embed":Me("load",t),i=n;break;case"video":case"audio":for(i=0;i<Oa.length;i++)Me(Oa[i],t);i=n;break;case"source":Me("error",t),i=n;break;case"img":case"image":case"link":Me("error",t),Me("load",t),i=n;break;case"details":Me("toggle",t),i=n;break;case"input":ag(t,n),i=Gd(t,n),Me("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=He({},n,{value:void 0}),Me("invalid",t);break;case"textarea":lg(t,n),i=Jd(t,n),Me("invalid",t);break;default:i=n}Zd(r,i),c=i;for(a in c)if(c.hasOwnProperty(a)){var u=c[a];a==="style"?dy(t,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&cy(t,u)):a==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&no(t,u):typeof u=="number"&&no(t,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(so.hasOwnProperty(a)?u!=null&&a==="onScroll"&&Me("scroll",t):u!=null&&ym(t,a,u,o))}switch(r){case"input":bl(t),og(t,n,!1);break;case"textarea":bl(t),cg(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ys(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?gi(t,!!n.multiple,a,!1):n.defaultValue!=null&&gi(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=xc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _t(e),null;case 6:if(t&&e.stateNode!=null)Dv(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(J(166));if(r=wn(go.current),wn(Vr.current),Tl(e)){if(n=e.stateNode,r=e.memoizedProps,n[Or]=e,(a=n.nodeValue!==r)&&(t=nr,t!==null))switch(t.tag){case 3:Il(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Il(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Or]=e,e.stateNode=n}return _t(e),null;case 13:if(Fe(ze),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($e&&rr!==null&&e.mode&1&&!(e.flags&128))Xy(),Ai(),e.flags|=98560,a=!1;else if(a=Tl(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(J(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(J(317));a[Or]=e}else Ai(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_t(e),a=!1}else jr!==null&&(Dh(jr),jr=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ze.current&1?nt===0&&(nt=3):ef())),e.updateQueue!==null&&(e.flags|=4),_t(e),null);case 4:return Ri(),Eh(t,e),t===null&&ho(e.stateNode.containerInfo),_t(e),null;case 10:return Mm(e.type._context),_t(e),null;case 17:return Qt(e.type)&&yc(),_t(e),null;case 19:if(Fe(ze),a=e.memoizedState,a===null)return _t(e),null;if(n=(e.flags&128)!==0,o=a.rendering,o===null)if(n)Ia(a,!1);else{if(nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Sc(t),o!==null){for(e.flags|=128,Ia(a,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return De(ze,ze.current&1|2),e.child}t=t.sibling}a.tail!==null&&Je()>Oi&&(e.flags|=128,n=!0,Ia(a,!1),e.lanes=4194304)}else{if(!n)if(t=Sc(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ia(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!$e)return _t(e),null}else 2*Je()-a.renderingStartTime>Oi&&r!==1073741824&&(e.flags|=128,n=!0,Ia(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(r=a.last,r!==null?r.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Je(),e.sibling=null,r=ze.current,De(ze,n?r&1|2:r&1),e):(_t(e),null);case 22:case 23:return Zm(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?tr&1073741824&&(_t(e),e.subtreeFlags&6&&(e.flags|=8192)):_t(e),null;case 24:return null;case 25:return null}throw Error(J(156,e.tag))}function NS(t,e){switch(Rm(e),e.tag){case 1:return Qt(e.type)&&yc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ri(),Fe(Gt),Fe(At),$m(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Bm(e),null;case 13:if(Fe(ze),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(J(340));Ai()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Fe(ze),null;case 4:return Ri(),null;case 10:return Mm(e.type._context),null;case 22:case 23:return Zm(),null;case 24:return null;default:return null}}var Rl=!1,Ct=!1,jS=typeof WeakSet=="function"?WeakSet:Set,ne=null;function mi(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Qe(t,e,n)}else r.current=null}function Ch(t,e,r){try{r()}catch(n){Qe(t,e,n)}}var Xg=!1;function _S(t,e){if(uh=fc,t=Fy(),Am(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,c=-1,u=-1,d=0,m=0,p=t,x=null;t:for(;;){for(var j;p!==r||i!==0&&p.nodeType!==3||(c=o+i),p!==a||n!==0&&p.nodeType!==3||(u=o+n),p.nodeType===3&&(o+=p.nodeValue.length),(j=p.firstChild)!==null;)x=p,p=j;for(;;){if(p===t)break t;if(x===r&&++d===i&&(c=o),x===a&&++m===n&&(u=o),(j=p.nextSibling)!==null)break;p=x,x=p.parentNode}p=j}r=c===-1||u===-1?null:{start:c,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(dh={focusedElem:t,selectionRange:r},fc=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var b=I.memoizedProps,R=I.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?b:br(e.type,b),R);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var f=e.stateNode.containerInfo;f.nodeType===1?f.textContent="":f.nodeType===9&&f.documentElement&&f.removeChild(f.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(E){Qe(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return I=Xg,Xg=!1,I}function Qa(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&Ch(e,r,a)}i=i.next}while(i!==n)}}function iu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function kh(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Ov(t){var e=t.alternate;e!==null&&(t.alternate=null,Ov(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Or],delete e[fo],delete e[fh],delete e[aS],delete e[oS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Lv(t){return t.tag===5||t.tag===3||t.tag===4}function Zg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Lv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ih(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=xc));else if(n!==4&&(t=t.child,t!==null))for(Ih(t,e,r),t=t.sibling;t!==null;)Ih(t,e,r),t=t.sibling}function Th(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Th(t,e,r),t=t.sibling;t!==null;)Th(t,e,r),t=t.sibling}var ht=null,Nr=!1;function js(t,e,r){for(r=r.child;r!==null;)Mv(t,e,r),r=r.sibling}function Mv(t,e,r){if(Mr&&typeof Mr.onCommitFiberUnmount=="function")try{Mr.onCommitFiberUnmount(Jc,r)}catch{}switch(r.tag){case 5:Ct||mi(r,e);case 6:var n=ht,i=Nr;ht=null,js(t,e,r),ht=n,Nr=i,ht!==null&&(Nr?(t=ht,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ht.removeChild(r.stateNode));break;case 18:ht!==null&&(Nr?(t=ht,r=r.stateNode,t.nodeType===8?yd(t.parentNode,r):t.nodeType===1&&yd(t,r),lo(t)):yd(ht,r.stateNode));break;case 4:n=ht,i=Nr,ht=r.stateNode.containerInfo,Nr=!0,js(t,e,r),ht=n,Nr=i;break;case 0:case 11:case 14:case 15:if(!Ct&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Ch(r,e,o),i=i.next}while(i!==n)}js(t,e,r);break;case 1:if(!Ct&&(mi(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(c){Qe(r,e,c)}js(t,e,r);break;case 21:js(t,e,r);break;case 22:r.mode&1?(Ct=(n=Ct)||r.memoizedState!==null,js(t,e,r),Ct=n):js(t,e,r);break;default:js(t,e,r)}}function ex(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new jS),e.forEach(function(n){var i=RS.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function wr(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:ht=c.stateNode,Nr=!1;break e;case 3:ht=c.stateNode.containerInfo,Nr=!0;break e;case 4:ht=c.stateNode.containerInfo,Nr=!0;break e}c=c.return}if(ht===null)throw Error(J(160));Mv(a,o,i),ht=null,Nr=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(d){Qe(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Vv(e,t),e=e.sibling}function Vv(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(wr(e,t),Rr(t),n&4){try{Qa(3,t,t.return),iu(3,t)}catch(b){Qe(t,t.return,b)}try{Qa(5,t,t.return)}catch(b){Qe(t,t.return,b)}}break;case 1:wr(e,t),Rr(t),n&512&&r!==null&&mi(r,r.return);break;case 5:if(wr(e,t),Rr(t),n&512&&r!==null&&mi(r,r.return),t.flags&32){var i=t.stateNode;try{no(i,"")}catch(b){Qe(t,t.return,b)}}if(n&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,o=r!==null?r.memoizedProps:a,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&a.type==="radio"&&a.name!=null&&ay(i,a),eh(c,o);var d=eh(c,a);for(o=0;o<u.length;o+=2){var m=u[o],p=u[o+1];m==="style"?dy(i,p):m==="dangerouslySetInnerHTML"?cy(i,p):m==="children"?no(i,p):ym(i,m,p,d)}switch(c){case"input":Qd(i,a);break;case"textarea":oy(i,a);break;case"select":var x=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var j=a.value;j!=null?gi(i,!!a.multiple,j,!1):x!==!!a.multiple&&(a.defaultValue!=null?gi(i,!!a.multiple,a.defaultValue,!0):gi(i,!!a.multiple,a.multiple?[]:"",!1))}i[fo]=a}catch(b){Qe(t,t.return,b)}}break;case 6:if(wr(e,t),Rr(t),n&4){if(t.stateNode===null)throw Error(J(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(b){Qe(t,t.return,b)}}break;case 3:if(wr(e,t),Rr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{lo(e.containerInfo)}catch(b){Qe(t,t.return,b)}break;case 4:wr(e,t),Rr(t);break;case 13:wr(e,t),Rr(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Jm=Je())),n&4&&ex(t);break;case 22:if(m=r!==null&&r.memoizedState!==null,t.mode&1?(Ct=(d=Ct)||m,wr(e,t),Ct=d):wr(e,t),Rr(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!m&&t.mode&1)for(ne=t,m=t.child;m!==null;){for(p=ne=m;ne!==null;){switch(x=ne,j=x.child,x.tag){case 0:case 11:case 14:case 15:Qa(4,x,x.return);break;case 1:mi(x,x.return);var I=x.stateNode;if(typeof I.componentWillUnmount=="function"){n=x,r=x.return;try{e=n,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(b){Qe(n,r,b)}}break;case 5:mi(x,x.return);break;case 22:if(x.memoizedState!==null){rx(p);continue}}j!==null?(j.return=x,ne=j):rx(p)}m=m.sibling}e:for(m=null,p=t;;){if(p.tag===5){if(m===null){m=p;try{i=p.stateNode,d?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(c=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=uy("display",o))}catch(b){Qe(t,t.return,b)}}}else if(p.tag===6){if(m===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(b){Qe(t,t.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;m===p&&(m=null),p=p.return}m===p&&(m=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:wr(e,t),Rr(t),n&4&&ex(t);break;case 21:break;default:wr(e,t),Rr(t)}}function Rr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Lv(r)){var n=r;break e}r=r.return}throw Error(J(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(no(i,""),n.flags&=-33);var a=Zg(t);Th(t,a,i);break;case 3:case 4:var o=n.stateNode.containerInfo,c=Zg(t);Ih(t,c,o);break;default:throw Error(J(161))}}catch(u){Qe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function SS(t,e,r){ne=t,Fv(t)}function Fv(t,e,r){for(var n=(t.mode&1)!==0;ne!==null;){var i=ne,a=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Rl;if(!o){var c=i.alternate,u=c!==null&&c.memoizedState!==null||Ct;c=Rl;var d=Ct;if(Rl=o,(Ct=u)&&!d)for(ne=i;ne!==null;)o=ne,u=o.child,o.tag===22&&o.memoizedState!==null?sx(i):u!==null?(u.return=o,ne=u):sx(i);for(;a!==null;)ne=a,Fv(a),a=a.sibling;ne=i,Rl=c,Ct=d}tx(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,ne=a):tx(t)}}function tx(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ct||iu(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ct)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:br(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&Fg(e,a,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Fg(e,o,r)}break;case 5:var c=e.stateNode;if(r===null&&e.flags&4){r=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var p=m.dehydrated;p!==null&&lo(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}Ct||e.flags&512&&kh(e)}catch(x){Qe(e,e.return,x)}}if(e===t){ne=null;break}if(r=e.sibling,r!==null){r.return=e.return,ne=r;break}ne=e.return}}function rx(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ne=r;break}ne=e.return}}function sx(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{iu(4,e)}catch(u){Qe(e,r,u)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(u){Qe(e,i,u)}}var a=e.return;try{kh(e)}catch(u){Qe(e,a,u)}break;case 5:var o=e.return;try{kh(e)}catch(u){Qe(e,o,u)}}}catch(u){Qe(e,e.return,u)}if(e===t){ne=null;break}var c=e.sibling;if(c!==null){c.return=e.return,ne=c;break}ne=e.return}}var ES=Math.ceil,kc=gs.ReactCurrentDispatcher,Qm=gs.ReactCurrentOwner,fr=gs.ReactCurrentBatchConfig,Se=0,ct=null,Ze=null,gt=0,tr=0,fi=nn(0),nt=0,wo=null,kn=0,au=0,Ym=0,Ya=null,Wt=null,Jm=0,Oi=1/0,Qr=null,Ic=!1,Ah=null,$s=null,Dl=!1,Ds=null,Tc=0,Ja=0,Ph=null,Jl=-1,Xl=0;function Mt(){return Se&6?Je():Jl!==-1?Jl:Jl=Je()}function zs(t){return t.mode&1?Se&2&&gt!==0?gt&-gt:cS.transition!==null?(Xl===0&&(Xl=jy()),Xl):(t=Te,t!==0||(t=window.event,t=t===void 0?16:Ty(t.type)),t):1}function Cr(t,e,r,n){if(50<Ja)throw Ja=0,Ph=null,Error(J(185));Oo(t,r,n),(!(Se&2)||t!==ct)&&(t===ct&&(!(Se&2)&&(au|=r),nt===4&&ks(t,gt)),Yt(t,n),r===1&&Se===0&&!(e.mode&1)&&(Oi=Je()+500,ru&&an()))}function Yt(t,e){var r=t.callbackNode;c_(t,e);var n=mc(t,t===ct?gt:0);if(n===0)r!==null&&hg(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&hg(r),e===1)t.tag===0?lS(nx.bind(null,t)):Qy(nx.bind(null,t)),nS(function(){!(Se&6)&&an()}),r=null;else{switch(_y(n)){case 1:r=jm;break;case 4:r=by;break;case 16:r=hc;break;case 536870912:r=Ny;break;default:r=hc}r=Kv(r,Uv.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Uv(t,e){if(Jl=-1,Xl=0,Se&6)throw Error(J(327));var r=t.callbackNode;if(bi()&&t.callbackNode!==r)return null;var n=mc(t,t===ct?gt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Ac(t,n);else{e=n;var i=Se;Se|=2;var a=$v();(ct!==t||gt!==e)&&(Qr=null,Oi=Je()+500,Nn(t,e));do try{IS();break}catch(c){Bv(t,c)}while(!0);Lm(),kc.current=a,Se=i,Ze!==null?e=0:(ct=null,gt=0,e=nt)}if(e!==0){if(e===2&&(i=ih(t),i!==0&&(n=i,e=Rh(t,i))),e===1)throw r=wo,Nn(t,0),ks(t,n),Yt(t,Je()),r;if(e===6)ks(t,n);else{if(i=t.current.alternate,!(n&30)&&!CS(i)&&(e=Ac(t,n),e===2&&(a=ih(t),a!==0&&(n=a,e=Rh(t,a))),e===1))throw r=wo,Nn(t,0),ks(t,n),Yt(t,Je()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(J(345));case 2:gn(t,Wt,Qr);break;case 3:if(ks(t,n),(n&130023424)===n&&(e=Jm+500-Je(),10<e)){if(mc(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Mt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=mh(gn.bind(null,t,Wt,Qr),e);break}gn(t,Wt,Qr);break;case 4:if(ks(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-Er(n);a=1<<o,o=e[o],o>i&&(i=o),n&=~a}if(n=i,n=Je()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ES(n/1960))-n,10<n){t.timeoutHandle=mh(gn.bind(null,t,Wt,Qr),n);break}gn(t,Wt,Qr);break;case 5:gn(t,Wt,Qr);break;default:throw Error(J(329))}}}return Yt(t,Je()),t.callbackNode===r?Uv.bind(null,t):null}function Rh(t,e){var r=Ya;return t.current.memoizedState.isDehydrated&&(Nn(t,e).flags|=256),t=Ac(t,e),t!==2&&(e=Wt,Wt=r,e!==null&&Dh(e)),t}function Dh(t){Wt===null?Wt=t:Wt.push.apply(Wt,t)}function CS(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!kr(a(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ks(t,e){for(e&=~Ym,e&=~au,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Er(e),n=1<<r;t[r]=-1,e&=~n}}function nx(t){if(Se&6)throw Error(J(327));bi();var e=mc(t,0);if(!(e&1))return Yt(t,Je()),null;var r=Ac(t,e);if(t.tag!==0&&r===2){var n=ih(t);n!==0&&(e=n,r=Rh(t,n))}if(r===1)throw r=wo,Nn(t,0),ks(t,e),Yt(t,Je()),r;if(r===6)throw Error(J(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,gn(t,Wt,Qr),Yt(t,Je()),null}function Xm(t,e){var r=Se;Se|=1;try{return t(e)}finally{Se=r,Se===0&&(Oi=Je()+500,ru&&an())}}function In(t){Ds!==null&&Ds.tag===0&&!(Se&6)&&bi();var e=Se;Se|=1;var r=fr.transition,n=Te;try{if(fr.transition=null,Te=1,t)return t()}finally{Te=n,fr.transition=r,Se=e,!(Se&6)&&an()}}function Zm(){tr=fi.current,Fe(fi)}function Nn(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,sS(r)),Ze!==null)for(r=Ze.return;r!==null;){var n=r;switch(Rm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&yc();break;case 3:Ri(),Fe(Gt),Fe(At),$m();break;case 5:Bm(n);break;case 4:Ri();break;case 13:Fe(ze);break;case 19:Fe(ze);break;case 10:Mm(n.type._context);break;case 22:case 23:Zm()}r=r.return}if(ct=t,Ze=t=qs(t.current,null),gt=tr=e,nt=0,wo=null,Ym=au=kn=0,Wt=Ya=null,vn!==null){for(e=0;e<vn.length;e++)if(r=vn[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=i,n.next=o}r.pending=n}vn=null}return t}function Bv(t,e){do{var r=Ze;try{if(Lm(),Gl.current=Cc,Ec){for(var n=qe.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ec=!1}if(Cn=0,lt=rt=qe=null,Ga=!1,xo=0,Qm.current=null,r===null||r.return===null){nt=1,wo=e,Ze=null;break}e:{var a=t,o=r.return,c=r,u=e;if(e=gt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=c,p=m.tag;if(!(m.mode&1)&&(p===0||p===11||p===15)){var x=m.alternate;x?(m.updateQueue=x.updateQueue,m.memoizedState=x.memoizedState,m.lanes=x.lanes):(m.updateQueue=null,m.memoizedState=null)}var j=Wg(o);if(j!==null){j.flags&=-257,Hg(j,o,c,a,e),j.mode&1&&qg(a,d,e),e=j,u=d;var I=e.updateQueue;if(I===null){var b=new Set;b.add(u),e.updateQueue=b}else I.add(u);break e}else{if(!(e&1)){qg(a,d,e),ef();break e}u=Error(J(426))}}else if($e&&c.mode&1){var R=Wg(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),Hg(R,o,c,a,e),Dm(Di(u,c));break e}}a=u=Di(u,c),nt!==4&&(nt=2),Ya===null?Ya=[a]:Ya.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var v=_v(a,u,e);Vg(a,v);break e;case 1:c=u;var y=a.type,f=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&($s===null||!$s.has(f)))){a.flags|=65536,e&=-e,a.lanes|=e;var E=Sv(a,c,e);Vg(a,E);break e}}a=a.return}while(a!==null)}qv(r)}catch(P){e=P,Ze===r&&r!==null&&(Ze=r=r.return);continue}break}while(!0)}function $v(){var t=kc.current;return kc.current=Cc,t===null?Cc:t}function ef(){(nt===0||nt===3||nt===2)&&(nt=4),ct===null||!(kn&268435455)&&!(au&268435455)||ks(ct,gt)}function Ac(t,e){var r=Se;Se|=2;var n=$v();(ct!==t||gt!==e)&&(Qr=null,Nn(t,e));do try{kS();break}catch(i){Bv(t,i)}while(!0);if(Lm(),Se=r,kc.current=n,Ze!==null)throw Error(J(261));return ct=null,gt=0,nt}function kS(){for(;Ze!==null;)zv(Ze)}function IS(){for(;Ze!==null&&!e_();)zv(Ze)}function zv(t){var e=Hv(t.alternate,t,tr);t.memoizedProps=t.pendingProps,e===null?qv(t):Ze=e,Qm.current=null}function qv(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=NS(r,e),r!==null){r.flags&=32767,Ze=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{nt=6,Ze=null;return}}else if(r=bS(r,e,tr),r!==null){Ze=r;return}if(e=e.sibling,e!==null){Ze=e;return}Ze=e=t}while(e!==null);nt===0&&(nt=5)}function gn(t,e,r){var n=Te,i=fr.transition;try{fr.transition=null,Te=1,TS(t,e,r,n)}finally{fr.transition=i,Te=n}return null}function TS(t,e,r,n){do bi();while(Ds!==null);if(Se&6)throw Error(J(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(J(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(u_(t,a),t===ct&&(Ze=ct=null,gt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Dl||(Dl=!0,Kv(hc,function(){return bi(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=fr.transition,fr.transition=null;var o=Te;Te=1;var c=Se;Se|=4,Qm.current=null,_S(t,r),Vv(r,t),Y_(dh),fc=!!uh,dh=uh=null,t.current=r,SS(r),t_(),Se=c,Te=o,fr.transition=a}else t.current=r;if(Dl&&(Dl=!1,Ds=t,Tc=i),a=t.pendingLanes,a===0&&($s=null),n_(r.stateNode),Yt(t,Je()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ic)throw Ic=!1,t=Ah,Ah=null,t;return Tc&1&&t.tag!==0&&bi(),a=t.pendingLanes,a&1?t===Ph?Ja++:(Ja=0,Ph=t):Ja=0,an(),null}function bi(){if(Ds!==null){var t=_y(Tc),e=fr.transition,r=Te;try{if(fr.transition=null,Te=16>t?16:t,Ds===null)var n=!1;else{if(t=Ds,Ds=null,Tc=0,Se&6)throw Error(J(331));var i=Se;for(Se|=4,ne=t.current;ne!==null;){var a=ne,o=a.child;if(ne.flags&16){var c=a.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(ne=d;ne!==null;){var m=ne;switch(m.tag){case 0:case 11:case 15:Qa(8,m,a)}var p=m.child;if(p!==null)p.return=m,ne=p;else for(;ne!==null;){m=ne;var x=m.sibling,j=m.return;if(Ov(m),m===d){ne=null;break}if(x!==null){x.return=j,ne=x;break}ne=j}}}var I=a.alternate;if(I!==null){var b=I.child;if(b!==null){I.child=null;do{var R=b.sibling;b.sibling=null,b=R}while(b!==null)}}ne=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,ne=o;else e:for(;ne!==null;){if(a=ne,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Qa(9,a,a.return)}var v=a.sibling;if(v!==null){v.return=a.return,ne=v;break e}ne=a.return}}var y=t.current;for(ne=y;ne!==null;){o=ne;var f=o.child;if(o.subtreeFlags&2064&&f!==null)f.return=o,ne=f;else e:for(o=y;ne!==null;){if(c=ne,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:iu(9,c)}}catch(P){Qe(c,c.return,P)}if(c===o){ne=null;break e}var E=c.sibling;if(E!==null){E.return=c.return,ne=E;break e}ne=c.return}}if(Se=i,an(),Mr&&typeof Mr.onPostCommitFiberRoot=="function")try{Mr.onPostCommitFiberRoot(Jc,t)}catch{}n=!0}return n}finally{Te=r,fr.transition=e}}return!1}function ix(t,e,r){e=Di(r,e),e=_v(t,e,1),t=Bs(t,e,1),e=Mt(),t!==null&&(Oo(t,1,e),Yt(t,e))}function Qe(t,e,r){if(t.tag===3)ix(t,t,r);else for(;e!==null;){if(e.tag===3){ix(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&($s===null||!$s.has(n))){t=Di(r,t),t=Sv(e,t,1),e=Bs(e,t,1),t=Mt(),e!==null&&(Oo(e,1,t),Yt(e,t));break}}e=e.return}}function AS(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Mt(),t.pingedLanes|=t.suspendedLanes&r,ct===t&&(gt&r)===r&&(nt===4||nt===3&&(gt&130023424)===gt&&500>Je()-Jm?Nn(t,0):Ym|=r),Yt(t,e)}function Wv(t,e){e===0&&(t.mode&1?(e=_l,_l<<=1,!(_l&130023424)&&(_l=4194304)):e=1);var r=Mt();t=cs(t,e),t!==null&&(Oo(t,e,r),Yt(t,r))}function PS(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Wv(t,r)}function RS(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(J(314))}n!==null&&n.delete(e),Wv(t,r)}var Hv;Hv=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Gt.current)Kt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Kt=!1,wS(t,e,r);Kt=!!(t.flags&131072)}else Kt=!1,$e&&e.flags&1048576&&Yy(e,bc,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Yl(t,e),t=e.pendingProps;var i=Ti(e,At.current);wi(e,r),i=qm(null,e,n,t,i,r);var a=Wm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qt(n)?(a=!0,vc(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Fm(e),i.updater=nu,e.stateNode=i,i._reactInternals=e,wh(e,n,t,r),e=jh(null,e,n,!0,a,r)):(e.tag=0,$e&&a&&Pm(e),Lt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Yl(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=OS(n),t=br(n,t),i){case 0:e=Nh(null,e,n,t,r);break e;case 1:e=Qg(null,e,n,t,r);break e;case 11:e=Kg(null,e,n,t,r);break e;case 14:e=Gg(null,e,n,br(n.type,t),r);break e}throw Error(J(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:br(n,i),Nh(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:br(n,i),Qg(t,e,n,i,r);case 3:e:{if(Iv(e),t===null)throw Error(J(387));n=e.pendingProps,a=e.memoizedState,i=a.element,rv(t,e),_c(e,n,null,r);var o=e.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=Di(Error(J(423)),e),e=Yg(t,e,n,r,i);break e}else if(n!==i){i=Di(Error(J(424)),e),e=Yg(t,e,n,r,i);break e}else for(rr=Us(e.stateNode.containerInfo.firstChild),nr=e,$e=!0,jr=null,r=ev(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ai(),n===i){e=us(t,e,r);break e}Lt(t,e,n,r)}e=e.child}return e;case 5:return sv(e),t===null&&xh(e),n=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,o=i.children,hh(n,i)?o=null:a!==null&&hh(n,a)&&(e.flags|=32),kv(t,e),Lt(t,e,o,r),e.child;case 6:return t===null&&xh(e),null;case 13:return Tv(t,e,r);case 4:return Um(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Pi(e,null,n,r):Lt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:br(n,i),Kg(t,e,n,i,r);case 7:return Lt(t,e,e.pendingProps,r),e.child;case 8:return Lt(t,e,e.pendingProps.children,r),e.child;case 12:return Lt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,a=e.memoizedProps,o=i.value,De(Nc,n._currentValue),n._currentValue=o,a!==null)if(kr(a.value,o)){if(a.children===i.children&&!Gt.current){e=us(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var c=a.dependencies;if(c!==null){o=a.child;for(var u=c.firstContext;u!==null;){if(u.context===n){if(a.tag===1){u=ns(-1,r&-r),u.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),yh(a.return,r,e),c.lanes|=r;break}u=u.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(J(341));o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),yh(o,r,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Lt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,wi(e,r),i=pr(i),n=n(i),e.flags|=1,Lt(t,e,n,r),e.child;case 14:return n=e.type,i=br(n,e.pendingProps),i=br(n.type,i),Gg(t,e,n,i,r);case 15:return Ev(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:br(n,i),Yl(t,e),e.tag=1,Qt(n)?(t=!0,vc(e)):t=!1,wi(e,r),jv(e,n,i),wh(e,n,i,r),jh(null,e,n,!0,t,r);case 19:return Av(t,e,r);case 22:return Cv(t,e,r)}throw Error(J(156,e.tag))};function Kv(t,e){return wy(t,e)}function DS(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(t,e,r,n){return new DS(t,e,r,n)}function tf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function OS(t){if(typeof t=="function")return tf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===wm)return 11;if(t===bm)return 14}return 2}function qs(t,e){var r=t.alternate;return r===null?(r=mr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Zl(t,e,r,n,i,a){var o=2;if(n=t,typeof t=="function")tf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ni:return jn(r.children,i,a,e);case vm:o=8,i|=8;break;case qd:return t=mr(12,r,e,i|2),t.elementType=qd,t.lanes=a,t;case Wd:return t=mr(13,r,e,i),t.elementType=Wd,t.lanes=a,t;case Hd:return t=mr(19,r,e,i),t.elementType=Hd,t.lanes=a,t;case sy:return ou(r,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ty:o=10;break e;case ry:o=9;break e;case wm:o=11;break e;case bm:o=14;break e;case Ss:o=16,n=null;break e}throw Error(J(130,t==null?t:typeof t,""))}return e=mr(o,r,e,i),e.elementType=t,e.type=n,e.lanes=a,e}function jn(t,e,r,n){return t=mr(7,t,n,e),t.lanes=r,t}function ou(t,e,r,n){return t=mr(22,t,n,e),t.elementType=sy,t.lanes=r,t.stateNode={isHidden:!1},t}function Ed(t,e,r){return t=mr(6,t,null,e),t.lanes=r,t}function Cd(t,e,r){return e=mr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function LS(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=od(0),this.expirationTimes=od(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=od(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function rf(t,e,r,n,i,a,o,c,u){return t=new LS(t,e,r,c,u),e===1?(e=1,a===!0&&(e|=8)):e=0,a=mr(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fm(a),t}function MS(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:si,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Gv(t){if(!t)return Js;t=t._reactInternals;e:{if(Fn(t)!==t||t.tag!==1)throw Error(J(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(J(171))}if(t.tag===1){var r=t.type;if(Qt(r))return Gy(t,r,e)}return e}function Qv(t,e,r,n,i,a,o,c,u){return t=rf(r,n,!0,t,i,a,o,c,u),t.context=Gv(null),r=t.current,n=Mt(),i=zs(r),a=ns(n,i),a.callback=e??null,Bs(r,a,i),t.current.lanes=i,Oo(t,i,n),Yt(t,n),t}function lu(t,e,r,n){var i=e.current,a=Mt(),o=zs(i);return r=Gv(r),e.context===null?e.context=r:e.pendingContext=r,e=ns(a,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Bs(i,e,o),t!==null&&(Cr(t,i,o,a),Kl(t,i,o)),o}function Pc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ax(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function sf(t,e){ax(t,e),(t=t.alternate)&&ax(t,e)}function VS(){return null}var Yv=typeof reportError=="function"?reportError:function(t){console.error(t)};function nf(t){this._internalRoot=t}cu.prototype.render=nf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(J(409));lu(t,e,null,null)};cu.prototype.unmount=nf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;In(function(){lu(null,t,null,null)}),e[ls]=null}};function cu(t){this._internalRoot=t}cu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Cy();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Cs.length&&e!==0&&e<Cs[r].priority;r++);Cs.splice(r,0,t),r===0&&Iy(t)}};function af(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function uu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ox(){}function FS(t,e,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var d=Pc(o);a.call(d)}}var o=Qv(e,n,t,0,null,!1,!1,"",ox);return t._reactRootContainer=o,t[ls]=o.current,ho(t.nodeType===8?t.parentNode:t),In(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var c=n;n=function(){var d=Pc(u);c.call(d)}}var u=rf(t,0,!1,null,null,!1,!1,"",ox);return t._reactRootContainer=u,t[ls]=u.current,ho(t.nodeType===8?t.parentNode:t),In(function(){lu(e,u,r,n)}),u}function du(t,e,r,n,i){var a=r._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var c=i;i=function(){var u=Pc(o);c.call(u)}}lu(e,o,t,i)}else o=FS(r,e,t,i,n);return Pc(o)}Sy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Da(e.pendingLanes);r!==0&&(_m(e,r|1),Yt(e,Je()),!(Se&6)&&(Oi=Je()+500,an()))}break;case 13:In(function(){var n=cs(t,1);if(n!==null){var i=Mt();Cr(n,t,1,i)}}),sf(t,1)}};Sm=function(t){if(t.tag===13){var e=cs(t,134217728);if(e!==null){var r=Mt();Cr(e,t,134217728,r)}sf(t,134217728)}};Ey=function(t){if(t.tag===13){var e=zs(t),r=cs(t,e);if(r!==null){var n=Mt();Cr(r,t,e,n)}sf(t,e)}};Cy=function(){return Te};ky=function(t,e){var r=Te;try{return Te=t,e()}finally{Te=r}};rh=function(t,e,r){switch(e){case"input":if(Qd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=tu(n);if(!i)throw Error(J(90));iy(n),Qd(n,i)}}}break;case"textarea":oy(t,r);break;case"select":e=r.value,e!=null&&gi(t,!!r.multiple,e,!1)}};fy=Xm;py=In;var US={usingClientEntryPoint:!1,Events:[Mo,li,tu,hy,my,Xm]},Ta={findFiberByHostInstance:yn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BS={bundleType:Ta.bundleType,version:Ta.version,rendererPackageName:Ta.rendererPackageName,rendererConfig:Ta.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=yy(t),t===null?null:t.stateNode},findFiberByHostInstance:Ta.findFiberByHostInstance||VS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ol=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ol.isDisabled&&Ol.supportsFiber)try{Jc=Ol.inject(BS),Mr=Ol}catch{}}or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=US;or.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!af(e))throw Error(J(200));return MS(t,e,null,r)};or.createRoot=function(t,e){if(!af(t))throw Error(J(299));var r=!1,n="",i=Yv;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=rf(t,1,!1,null,null,r,!1,n,i),t[ls]=e.current,ho(t.nodeType===8?t.parentNode:t),new nf(e)};or.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(J(188)):(t=Object.keys(t).join(","),Error(J(268,t)));return t=yy(e),t=t===null?null:t.stateNode,t};or.flushSync=function(t){return In(t)};or.hydrate=function(t,e,r){if(!uu(e))throw Error(J(200));return du(null,t,e,!0,r)};or.hydrateRoot=function(t,e,r){if(!af(t))throw Error(J(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",o=Yv;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Qv(e,null,t,1,r??null,i,!1,a,o),t[ls]=e.current,ho(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new cu(e)};or.render=function(t,e,r){if(!uu(e))throw Error(J(200));return du(null,t,e,!1,r)};or.unmountComponentAtNode=function(t){if(!uu(t))throw Error(J(40));return t._reactRootContainer?(In(function(){du(null,null,t,!1,function(){t._reactRootContainer=null,t[ls]=null})}),!0):!1};or.unstable_batchedUpdates=Xm;or.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!uu(r))throw Error(J(200));if(t==null||t._reactInternals===void 0)throw Error(J(38));return du(t,e,r,!1,n)};or.version="18.3.1-next-f1338f8080-20240426";function Jv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Jv)}catch(t){console.error(t)}}Jv(),J0.exports=or;var $S=J0.exports,lx=$S;$d.createRoot=lx.createRoot,$d.hydrateRoot=lx.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bo(){return bo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bo.apply(this,arguments)}var Os;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Os||(Os={}));const cx="popstate";function zS(t){t===void 0&&(t={});function e(n,i){let{pathname:a,search:o,hash:c}=n.location;return Oh("",{pathname:a,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Rc(i)}return WS(e,r,null,t)}function We(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Xv(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qS(){return Math.random().toString(36).substr(2,8)}function ux(t,e){return{usr:t.state,key:t.key,idx:e}}function Oh(t,e,r,n){return r===void 0&&(r=null),bo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Yi(e):e,{state:r,key:e&&e.key||n||qS()})}function Rc(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Yi(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function WS(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,c=Os.Pop,u=null,d=m();d==null&&(d=0,o.replaceState(bo({},o.state,{idx:d}),""));function m(){return(o.state||{idx:null}).idx}function p(){c=Os.Pop;let R=m(),v=R==null?null:R-d;d=R,u&&u({action:c,location:b.location,delta:v})}function x(R,v){c=Os.Push;let y=Oh(b.location,R,v);d=m()+1;let f=ux(y,d),E=b.createHref(y);try{o.pushState(f,"",E)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(E)}a&&u&&u({action:c,location:b.location,delta:1})}function j(R,v){c=Os.Replace;let y=Oh(b.location,R,v);d=m();let f=ux(y,d),E=b.createHref(y);o.replaceState(f,"",E),a&&u&&u({action:c,location:b.location,delta:0})}function I(R){let v=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof R=="string"?R:Rc(R);return y=y.replace(/ $/,"%20"),We(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let b={get action(){return c},get location(){return t(i,o)},listen(R){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(cx,p),u=R,()=>{i.removeEventListener(cx,p),u=null}},createHref(R){return e(i,R)},createURL:I,encodeLocation(R){let v=I(R);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:x,replace:j,go(R){return o.go(R)}};return b}var dx;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(dx||(dx={}));function HS(t,e,r){return r===void 0&&(r="/"),KS(t,e,r)}function KS(t,e,r,n){let i=typeof e=="string"?Yi(e):e,a=Li(i.pathname||"/",r);if(a==null)return null;let o=Zv(t);GS(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=i1(a);c=s1(o[u],d)}return c}function Zv(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,o,c)=>{let u={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};u.relativePath.startsWith("/")&&(We(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let d=Ws([n,u.relativePath]),m=r.concat(u);a.children&&a.children.length>0&&(We(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Zv(a.children,e,m,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:t1(d,a.index),routesMeta:m})};return t.forEach((a,o)=>{var c;if(a.path===""||!((c=a.path)!=null&&c.includes("?")))i(a,o);else for(let u of ew(a.path))i(a,o,u)}),e}function ew(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=ew(n.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function GS(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:r1(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const QS=/^:[\w-]+$/,YS=3,JS=2,XS=1,ZS=10,e1=-2,hx=t=>t==="*";function t1(t,e){let r=t.split("/"),n=r.length;return r.some(hx)&&(n+=e1),e&&(n+=JS),r.filter(i=>!hx(i)).reduce((i,a)=>i+(QS.test(a)?YS:a===""?XS:ZS),n)}function r1(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function s1(t,e,r){let{routesMeta:n}=t,i={},a="/",o=[];for(let c=0;c<n.length;++c){let u=n[c],d=c===n.length-1,m=a==="/"?e:e.slice(a.length)||"/",p=Lh({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},m),x=u.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Ws([a,p.pathname]),pathnameBase:c1(Ws([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=Ws([a,p.pathnameBase]))}return o}function Lh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=n1(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:n.reduce((d,m,p)=>{let{paramName:x,isOptional:j}=m;if(x==="*"){let b=c[p]||"";o=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const I=c[p];return j&&!I?d[x]=void 0:d[x]=(I||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:t}}function n1(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Xv(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(n.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function i1(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Xv(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Li(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function a1(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Yi(t):t;return{pathname:r?r.startsWith("/")?r:o1(r,e):e,search:u1(n),hash:d1(i)}}function o1(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function kd(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function l1(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function of(t,e){let r=l1(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function lf(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Yi(t):(i=bo({},t),We(!i.pathname||!i.pathname.includes("?"),kd("?","pathname","search",i)),We(!i.pathname||!i.pathname.includes("#"),kd("#","pathname","hash",i)),We(!i.search||!i.search.includes("#"),kd("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=r;else{let p=e.length-1;if(!n&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),p-=1;i.pathname=x.join("/")}c=p>=0?e[p]:"/"}let u=a1(i,c),d=o&&o!=="/"&&o.endsWith("/"),m=(a||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(d||m)&&(u.pathname+="/"),u}const Ws=t=>t.join("/").replace(/\/\/+/g,"/"),c1=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),u1=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,d1=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function h1(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const tw=["post","put","patch","delete"];new Set(tw);const m1=["get",...tw];new Set(m1);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function No(){return No=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},No.apply(this,arguments)}const hu=_.createContext(null),rw=_.createContext(null),xs=_.createContext(null),mu=_.createContext(null),qr=_.createContext({outlet:null,matches:[],isDataRoute:!1}),sw=_.createContext(null);function f1(t,e){let{relative:r}=e===void 0?{}:e;Ji()||We(!1);let{basename:n,navigator:i}=_.useContext(xs),{hash:a,pathname:o,search:c}=fu(t,{relative:r}),u=o;return n!=="/"&&(u=o==="/"?n:Ws([n,o])),i.createHref({pathname:u,search:c,hash:a})}function Ji(){return _.useContext(mu)!=null}function Un(){return Ji()||We(!1),_.useContext(mu).location}function nw(t){_.useContext(xs).static||_.useLayoutEffect(t)}function Zt(){let{isDataRoute:t}=_.useContext(qr);return t?I1():p1()}function p1(){Ji()||We(!1);let t=_.useContext(hu),{basename:e,future:r,navigator:n}=_.useContext(xs),{matches:i}=_.useContext(qr),{pathname:a}=Un(),o=JSON.stringify(of(i,r.v7_relativeSplatPath)),c=_.useRef(!1);return nw(()=>{c.current=!0}),_.useCallback(function(d,m){if(m===void 0&&(m={}),!c.current)return;if(typeof d=="number"){n.go(d);return}let p=lf(d,JSON.parse(o),a,m.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Ws([e,p.pathname])),(m.replace?n.replace:n.push)(p,m.state,m)},[e,n,o,a,t])}const g1=_.createContext(null);function x1(t){let e=_.useContext(qr).outlet;return e&&_.createElement(g1.Provider,{value:t},e)}function Bn(){let{matches:t}=_.useContext(qr),e=t[t.length-1];return e?e.params:{}}function fu(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=_.useContext(xs),{matches:i}=_.useContext(qr),{pathname:a}=Un(),o=JSON.stringify(of(i,n.v7_relativeSplatPath));return _.useMemo(()=>lf(t,JSON.parse(o),a,r==="path"),[t,o,a,r])}function y1(t,e){return v1(t,e)}function v1(t,e,r,n){Ji()||We(!1);let{navigator:i}=_.useContext(xs),{matches:a}=_.useContext(qr),o=a[a.length-1],c=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let d=Un(),m;if(e){var p;let R=typeof e=="string"?Yi(e):e;u==="/"||(p=R.pathname)!=null&&p.startsWith(u)||We(!1),m=R}else m=d;let x=m.pathname||"/",j=x;if(u!=="/"){let R=u.replace(/^\//,"").split("/");j="/"+x.replace(/^\//,"").split("/").slice(R.length).join("/")}let I=HS(t,{pathname:j}),b=_1(I&&I.map(R=>Object.assign({},R,{params:Object.assign({},c,R.params),pathname:Ws([u,i.encodeLocation?i.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?u:Ws([u,i.encodeLocation?i.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),a,r,n);return e&&b?_.createElement(mu.Provider,{value:{location:No({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Os.Pop}},b):b}function w1(){let t=k1(),e=h1(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),r?_.createElement("pre",{style:i},r):null,null)}const b1=_.createElement(w1,null);class N1 extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?_.createElement(qr.Provider,{value:this.props.routeContext},_.createElement(sw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function j1(t){let{routeContext:e,match:r,children:n}=t,i=_.useContext(hu);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),_.createElement(qr.Provider,{value:e},n)}function _1(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,c=(i=r)==null?void 0:i.errors;if(c!=null){let m=o.findIndex(p=>p.route.id&&(c==null?void 0:c[p.route.id])!==void 0);m>=0||We(!1),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let m=0;m<o.length;m++){let p=o[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=m),p.route.id){let{loaderData:x,errors:j}=r,I=p.route.loader&&x[p.route.id]===void 0&&(!j||j[p.route.id]===void 0);if(p.route.lazy||I){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((m,p,x)=>{let j,I=!1,b=null,R=null;r&&(j=c&&p.route.id?c[p.route.id]:void 0,b=p.route.errorElement||b1,u&&(d<0&&x===0?(T1("route-fallback"),I=!0,R=null):d===x&&(I=!0,R=p.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,x+1)),y=()=>{let f;return j?f=b:I?f=R:p.route.Component?f=_.createElement(p.route.Component,null):p.route.element?f=p.route.element:f=m,_.createElement(j1,{match:p,routeContext:{outlet:m,matches:v,isDataRoute:r!=null},children:f})};return r&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?_.createElement(N1,{location:r.location,revalidation:r.revalidation,component:b,error:j,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var iw=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(iw||{}),aw=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(aw||{});function S1(t){let e=_.useContext(hu);return e||We(!1),e}function E1(t){let e=_.useContext(rw);return e||We(!1),e}function C1(t){let e=_.useContext(qr);return e||We(!1),e}function ow(t){let e=C1(),r=e.matches[e.matches.length-1];return r.route.id||We(!1),r.route.id}function k1(){var t;let e=_.useContext(sw),r=E1(),n=ow();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function I1(){let{router:t}=S1(iw.UseNavigateStable),e=ow(aw.UseNavigateStable),r=_.useRef(!1);return nw(()=>{r.current=!0}),_.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,No({fromRouteId:e},a)))},[t,e])}const mx={};function T1(t,e,r){mx[t]||(mx[t]=!0)}function A1(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Xs(t){let{to:e,replace:r,state:n,relative:i}=t;Ji()||We(!1);let{future:a,static:o}=_.useContext(xs),{matches:c}=_.useContext(qr),{pathname:u}=Un(),d=Zt(),m=lf(e,of(c,a.v7_relativeSplatPath),u,i==="path"),p=JSON.stringify(m);return _.useEffect(()=>d(JSON.parse(p),{replace:r,state:n,relative:i}),[d,p,i,r,n]),null}function P1(t){return x1(t.context)}function ee(t){We(!1)}function R1(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Os.Pop,navigator:a,static:o=!1,future:c}=t;Ji()&&We(!1);let u=e.replace(/^\/*/,"/"),d=_.useMemo(()=>({basename:u,navigator:a,static:o,future:No({v7_relativeSplatPath:!1},c)}),[u,c,a,o]);typeof n=="string"&&(n=Yi(n));let{pathname:m="/",search:p="",hash:x="",state:j=null,key:I="default"}=n,b=_.useMemo(()=>{let R=Li(m,u);return R==null?null:{location:{pathname:R,search:p,hash:x,state:j,key:I},navigationType:i}},[u,m,p,x,j,I,i]);return b==null?null:_.createElement(xs.Provider,{value:d},_.createElement(mu.Provider,{children:r,value:b}))}function Wr(t){let{children:e,location:r}=t;return y1(Mh(e),r)}new Promise(()=>{});function Mh(t,e){e===void 0&&(e=[]);let r=[];return _.Children.forEach(t,(n,i)=>{if(!_.isValidElement(n))return;let a=[...e,i];if(n.type===_.Fragment){r.push.apply(r,Mh(n.props.children,a));return}n.type!==ee&&We(!1),!n.props.index||!n.props.children||We(!1);let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Mh(n.props.children,a)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dc(){return Dc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Dc.apply(this,arguments)}function lw(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function D1(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function O1(t,e){return t.button===0&&(!e||e==="_self")&&!D1(t)}const L1=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],M1=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],V1="6";try{window.__reactRouterVersion=V1}catch{}const F1=_.createContext({isTransitioning:!1}),U1="startTransition",fx=Aj[U1];function B1(t){let{basename:e,children:r,future:n,window:i}=t,a=_.useRef();a.current==null&&(a.current=zS({window:i,v5Compat:!0}));let o=a.current,[c,u]=_.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},m=_.useCallback(p=>{d&&fx?fx(()=>u(p)):u(p)},[u,d]);return _.useLayoutEffect(()=>o.listen(m),[o,m]),_.useEffect(()=>A1(n),[n]),_.createElement(R1,{basename:e,children:r,location:c.location,navigationType:c.action,navigator:o,future:n})}const $1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",z1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xe=_.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:m,viewTransition:p}=e,x=lw(e,L1),{basename:j}=_.useContext(xs),I,b=!1;if(typeof d=="string"&&z1.test(d)&&(I=d,$1))try{let f=new URL(window.location.href),E=d.startsWith("//")?new URL(f.protocol+d):new URL(d),P=Li(E.pathname,j);E.origin===f.origin&&P!=null?d=P+E.search+E.hash:b=!0}catch{}let R=f1(d,{relative:i}),v=W1(d,{replace:o,state:c,target:u,preventScrollReset:m,relative:i,viewTransition:p});function y(f){n&&n(f),f.defaultPrevented||v(f)}return _.createElement("a",Dc({},x,{href:I||R,onClick:b||a?n:y,ref:r,target:u}))}),px=_.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:a="",end:o=!1,style:c,to:u,viewTransition:d,children:m}=e,p=lw(e,M1),x=fu(u,{relative:p.relative}),j=Un(),I=_.useContext(rw),{navigator:b,basename:R}=_.useContext(xs),v=I!=null&&H1(x)&&d===!0,y=b.encodeLocation?b.encodeLocation(x).pathname:x.pathname,f=j.pathname,E=I&&I.navigation&&I.navigation.location?I.navigation.location.pathname:null;i||(f=f.toLowerCase(),E=E?E.toLowerCase():null,y=y.toLowerCase()),E&&R&&(E=Li(E,R)||E);const P=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let F=f===y||!o&&f.startsWith(y)&&f.charAt(P)==="/",N=E!=null&&(E===y||!o&&E.startsWith(y)&&E.charAt(y.length)==="/"),w={isActive:F,isPending:N,isTransitioning:v},T=F?n:void 0,A;typeof a=="function"?A=a(w):A=[a,F?"active":null,N?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let D=typeof c=="function"?c(w):c;return _.createElement(xe,Dc({},p,{"aria-current":T,className:A,ref:r,style:D,to:u,viewTransition:d}),typeof m=="function"?m(w):m)});var Vh;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Vh||(Vh={}));var gx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(gx||(gx={}));function q1(t){let e=_.useContext(hu);return e||We(!1),e}function W1(t,e){let{target:r,replace:n,state:i,preventScrollReset:a,relative:o,viewTransition:c}=e===void 0?{}:e,u=Zt(),d=Un(),m=fu(t,{relative:o});return _.useCallback(p=>{if(O1(p,r)){p.preventDefault();let x=n!==void 0?n:Rc(d)===Rc(m);u(t,{replace:x,state:i,preventScrollReset:a,relative:o,viewTransition:c})}},[d,u,m,n,i,r,t,a,o,c])}function H1(t,e){e===void 0&&(e={});let r=_.useContext(F1);r==null&&We(!1);let{basename:n}=q1(Vh.useViewTransitionState),i=fu(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=Li(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Li(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Lh(i.pathname,o)!=null||Lh(i.pathname,a)!=null}var xx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},K1=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],o=t[r++],c=t[r++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},uw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,c=o?t[i+1]:0,u=i+2<t.length,d=u?t[i+2]:0,m=a>>2,p=(a&3)<<4|c>>4;let x=(c&15)<<2|d>>6,j=d&63;u||(j=64,o||(x=64)),n.push(r[m],r[p],r[x],r[j])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(cw(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):K1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const d=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new G1;const x=a<<2|c>>4;if(n.push(x),d!==64){const j=c<<4&240|d>>2;if(n.push(j),p!==64){const I=d<<6&192|p;n.push(I)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class G1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Q1=function(t){const e=cw(t);return uw.encodeByteArray(e,!0)},Oc=function(t){return Q1(t).replace(/\./g,"")},dw=function(t){try{return uw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1=()=>Y1().__FIREBASE_DEFAULTS__,X1=()=>{if(typeof process>"u"||typeof xx>"u")return;const t=xx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Z1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&dw(t[1]);return e&&JSON.parse(e)},pu=()=>{try{return J1()||X1()||Z1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},hw=t=>{var e,r;return(r=(e=pu())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},eE=t=>{const e=hw(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},mw=()=>{var t;return(t=pu())===null||t===void 0?void 0:t.config},fw=t=>{var e;return(e=pu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Oc(JSON.stringify(r)),Oc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pt())}function nE(){var t;const e=(t=pu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iE(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function aE(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function oE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function lE(){const t=Pt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function cE(){return!nE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uE(){try{return typeof indexedDB=="object"}catch{return!1}}function dE(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE="FirebaseError";class ys extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=hE,Object.setPrototypeOf(this,ys.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fo.prototype.create)}}class Fo{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?mE(a,n):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new ys(i,c,n)}}function mE(t,e){return t.replace(fE,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const fE=/\{\$([^}]+)}/g;function pE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Lc(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],o=e[i];if(yx(a)&&yx(o)){if(!Lc(a,o))return!1}else if(a!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function yx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function La(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function Ma(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function gE(t,e){const r=new xE(t,e);return r.subscribe.bind(r)}class xE{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");yE(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Id),i.error===void 0&&(i.error=Id),i.complete===void 0&&(i.complete=Id);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yE(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Id(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t){return t&&t._delegate?t._delegate:t}class Tn{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new tE;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(bE(e))try{this.getOrInitializeService({instanceIdentifier:xn})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=xn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xn){return this.instances.has(e)}getOptions(e=xn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&o.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(i,a);const o=this.instances.get(i);return o&&e(o,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:wE(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=xn){return this.component?this.component.multipleInstances?e:xn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wE(t){return t===xn?void 0:t}function bE(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new vE(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ne||(Ne={}));const jE={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},_E=Ne.INFO,SE={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},EE=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=SE[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class cf{constructor(e){this.name=e,this._logLevel=_E,this._logHandler=EE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...e),this._logHandler(this,Ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...e),this._logHandler(this,Ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...e),this._logHandler(this,Ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...e),this._logHandler(this,Ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...e),this._logHandler(this,Ne.ERROR,...e)}}const CE=(t,e)=>e.some(r=>t instanceof r);let vx,wx;function kE(){return vx||(vx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function IE(){return wx||(wx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pw=new WeakMap,Fh=new WeakMap,gw=new WeakMap,Td=new WeakMap,uf=new WeakMap;function TE(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(Hs(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&pw.set(r,t)}).catch(()=>{}),uf.set(e,t),e}function AE(t){if(Fh.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});Fh.set(t,e)}let Uh={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Fh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||gw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Hs(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function PE(t){Uh=t(Uh)}function RE(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Ad(this),e,...r);return gw.set(n,e.sort?e.sort():[e]),Hs(n)}:IE().includes(t)?function(...e){return t.apply(Ad(this),e),Hs(pw.get(this))}:function(...e){return Hs(t.apply(Ad(this),e))}}function DE(t){return typeof t=="function"?RE(t):(t instanceof IDBTransaction&&AE(t),CE(t,kE())?new Proxy(t,Uh):t)}function Hs(t){if(t instanceof IDBRequest)return TE(t);if(Td.has(t))return Td.get(t);const e=DE(t);return e!==t&&(Td.set(t,e),uf.set(e,t)),e}const Ad=t=>uf.get(t);function OE(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),c=Hs(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Hs(o.result),u.oldVersion,u.newVersion,Hs(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const LE=["get","getKey","getAll","getAllKeys","count"],ME=["put","add","delete","clear"],Pd=new Map;function bx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Pd.get(e))return Pd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=ME.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||LE.includes(r)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return n&&(d=d.index(c.shift())),(await Promise.all([d[r](...c),i&&u.done]))[0]};return Pd.set(e,a),a}PE(t=>({...t,get:(e,r,n)=>bx(e,r)||t.get(e,r,n),has:(e,r)=>!!bx(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(FE(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function FE(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bh="@firebase/app",Nx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds=new cf("@firebase/app"),UE="@firebase/app-compat",BE="@firebase/analytics-compat",$E="@firebase/analytics",zE="@firebase/app-check-compat",qE="@firebase/app-check",WE="@firebase/auth",HE="@firebase/auth-compat",KE="@firebase/database",GE="@firebase/data-connect",QE="@firebase/database-compat",YE="@firebase/functions",JE="@firebase/functions-compat",XE="@firebase/installations",ZE="@firebase/installations-compat",e2="@firebase/messaging",t2="@firebase/messaging-compat",r2="@firebase/performance",s2="@firebase/performance-compat",n2="@firebase/remote-config",i2="@firebase/remote-config-compat",a2="@firebase/storage",o2="@firebase/storage-compat",l2="@firebase/firestore",c2="@firebase/vertexai-preview",u2="@firebase/firestore-compat",d2="firebase",h2="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h="[DEFAULT]",m2={[Bh]:"fire-core",[UE]:"fire-core-compat",[$E]:"fire-analytics",[BE]:"fire-analytics-compat",[qE]:"fire-app-check",[zE]:"fire-app-check-compat",[WE]:"fire-auth",[HE]:"fire-auth-compat",[KE]:"fire-rtdb",[GE]:"fire-data-connect",[QE]:"fire-rtdb-compat",[YE]:"fire-fn",[JE]:"fire-fn-compat",[XE]:"fire-iid",[ZE]:"fire-iid-compat",[e2]:"fire-fcm",[t2]:"fire-fcm-compat",[r2]:"fire-perf",[s2]:"fire-perf-compat",[n2]:"fire-rc",[i2]:"fire-rc-compat",[a2]:"fire-gcs",[o2]:"fire-gcs-compat",[l2]:"fire-fst",[u2]:"fire-fst-compat",[c2]:"fire-vertex","fire-js":"fire-js",[d2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=new Map,f2=new Map,zh=new Map;function jx(t,e){try{t.container.addComponent(e)}catch(r){ds.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Mi(t){const e=t.name;if(zh.has(e))return ds.debug(`There were multiple attempts to register component ${e}.`),!1;zh.set(e,t);for(const r of Mc.values())jx(r,t);for(const r of f2.values())jx(r,t);return!0}function df(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Lr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ks=new Fo("app","Firebase",p2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Tn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ks.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi=h2;function xw(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:$h,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Ks.create("bad-app-name",{appName:String(i)});if(r||(r=mw()),!r)throw Ks.create("no-options");const a=Mc.get(i);if(a){if(Lc(r,a.options)&&Lc(n,a.config))return a;throw Ks.create("duplicate-app",{appName:i})}const o=new NE(i);for(const u of zh.values())o.addComponent(u);const c=new g2(r,n,o);return Mc.set(i,c),c}function yw(t=$h){const e=Mc.get(t);if(!e&&t===$h&&mw())return xw();if(!e)throw Ks.create("no-app",{appName:t});return e}function Gs(t,e,r){var n;let i=(n=m2[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const a=i.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ds.warn(c.join(" "));return}Mi(new Tn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2="firebase-heartbeat-database",y2=1,jo="firebase-heartbeat-store";let Rd=null;function vw(){return Rd||(Rd=OE(x2,y2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jo)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ks.create("idb-open",{originalErrorMessage:t.message})})),Rd}async function v2(t){try{const r=(await vw()).transaction(jo),n=await r.objectStore(jo).get(ww(t));return await r.done,n}catch(e){if(e instanceof ys)ds.warn(e.message);else{const r=Ks.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ds.warn(r.message)}}}async function _x(t,e){try{const n=(await vw()).transaction(jo,"readwrite");await n.objectStore(jo).put(e,ww(t)),await n.done}catch(r){if(r instanceof ys)ds.warn(r.message);else{const n=Ks.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ds.warn(n.message)}}}function ww(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=1024,b2=30*24*60*60*1e3;class N2{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new _2(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Sx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=b2}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ds.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Sx(),{heartbeatsToSend:n,unsentEntries:i}=j2(this._heartbeatsCache.heartbeats),a=Oc(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return ds.warn(r),""}}}function Sx(){return new Date().toISOString().substring(0,10)}function j2(t,e=w2){const r=[];let n=t.slice();for(const i of t){const a=r.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),Ex(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Ex(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class _2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uE()?dE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await v2(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return _x(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return _x(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Ex(t){return Oc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S2(t){Mi(new Tn("platform-logger",e=>new VE(e),"PRIVATE")),Mi(new Tn("heartbeat",e=>new N2(e),"PRIVATE")),Gs(Bh,Nx,t),Gs(Bh,Nx,"esm2017"),Gs("fire-js","")}S2("");function hf(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function bw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const E2=bw,Nw=new Fo("auth","Firebase",bw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc=new cf("@firebase/auth");function C2(t,...e){Vc.logLevel<=Ne.WARN&&Vc.warn(`Auth (${Xi}): ${t}`,...e)}function ec(t,...e){Vc.logLevel<=Ne.ERROR&&Vc.error(`Auth (${Xi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(t,...e){throw mf(t,...e)}function Fr(t,...e){return mf(t,...e)}function jw(t,e,r){const n=Object.assign(Object.assign({},E2()),{[e]:r});return new Fo("auth","Firebase",n).create(e,{appName:t.name})}function is(t){return jw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mf(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Nw.create(t,...e)}function de(t,e,...r){if(!t)throw mf(e,...r)}function Zr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ec(e),new Error(e)}function hs(t,e){t||Zr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function k2(){return Cx()==="http:"||Cx()==="https:"}function Cx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(k2()||aE()||"connection"in navigator)?navigator.onLine:!0}function T2(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,r){this.shortDelay=e,this.longDelay=r,hs(r>e,"Short delay should be less than long delay!"),this.isMobile=sE()||oE()}get(){return I2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t,e){hs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2=new Bo(3e4,6e4);function on(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ln(t,e,r,n,i={}){return Sw(t,i,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const c=Uo(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},a);return iE()||(d.referrerPolicy="no-referrer"),_w.fetch()(Ew(t,t.config.apiHost,r,c),d)})}async function Sw(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},A2),e);try{const i=new D2(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Ll(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ll(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ll(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ll(t,"user-disabled",o);const m=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw jw(t,m,d);Ir(t,m)}}catch(i){if(i instanceof ys)throw i;Ir(t,"network-request-failed",{message:String(i)})}}async function $o(t,e,r,n,i={}){const a=await ln(t,e,r,n,i);return"mfaPendingCredential"in a&&Ir(t,"multi-factor-auth-required",{_serverResponse:a}),a}function Ew(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?ff(t.config,i):`${t.config.apiScheme}://${i}`}function R2(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class D2{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Fr(this.auth,"network-request-failed")),P2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ll(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Fr(t,e,n);return i.customData._tokenResponse=r,i}function kx(t){return t!==void 0&&t.enterprise!==void 0}class O2{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return R2(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function L2(t,e){return ln(t,"GET","/v2/recaptchaConfig",on(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M2(t,e){return ln(t,"POST","/v1/accounts:delete",e)}async function Cw(t,e){return ln(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function V2(t,e=!1){const r=tt(t),n=await r.getIdToken(e),i=pf(n);de(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a==null?void 0:a.sign_in_provider;return{claims:i,token:n,authTime:Xa(Dd(i.auth_time)),issuedAtTime:Xa(Dd(i.iat)),expirationTime:Xa(Dd(i.exp)),signInProvider:o||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Dd(t){return Number(t)*1e3}function pf(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return ec("JWT malformed, contained fewer than 3 sections"),null;try{const i=dw(r);return i?JSON.parse(i):(ec("Failed to decode base64 JWT payload"),null)}catch(i){return ec("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Ix(t){const e=pf(t);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _o(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof ys&&F2(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function F2({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Xa(this.lastLoginAt),this.creationTime=Xa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fc(t){var e;const r=t.auth,n=await t.getIdToken(),i=await _o(t,Cw(r,{idToken:n}));de(i==null?void 0:i.users.length,r,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const o=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?kw(a.providerUserInfo):[],c=$2(t.providerData,o),u=t.isAnonymous,d=!(t.email&&a.passwordHash)&&!(c!=null&&c.length),m=u?d:!1,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Wh(a.createdAt,a.lastLoginAt),isAnonymous:m};Object.assign(t,p)}async function B2(t){const e=tt(t);await Fc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $2(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function kw(t){return t.map(e=>{var{providerId:r}=e,n=hf(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z2(t,e){const r=await Sw(t,{},async()=>{const n=Uo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=Ew(t,i,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",_w.fetch()(o,{method:"POST",headers:c,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function q2(t,e){return ln(t,"POST","/v2/accounts:revokeToken",on(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ix(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){de(e.length!==0,"internal-error");const r=Ix(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await z2(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,o=new Ni;return n&&(de(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(de(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(de(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ni,this.toJSON())}_performRefresh(){return Zr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s(t,e){de(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class es{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,a=hf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new U2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Wh(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await _o(this,this.stsTokenManager.getToken(this.auth,e));return de(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return V2(this,e)}reload(){return B2(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new es(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Fc(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Lr(this.auth.app))return Promise.reject(is(this.auth));const e=await this.getIdToken();return await _o(this,M2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,a,o,c,u,d,m;const p=(n=r.displayName)!==null&&n!==void 0?n:void 0,x=(i=r.email)!==null&&i!==void 0?i:void 0,j=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,I=(o=r.photoURL)!==null&&o!==void 0?o:void 0,b=(c=r.tenantId)!==null&&c!==void 0?c:void 0,R=(u=r._redirectEventId)!==null&&u!==void 0?u:void 0,v=(d=r.createdAt)!==null&&d!==void 0?d:void 0,y=(m=r.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:f,emailVerified:E,isAnonymous:P,providerData:F,stsTokenManager:N}=r;de(f&&N,e,"internal-error");const w=Ni.fromJSON(this.name,N);de(typeof f=="string",e,"internal-error"),_s(p,e.name),_s(x,e.name),de(typeof E=="boolean",e,"internal-error"),de(typeof P=="boolean",e,"internal-error"),_s(j,e.name),_s(I,e.name),_s(b,e.name),_s(R,e.name),_s(v,e.name),_s(y,e.name);const T=new es({uid:f,auth:e,email:x,emailVerified:E,displayName:p,isAnonymous:P,photoURL:I,phoneNumber:j,tenantId:b,stsTokenManager:w,createdAt:v,lastLoginAt:y});return F&&Array.isArray(F)&&(T.providerData=F.map(A=>Object.assign({},A))),R&&(T._redirectEventId=R),T}static async _fromIdTokenResponse(e,r,n=!1){const i=new Ni;i.updateFromServerResponse(r);const a=new es({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Fc(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];de(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?kw(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(a!=null&&a.length),c=new Ni;c.updateFromIdToken(n);const u=new es({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Wh(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(a!=null&&a.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx=new Map;function ts(t){hs(t instanceof Function,"Expected a class definition");let e=Tx.get(t);return e?(hs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Tx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Iw.type="NONE";const Ax=Iw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tc(t,e,r){return`firebase:${t}:${e}:${r}`}class ji{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=tc(this.userKey,i.apiKey,a),this.fullPersistenceKey=tc("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?es._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new ji(ts(Ax),e,n);const i=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||ts(Ax);const o=tc(n,e.config.apiKey,e.name);let c=null;for(const d of r)try{const m=await d._get(o);if(m){const p=es._fromJSON(e,m);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new ji(a,e,n):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(r.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new ji(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Px(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Rw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Tw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ow(e))return"Blackberry";if(Lw(e))return"Webos";if(Aw(e))return"Safari";if((e.includes("chrome/")||Pw(e))&&!e.includes("edge/"))return"Chrome";if(Dw(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Tw(t=Pt()){return/firefox\//i.test(t)}function Aw(t=Pt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Pw(t=Pt()){return/crios\//i.test(t)}function Rw(t=Pt()){return/iemobile/i.test(t)}function Dw(t=Pt()){return/android/i.test(t)}function Ow(t=Pt()){return/blackberry/i.test(t)}function Lw(t=Pt()){return/webos/i.test(t)}function gf(t=Pt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function W2(t=Pt()){var e;return gf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function H2(){return lE()&&document.documentMode===10}function Mw(t=Pt()){return gf(t)||Dw(t)||Lw(t)||Ow(t)||/windows phone/i.test(t)||Rw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vw(t,e=[]){let r;switch(t){case"Browser":r=Px(Pt());break;case"Worker":r=`${Px(Pt())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Xi}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G2(t,e={}){return ln(t,"GET","/v2/passwordPolicy",on(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2=6;class Y2{constructor(e){var r,n,i,a;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:Q2,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,a,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(r=u.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(n=u.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsUppercaseLetter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rx(this),this.idTokenSubscription=new Rx(this),this.beforeStateQueue=new K2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Nw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ts(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ji.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Cw(this,{idToken:e}),n=await es._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Lr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,c=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(i=u.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Fc(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=T2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Lr(this.app))return Promise.reject(is(this));const r=e?tt(e):null;return r&&de(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Lr(this.app)?Promise.reject(is(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Lr(this.app)?Promise.reject(is(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ts(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await G2(this),r=new Y2(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Fo("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await q2(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ts(e)||this._popupRedirectResolver;de(r,this,"argument-error"),this.redirectPersistenceManager=await ji.create(this,[ts(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{o=!0,u()}}else{const u=e.addObserver(r);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Vw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&C2(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function $n(t){return tt(t)}class Rx{constructor(e){this.auth=e,this.observer=null,this.addObserver=gE(r=>this.observer=r)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function X2(t){gu=t}function Fw(t){return gu.loadJS(t)}function Z2(){return gu.recaptchaEnterpriseScript}function eC(){return gu.gapiScript}function tC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const rC="recaptcha-enterprise",sC="NO_RECAPTCHA";class nC{constructor(e){this.type=rC,this.auth=$n(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{L2(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new O2(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;kx(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(sC)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,o)=>{n(this.auth).then(c=>{if(!r&&kx(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=Z2();u.length!==0&&(u+=c),Fw(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function Dx(t,e,r,n=!1){const i=new nC(t);let a;try{a=await i.verify(r)}catch{a=await i.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Hh(t,e,r,n){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Dx(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Dx(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(t,e){const r=df(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(Lc(a,e??{}))return i;Ir(i,"already-initialized")}return r.initialize({options:e})}function aC(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ts);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function oC(t,e,r){const n=$n(t);de(n._canInitEmulator,n,"emulator-config-failed"),de(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=Uw(e),{host:o,port:c}=lC(e),u=c===null?"":`:${c}`;n.config.emulator={url:`${a}//${o}${u}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),cC()}function Uw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function lC(t){const e=Uw(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:Ox(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:Ox(o)}}}function Ox(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function cC(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Zr("not implemented")}_getIdTokenResponse(e){return Zr("not implemented")}_linkToIdToken(e,r){return Zr("not implemented")}_getReauthenticationResolver(e){return Zr("not implemented")}}async function uC(t,e){return ln(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dC(t,e){return $o(t,"POST","/v1/accounts:signInWithPassword",on(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hC(t,e){return $o(t,"POST","/v1/accounts:signInWithEmailLink",on(t,e))}async function mC(t,e){return $o(t,"POST","/v1/accounts:signInWithEmailLink",on(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So extends xf{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new So(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new So(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Hh(e,r,"signInWithPassword",dC);case"emailLink":return hC(e,{email:this._email,oobCode:this._password});default:Ir(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Hh(e,n,"signUpPassword",uC);case"emailLink":return mC(e,{idToken:r,email:this._email,oobCode:this._password});default:Ir(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _i(t,e){return $o(t,"POST","/v1/accounts:signInWithIdp",on(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="http://localhost";class An extends xf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new An(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ir("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,a=hf(r,["providerId","signInMethod"]);if(!n||!i)return null;const o=new An(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return _i(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,_i(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,_i(e,r)}buildRequest(){const e={requestUri:fC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Uo(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function gC(t){const e=La(Ma(t)).link,r=e?La(Ma(e)).deep_link_id:null,n=La(Ma(t)).deep_link_id;return(n?La(Ma(n)).link:null)||n||r||e||t}class yf{constructor(e){var r,n,i,a,o,c;const u=La(Ma(e)),d=(r=u.apiKey)!==null&&r!==void 0?r:null,m=(n=u.oobCode)!==null&&n!==void 0?n:null,p=pC((i=u.mode)!==null&&i!==void 0?i:null);de(d&&m&&p,"argument-error"),this.apiKey=d,this.operation=p,this.code=m,this.continueUrl=(a=u.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(o=u.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const r=gC(e);try{return new yf(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(){this.providerId=Zi.PROVIDER_ID}static credential(e,r){return So._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=yf.parseLink(r);return de(n,"argument-error"),So._fromEmailAndCode(e,n.code,n.tenantId)}}Zi.PROVIDER_ID="password";Zi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends Bw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends zo{constructor(){super("facebook.com")}static credential(e){return An._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Is.credential(e.oauthAccessToken)}catch{return null}}}Is.FACEBOOK_SIGN_IN_METHOD="facebook.com";Is.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends zo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return An._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Ts.credential(r,n)}catch{return null}}}Ts.GOOGLE_SIGN_IN_METHOD="google.com";Ts.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends zo{constructor(){super("github.com")}static credential(e){return An._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch{return null}}}As.GITHUB_SIGN_IN_METHOD="github.com";As.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps extends zo{constructor(){super("twitter.com")}static credential(e,r){return An._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ps.credential(r,n)}catch{return null}}}Ps.TWITTER_SIGN_IN_METHOD="twitter.com";Ps.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xC(t,e){return $o(t,"POST","/v1/accounts:signUp",on(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await es._fromIdTokenResponse(e,n,i),o=Lx(n);return new Pn({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Lx(n);return new Pn({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Lx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc extends ys{constructor(e,r,n,i){var a;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Uc.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Uc(e,r,n,i)}}function $w(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Uc._fromErrorAndOperation(t,a,e,n):a})}async function yC(t,e,r=!1){const n=await _o(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Pn._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vC(t,e,r=!1){const{auth:n}=t;if(Lr(n.app))return Promise.reject(is(n));const i="reauthenticate";try{const a=await _o(t,$w(n,i,e,t),r);de(a.idToken,n,"internal-error");const o=pf(a.idToken);de(o,n,"internal-error");const{sub:c}=o;return de(t.uid===c,n,"user-mismatch"),Pn._forOperation(t,i,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Ir(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zw(t,e,r=!1){if(Lr(t.app))return Promise.reject(is(t));const n="signIn",i=await $w(t,n,e),a=await Pn._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function wC(t,e){return zw($n(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qw(t){const e=$n(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function bC(t,e,r){if(Lr(t.app))return Promise.reject(is(t));const n=$n(t),o=await Hh(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",xC).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&qw(t),u}),c=await Pn._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(c.user),c}function NC(t,e,r){return Lr(t.app)?Promise.reject(is(t)):wC(tt(t),Zi.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&qw(t),n})}function jC(t,e,r,n){return tt(t).onIdTokenChanged(e,r,n)}function _C(t,e,r){return tt(t).beforeAuthStateChanged(e,r)}function SC(t,e,r,n){return tt(t).onAuthStateChanged(e,r,n)}function EC(t){return tt(t).signOut()}const Bc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Bc,"1"),this.storage.removeItem(Bc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=1e3,kC=10;class Hw extends Ww{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);H2()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,kC):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},CC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Hw.type="LOCAL";const IC=Hw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw extends Ww{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Kw.type="SESSION";const Gw=Kw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new xu(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(o).map(async d=>d(r.origin,a)),u=await TC(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}xu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=vf("",20);i.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(p){const x=p;if(x.data.eventId===d)switch(x.data.status){case"ack":clearTimeout(m),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(x.data.response);break;default:clearTimeout(m),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(){return window}function PC(t){Ur().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(){return typeof Ur().WorkerGlobalScope<"u"&&typeof Ur().importScripts=="function"}async function RC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function DC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function OC(){return Qw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw="firebaseLocalStorageDb",LC=1,$c="firebaseLocalStorage",Jw="fbase_key";class qo{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function yu(t,e){return t.transaction([$c],e?"readwrite":"readonly").objectStore($c)}function MC(){const t=indexedDB.deleteDatabase(Yw);return new qo(t).toPromise()}function Kh(){const t=indexedDB.open(Yw,LC);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore($c,{keyPath:Jw})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains($c)?e(n):(n.close(),await MC(),e(await Kh()))})})}async function Mx(t,e,r){const n=yu(t,!0).put({[Jw]:e,value:r});return new qo(n).toPromise()}async function VC(t,e){const r=yu(t,!1).get(e),n=await new qo(r).toPromise();return n===void 0?null:n.value}function Vx(t,e){const r=yu(t,!0).delete(e);return new qo(r).toPromise()}const FC=800,UC=3;class Xw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Kh(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>UC)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Qw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xu._getInstance(OC()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await RC(),!this.activeServiceWorker)return;this.sender=new AC(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||DC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Kh();return await Mx(e,Bc,"1"),await Vx(e,Bc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Mx(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>VC(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Vx(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=yu(i,!1).getAll();return new qo(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),FC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Xw.type="LOCAL";const BC=Xw;new Bo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(t,e){return e?ts(e):(de(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf extends xf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return _i(e,this._buildIdpRequest())}_linkToIdToken(e,r){return _i(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return _i(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function zC(t){return zw(t.auth,new wf(t),t.bypassAuthState)}function qC(t){const{auth:e,user:r}=t;return de(r,e,"internal-error"),vC(r,new wf(t),t.bypassAuthState)}async function WC(t){const{auth:e,user:r}=t;return de(r,e,"internal-error"),yC(r,new wf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zC;case"linkViaPopup":case"linkViaRedirect":return WC;case"reauthViaPopup":case"reauthViaRedirect":return qC;default:Ir(this.auth,"internal-error")}}resolve(e){hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC=new Bo(2e3,1e4);class pi extends Zw{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,pi.currentPopupAction&&pi.currentPopupAction.cancel(),pi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){hs(this.filter.length===1,"Popup operations only handle one event");const e=vf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Fr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Fr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,HC.get())};e()}}pi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC="pendingRedirect",rc=new Map;class GC extends Zw{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=rc.get(this.auth._key());if(!e){try{const n=await QC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}rc.set(this.auth._key(),e)}return this.bypassAuthState||rc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function QC(t,e){const r=XC(e),n=JC(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function YC(t,e){rc.set(t._key(),e)}function JC(t){return ts(t._redirectPersistence)}function XC(t){return tc(KC,t.config.apiKey,t.name)}async function ZC(t,e,r=!1){if(Lr(t.app))return Promise.reject(is(t));const n=$n(t),i=$C(n,e),o=await new GC(n,i,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek=10*60*1e3;class tk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!rk(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!eb(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Fr(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ek&&this.cachedEventUids.clear(),this.cachedEventUids.has(Fx(e))}saveEventToCache(e){this.cachedEventUids.add(Fx(e)),this.lastProcessedEventTime=Date.now()}}function Fx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function eb({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function rk(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sk(t,e={}){return ln(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ik=/^https?/;async function ak(t){if(t.config.emulator)return;const{authorizedDomains:e}=await sk(t);for(const r of e)try{if(ok(r))return}catch{}Ir(t,"unauthorized-domain")}function ok(t){const e=qh(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!ik.test(r))return!1;if(nk.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk=new Bo(3e4,6e4);function Ux(){const t=Ur().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function ck(t){return new Promise((e,r)=>{var n,i,a;function o(){Ux(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ux(),r(Fr(t,"network-request-failed"))},timeout:lk.get()})}if(!((i=(n=Ur().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((a=Ur().gapi)===null||a===void 0)&&a.load)o();else{const c=tC("iframefcb");return Ur()[c]=()=>{gapi.load?o():r(Fr(t,"network-request-failed"))},Fw(`${eC()}?onload=${c}`).catch(u=>r(u))}}).catch(e=>{throw sc=null,e})}let sc=null;function uk(t){return sc=sc||ck(t),sc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk=new Bo(5e3,15e3),hk="__/auth/iframe",mk="emulator/auth/iframe",fk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gk(t){const e=t.config;de(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?ff(e,mk):`https://${t.config.authDomain}/${hk}`,n={apiKey:e.apiKey,appName:t.name,v:Xi},i=pk.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${Uo(n).slice(1)}`}async function xk(t){const e=await uk(t),r=Ur().gapi;return de(r,t,"internal-error"),e.open({where:document.body,url:gk(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fk,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const o=Fr(t,"network-request-failed"),c=Ur().setTimeout(()=>{a(o)},dk.get());function u(){Ur().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vk=500,wk=600,bk="_blank",Nk="http://localhost";class Bx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function jk(t,e,r,n=vk,i=wk){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u=Object.assign(Object.assign({},yk),{width:n.toString(),height:i.toString(),top:a,left:o}),d=Pt().toLowerCase();r&&(c=Pw(d)?bk:r),Tw(d)&&(e=e||Nk,u.scrollbars="yes");const m=Object.entries(u).reduce((x,[j,I])=>`${x}${j}=${I},`,"");if(W2(d)&&c!=="_self")return _k(e||"",c),new Bx(null);const p=window.open(e||"",c,m);de(p,t,"popup-blocked");try{p.focus()}catch{}return new Bx(p)}function _k(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk="__/auth/handler",Ek="emulator/auth/handler",Ck=encodeURIComponent("fac");async function $x(t,e,r,n,i,a){de(t.config.authDomain,t,"auth-domain-config-required"),de(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Xi,eventId:i};if(e instanceof Bw){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",pE(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,p]of Object.entries({}))o[m]=p}if(e instanceof zo){const m=e.getScopes().filter(p=>p!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const u=await t._getAppCheckToken(),d=u?`#${Ck}=${encodeURIComponent(u)}`:"";return`${kk(t)}?${Uo(c).slice(1)}${d}`}function kk({config:t}){return t.emulator?ff(t,Ek):`https://${t.authDomain}/${Sk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od="webStorageSupport";class Ik{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Gw,this._completeRedirectFn=ZC,this._overrideRedirectResult=YC}async _openPopup(e,r,n,i){var a;hs((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await $x(e,r,n,qh(),i);return jk(e,o,vf())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await $x(e,r,n,qh(),i);return PC(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(hs(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await xk(e),n=new tk(e);return r.register("authEvent",i=>(de(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Od,{type:Od},i=>{var a;const o=(a=i==null?void 0:i[0])===null||a===void 0?void 0:a[Od];o!==void 0&&r(!!o),Ir(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=ak(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Mw()||Aw()||gf()}}const Tk=Ik;var zx="@firebase/auth",qx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Rk(t){Mi(new Tn("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Vw(t)},d=new J2(n,i,a,u);return aC(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Mi(new Tn("auth-internal",e=>{const r=$n(e.getProvider("auth").getImmediate());return(n=>new Ak(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Gs(zx,qx,Pk(t)),Gs(zx,qx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk=5*60,Ok=fw("authIdTokenMaxAge")||Dk;let Wx=null;const Lk=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Ok)return;const i=r==null?void 0:r.token;Wx!==i&&(Wx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Mk(t=yw()){const e=df(t,"auth");if(e.isInitialized())return e.getImmediate();const r=iC(t,{popupRedirectResolver:Tk,persistence:[BC,IC,Gw]}),n=fw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=Lk(a.toString());_C(r,o,()=>o(r.currentUser)),jC(r,c=>o(c))}}const i=hw("auth");return i&&oC(r,`http://${i}`),r}function Vk(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}X2({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=Fr("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",Vk().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Rk("Browser");var Fk="firebase",Uk="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gs(Fk,Uk,"app");var Hx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _n,tb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,w){function T(){}T.prototype=w.prototype,N.D=w.prototype,N.prototype=new T,N.prototype.constructor=N,N.C=function(A,D,C){for(var S=Array(arguments.length-2),H=2;H<arguments.length;H++)S[H-2]=arguments[H];return w.prototype[D].apply(A,S)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(N,w,T){T||(T=0);var A=Array(16);if(typeof w=="string")for(var D=0;16>D;++D)A[D]=w.charCodeAt(T++)|w.charCodeAt(T++)<<8|w.charCodeAt(T++)<<16|w.charCodeAt(T++)<<24;else for(D=0;16>D;++D)A[D]=w[T++]|w[T++]<<8|w[T++]<<16|w[T++]<<24;w=N.g[0],T=N.g[1],D=N.g[2];var C=N.g[3],S=w+(C^T&(D^C))+A[0]+3614090360&4294967295;w=T+(S<<7&4294967295|S>>>25),S=C+(D^w&(T^D))+A[1]+3905402710&4294967295,C=w+(S<<12&4294967295|S>>>20),S=D+(T^C&(w^T))+A[2]+606105819&4294967295,D=C+(S<<17&4294967295|S>>>15),S=T+(w^D&(C^w))+A[3]+3250441966&4294967295,T=D+(S<<22&4294967295|S>>>10),S=w+(C^T&(D^C))+A[4]+4118548399&4294967295,w=T+(S<<7&4294967295|S>>>25),S=C+(D^w&(T^D))+A[5]+1200080426&4294967295,C=w+(S<<12&4294967295|S>>>20),S=D+(T^C&(w^T))+A[6]+2821735955&4294967295,D=C+(S<<17&4294967295|S>>>15),S=T+(w^D&(C^w))+A[7]+4249261313&4294967295,T=D+(S<<22&4294967295|S>>>10),S=w+(C^T&(D^C))+A[8]+1770035416&4294967295,w=T+(S<<7&4294967295|S>>>25),S=C+(D^w&(T^D))+A[9]+2336552879&4294967295,C=w+(S<<12&4294967295|S>>>20),S=D+(T^C&(w^T))+A[10]+4294925233&4294967295,D=C+(S<<17&4294967295|S>>>15),S=T+(w^D&(C^w))+A[11]+2304563134&4294967295,T=D+(S<<22&4294967295|S>>>10),S=w+(C^T&(D^C))+A[12]+1804603682&4294967295,w=T+(S<<7&4294967295|S>>>25),S=C+(D^w&(T^D))+A[13]+4254626195&4294967295,C=w+(S<<12&4294967295|S>>>20),S=D+(T^C&(w^T))+A[14]+2792965006&4294967295,D=C+(S<<17&4294967295|S>>>15),S=T+(w^D&(C^w))+A[15]+1236535329&4294967295,T=D+(S<<22&4294967295|S>>>10),S=w+(D^C&(T^D))+A[1]+4129170786&4294967295,w=T+(S<<5&4294967295|S>>>27),S=C+(T^D&(w^T))+A[6]+3225465664&4294967295,C=w+(S<<9&4294967295|S>>>23),S=D+(w^T&(C^w))+A[11]+643717713&4294967295,D=C+(S<<14&4294967295|S>>>18),S=T+(C^w&(D^C))+A[0]+3921069994&4294967295,T=D+(S<<20&4294967295|S>>>12),S=w+(D^C&(T^D))+A[5]+3593408605&4294967295,w=T+(S<<5&4294967295|S>>>27),S=C+(T^D&(w^T))+A[10]+38016083&4294967295,C=w+(S<<9&4294967295|S>>>23),S=D+(w^T&(C^w))+A[15]+3634488961&4294967295,D=C+(S<<14&4294967295|S>>>18),S=T+(C^w&(D^C))+A[4]+3889429448&4294967295,T=D+(S<<20&4294967295|S>>>12),S=w+(D^C&(T^D))+A[9]+568446438&4294967295,w=T+(S<<5&4294967295|S>>>27),S=C+(T^D&(w^T))+A[14]+3275163606&4294967295,C=w+(S<<9&4294967295|S>>>23),S=D+(w^T&(C^w))+A[3]+4107603335&4294967295,D=C+(S<<14&4294967295|S>>>18),S=T+(C^w&(D^C))+A[8]+1163531501&4294967295,T=D+(S<<20&4294967295|S>>>12),S=w+(D^C&(T^D))+A[13]+2850285829&4294967295,w=T+(S<<5&4294967295|S>>>27),S=C+(T^D&(w^T))+A[2]+4243563512&4294967295,C=w+(S<<9&4294967295|S>>>23),S=D+(w^T&(C^w))+A[7]+1735328473&4294967295,D=C+(S<<14&4294967295|S>>>18),S=T+(C^w&(D^C))+A[12]+2368359562&4294967295,T=D+(S<<20&4294967295|S>>>12),S=w+(T^D^C)+A[5]+4294588738&4294967295,w=T+(S<<4&4294967295|S>>>28),S=C+(w^T^D)+A[8]+2272392833&4294967295,C=w+(S<<11&4294967295|S>>>21),S=D+(C^w^T)+A[11]+1839030562&4294967295,D=C+(S<<16&4294967295|S>>>16),S=T+(D^C^w)+A[14]+4259657740&4294967295,T=D+(S<<23&4294967295|S>>>9),S=w+(T^D^C)+A[1]+2763975236&4294967295,w=T+(S<<4&4294967295|S>>>28),S=C+(w^T^D)+A[4]+1272893353&4294967295,C=w+(S<<11&4294967295|S>>>21),S=D+(C^w^T)+A[7]+4139469664&4294967295,D=C+(S<<16&4294967295|S>>>16),S=T+(D^C^w)+A[10]+3200236656&4294967295,T=D+(S<<23&4294967295|S>>>9),S=w+(T^D^C)+A[13]+681279174&4294967295,w=T+(S<<4&4294967295|S>>>28),S=C+(w^T^D)+A[0]+3936430074&4294967295,C=w+(S<<11&4294967295|S>>>21),S=D+(C^w^T)+A[3]+3572445317&4294967295,D=C+(S<<16&4294967295|S>>>16),S=T+(D^C^w)+A[6]+76029189&4294967295,T=D+(S<<23&4294967295|S>>>9),S=w+(T^D^C)+A[9]+3654602809&4294967295,w=T+(S<<4&4294967295|S>>>28),S=C+(w^T^D)+A[12]+3873151461&4294967295,C=w+(S<<11&4294967295|S>>>21),S=D+(C^w^T)+A[15]+530742520&4294967295,D=C+(S<<16&4294967295|S>>>16),S=T+(D^C^w)+A[2]+3299628645&4294967295,T=D+(S<<23&4294967295|S>>>9),S=w+(D^(T|~C))+A[0]+4096336452&4294967295,w=T+(S<<6&4294967295|S>>>26),S=C+(T^(w|~D))+A[7]+1126891415&4294967295,C=w+(S<<10&4294967295|S>>>22),S=D+(w^(C|~T))+A[14]+2878612391&4294967295,D=C+(S<<15&4294967295|S>>>17),S=T+(C^(D|~w))+A[5]+4237533241&4294967295,T=D+(S<<21&4294967295|S>>>11),S=w+(D^(T|~C))+A[12]+1700485571&4294967295,w=T+(S<<6&4294967295|S>>>26),S=C+(T^(w|~D))+A[3]+2399980690&4294967295,C=w+(S<<10&4294967295|S>>>22),S=D+(w^(C|~T))+A[10]+4293915773&4294967295,D=C+(S<<15&4294967295|S>>>17),S=T+(C^(D|~w))+A[1]+2240044497&4294967295,T=D+(S<<21&4294967295|S>>>11),S=w+(D^(T|~C))+A[8]+1873313359&4294967295,w=T+(S<<6&4294967295|S>>>26),S=C+(T^(w|~D))+A[15]+4264355552&4294967295,C=w+(S<<10&4294967295|S>>>22),S=D+(w^(C|~T))+A[6]+2734768916&4294967295,D=C+(S<<15&4294967295|S>>>17),S=T+(C^(D|~w))+A[13]+1309151649&4294967295,T=D+(S<<21&4294967295|S>>>11),S=w+(D^(T|~C))+A[4]+4149444226&4294967295,w=T+(S<<6&4294967295|S>>>26),S=C+(T^(w|~D))+A[11]+3174756917&4294967295,C=w+(S<<10&4294967295|S>>>22),S=D+(w^(C|~T))+A[2]+718787259&4294967295,D=C+(S<<15&4294967295|S>>>17),S=T+(C^(D|~w))+A[9]+3951481745&4294967295,N.g[0]=N.g[0]+w&4294967295,N.g[1]=N.g[1]+(D+(S<<21&4294967295|S>>>11))&4294967295,N.g[2]=N.g[2]+D&4294967295,N.g[3]=N.g[3]+C&4294967295}n.prototype.u=function(N,w){w===void 0&&(w=N.length);for(var T=w-this.blockSize,A=this.B,D=this.h,C=0;C<w;){if(D==0)for(;C<=T;)i(this,N,C),C+=this.blockSize;if(typeof N=="string"){for(;C<w;)if(A[D++]=N.charCodeAt(C++),D==this.blockSize){i(this,A),D=0;break}}else for(;C<w;)if(A[D++]=N[C++],D==this.blockSize){i(this,A),D=0;break}}this.h=D,this.o+=w},n.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var w=1;w<N.length-8;++w)N[w]=0;var T=8*this.o;for(w=N.length-8;w<N.length;++w)N[w]=T&255,T/=256;for(this.u(N),N=Array(16),w=T=0;4>w;++w)for(var A=0;32>A;A+=8)N[T++]=this.g[w]>>>A&255;return N};function a(N,w){var T=c;return Object.prototype.hasOwnProperty.call(T,N)?T[N]:T[N]=w(N)}function o(N,w){this.h=w;for(var T=[],A=!0,D=N.length-1;0<=D;D--){var C=N[D]|0;A&&C==w||(T[D]=C,A=!1)}this.g=T}var c={};function u(N){return-128<=N&&128>N?a(N,function(w){return new o([w|0],0>w?-1:0)}):new o([N|0],0>N?-1:0)}function d(N){if(isNaN(N)||!isFinite(N))return p;if(0>N)return R(d(-N));for(var w=[],T=1,A=0;N>=T;A++)w[A]=N/T|0,T*=4294967296;return new o(w,0)}function m(N,w){if(N.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(N.charAt(0)=="-")return R(m(N.substring(1),w));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=d(Math.pow(w,8)),A=p,D=0;D<N.length;D+=8){var C=Math.min(8,N.length-D),S=parseInt(N.substring(D,D+C),w);8>C?(C=d(Math.pow(w,C)),A=A.j(C).add(d(S))):(A=A.j(T),A=A.add(d(S)))}return A}var p=u(0),x=u(1),j=u(16777216);t=o.prototype,t.m=function(){if(b(this))return-R(this).m();for(var N=0,w=1,T=0;T<this.g.length;T++){var A=this.i(T);N+=(0<=A?A:4294967296+A)*w,w*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(I(this))return"0";if(b(this))return"-"+R(this).toString(N);for(var w=d(Math.pow(N,6)),T=this,A="";;){var D=E(T,w).g;T=v(T,D.j(w));var C=((0<T.g.length?T.g[0]:T.h)>>>0).toString(N);if(T=D,I(T))return C+A;for(;6>C.length;)C="0"+C;A=C+A}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function I(N){if(N.h!=0)return!1;for(var w=0;w<N.g.length;w++)if(N.g[w]!=0)return!1;return!0}function b(N){return N.h==-1}t.l=function(N){return N=v(this,N),b(N)?-1:I(N)?0:1};function R(N){for(var w=N.g.length,T=[],A=0;A<w;A++)T[A]=~N.g[A];return new o(T,~N.h).add(x)}t.abs=function(){return b(this)?R(this):this},t.add=function(N){for(var w=Math.max(this.g.length,N.g.length),T=[],A=0,D=0;D<=w;D++){var C=A+(this.i(D)&65535)+(N.i(D)&65535),S=(C>>>16)+(this.i(D)>>>16)+(N.i(D)>>>16);A=S>>>16,C&=65535,S&=65535,T[D]=S<<16|C}return new o(T,T[T.length-1]&-2147483648?-1:0)};function v(N,w){return N.add(R(w))}t.j=function(N){if(I(this)||I(N))return p;if(b(this))return b(N)?R(this).j(R(N)):R(R(this).j(N));if(b(N))return R(this.j(R(N)));if(0>this.l(j)&&0>N.l(j))return d(this.m()*N.m());for(var w=this.g.length+N.g.length,T=[],A=0;A<2*w;A++)T[A]=0;for(A=0;A<this.g.length;A++)for(var D=0;D<N.g.length;D++){var C=this.i(A)>>>16,S=this.i(A)&65535,H=N.i(D)>>>16,W=N.i(D)&65535;T[2*A+2*D]+=S*W,y(T,2*A+2*D),T[2*A+2*D+1]+=C*W,y(T,2*A+2*D+1),T[2*A+2*D+1]+=S*H,y(T,2*A+2*D+1),T[2*A+2*D+2]+=C*H,y(T,2*A+2*D+2)}for(A=0;A<w;A++)T[A]=T[2*A+1]<<16|T[2*A];for(A=w;A<2*w;A++)T[A]=0;return new o(T,0)};function y(N,w){for(;(N[w]&65535)!=N[w];)N[w+1]+=N[w]>>>16,N[w]&=65535,w++}function f(N,w){this.g=N,this.h=w}function E(N,w){if(I(w))throw Error("division by zero");if(I(N))return new f(p,p);if(b(N))return w=E(R(N),w),new f(R(w.g),R(w.h));if(b(w))return w=E(N,R(w)),new f(R(w.g),w.h);if(30<N.g.length){if(b(N)||b(w))throw Error("slowDivide_ only works with positive integers.");for(var T=x,A=w;0>=A.l(N);)T=P(T),A=P(A);var D=F(T,1),C=F(A,1);for(A=F(A,2),T=F(T,2);!I(A);){var S=C.add(A);0>=S.l(N)&&(D=D.add(T),C=S),A=F(A,1),T=F(T,1)}return w=v(N,D.j(w)),new f(D,w)}for(D=p;0<=N.l(w);){for(T=Math.max(1,Math.floor(N.m()/w.m())),A=Math.ceil(Math.log(T)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),C=d(T),S=C.j(w);b(S)||0<S.l(N);)T-=A,C=d(T),S=C.j(w);I(C)&&(C=x),D=D.add(C),N=v(N,S)}return new f(D,N)}t.A=function(N){return E(this,N).h},t.and=function(N){for(var w=Math.max(this.g.length,N.g.length),T=[],A=0;A<w;A++)T[A]=this.i(A)&N.i(A);return new o(T,this.h&N.h)},t.or=function(N){for(var w=Math.max(this.g.length,N.g.length),T=[],A=0;A<w;A++)T[A]=this.i(A)|N.i(A);return new o(T,this.h|N.h)},t.xor=function(N){for(var w=Math.max(this.g.length,N.g.length),T=[],A=0;A<w;A++)T[A]=this.i(A)^N.i(A);return new o(T,this.h^N.h)};function P(N){for(var w=N.g.length+1,T=[],A=0;A<w;A++)T[A]=N.i(A)<<1|N.i(A-1)>>>31;return new o(T,N.h)}function F(N,w){var T=w>>5;w%=32;for(var A=N.g.length-T,D=[],C=0;C<A;C++)D[C]=0<w?N.i(C+T)>>>w|N.i(C+T+1)<<32-w:N.i(C+T);return new o(D,N.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,tb=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=m,_n=o}).apply(typeof Hx<"u"?Hx:typeof self<"u"?self:typeof window<"u"?window:{});var Ml=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rb,Va,sb,nc,Gh,nb,ib,ab;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,g){return l==Array.prototype||l==Object.prototype||(l[h]=g.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ml=="object"&&Ml];for(var h=0;h<l.length;++h){var g=l[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=r(this);function i(l,h){if(h)e:{var g=n;l=l.split(".");for(var k=0;k<l.length-1;k++){var B=l[k];if(!(B in g))break e;g=g[B]}l=l[l.length-1],k=g[l],h=h(k),h!=k&&h!=null&&e(g,l,{configurable:!0,writable:!0,value:h})}}function a(l,h){l instanceof String&&(l+="");var g=0,k=!1,B={next:function(){if(!k&&g<l.length){var q=g++;return{value:h(q,l[q]),done:!1}}return k=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}i("Array.prototype.values",function(l){return l||function(){return a(this,function(h,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function m(l,h,g){return l.call.apply(l.bind,arguments)}function p(l,h,g){if(!l)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,k),l.apply(h,B)}}return function(){return l.apply(h,arguments)}}function x(l,h,g){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:p,x.apply(null,arguments)}function j(l,h){var g=Array.prototype.slice.call(arguments,1);return function(){var k=g.slice();return k.push.apply(k,arguments),l.apply(this,k)}}function I(l,h){function g(){}g.prototype=h.prototype,l.aa=h.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(k,B,q){for(var Z=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)Z[Pe-2]=arguments[Pe];return h.prototype[B].apply(k,Z)}}function b(l){const h=l.length;if(0<h){const g=Array(h);for(let k=0;k<h;k++)g[k]=l[k];return g}return[]}function R(l,h){for(let g=1;g<arguments.length;g++){const k=arguments[g];if(u(k)){const B=l.length||0,q=k.length||0;l.length=B+q;for(let Z=0;Z<q;Z++)l[B+Z]=k[Z]}else l.push(k)}}class v{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function y(l){return/^[\s\xa0]*$/.test(l)}function f(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function E(l){return E[" "](l),l}E[" "]=function(){};var P=f().indexOf("Gecko")!=-1&&!(f().toLowerCase().indexOf("webkit")!=-1&&f().indexOf("Edge")==-1)&&!(f().indexOf("Trident")!=-1||f().indexOf("MSIE")!=-1)&&f().indexOf("Edge")==-1;function F(l,h,g){for(const k in l)h.call(g,l[k],k,l)}function N(l,h){for(const g in l)h.call(void 0,l[g],g,l)}function w(l){const h={};for(const g in l)h[g]=l[g];return h}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(l,h){let g,k;for(let B=1;B<arguments.length;B++){k=arguments[B];for(g in k)l[g]=k[g];for(let q=0;q<T.length;q++)g=T[q],Object.prototype.hasOwnProperty.call(k,g)&&(l[g]=k[g])}}function D(l){var h=1;l=l.split(":");const g=[];for(;0<h&&l.length;)g.push(l.shift()),h--;return l.length&&g.push(l.join(":")),g}function C(l){c.setTimeout(()=>{throw l},0)}function S(){var l=L;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class H{constructor(){this.h=this.g=null}add(h,g){const k=W.get();k.set(h,g),this.h?this.h.next=k:this.g=k,this.h=k}}var W=new v(()=>new re,l=>l.reset());class re{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ce,O=!1,L=new H,U=()=>{const l=c.Promise.resolve(void 0);ce=()=>{l.then(M)}};var M=()=>{for(var l;l=S();){try{l.h.call(l.g)}catch(g){C(g)}var h=W;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}O=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};c.addEventListener("test",g,h),c.removeEventListener("test",g,h)}catch{}return l}();function X(l,h){if(z.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,k=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(P){e:{try{E(h.nodeName);var B=!0;break e}catch{}B=!1}B||(h=null)}}else g=="mouseover"?h=l.fromElement:g=="mouseout"&&(h=l.toElement);this.relatedTarget=h,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Q[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&X.aa.h.call(this)}}I(X,z);var Q={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ie="closure_listenable_"+(1e6*Math.random()|0),ye=0;function _e(l,h,g,k,B){this.listener=l,this.proxy=null,this.src=h,this.type=g,this.capture=!!k,this.ha=B,this.key=++ye,this.da=this.fa=!1}function Ue(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function ur(l){this.src=l,this.g={},this.h=0}ur.prototype.add=function(l,h,g,k,B){var q=l.toString();l=this.g[q],l||(l=this.g[q]=[],this.h++);var Z=la(l,h,k,B);return-1<Z?(h=l[Z],g||(h.fa=!1)):(h=new _e(h,this.src,q,!!k,B),h.fa=g,l.push(h)),h};function vs(l,h){var g=h.type;if(g in l.g){var k=l.g[g],B=Array.prototype.indexOf.call(k,h,void 0),q;(q=0<=B)&&Array.prototype.splice.call(k,B,1),q&&(Ue(h),l.g[g].length==0&&(delete l.g[g],l.h--))}}function la(l,h,g,k){for(var B=0;B<l.length;++B){var q=l[B];if(!q.da&&q.listener==h&&q.capture==!!g&&q.ha==k)return B}return-1}var Kn="closure_lm_"+(1e6*Math.random()|0),ca={};function $(l,h,g,k,B){if(Array.isArray(h)){for(var q=0;q<h.length;q++)$(l,h[q],g,k,B);return null}return g=np(g),l&&l[ie]?l.K(h,g,d(k)?!!k.capture:!1,B):se(l,h,g,!1,k,B)}function se(l,h,g,k,B,q){if(!h)throw Error("Invalid event type");var Z=d(B)?!!B.capture:!!B,Pe=Vu(l);if(Pe||(l[Kn]=Pe=new ur(l)),g=Pe.add(h,g,k,Z,q),g.proxy)return g;if(k=ge(),g.proxy=k,k.src=l,k.listener=g,l.addEventListener)K||(B=Z),B===void 0&&(B=!1),l.addEventListener(h.toString(),k,B);else if(l.attachEvent)l.attachEvent(qt(h.toString()),k);else if(l.addListener&&l.removeListener)l.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return g}function ge(){function l(g){return h.call(l.src,l.listener,g)}const h=BN;return l}function ue(l,h,g,k,B){if(Array.isArray(h))for(var q=0;q<h.length;q++)ue(l,h[q],g,k,B);else k=d(k)?!!k.capture:!!k,g=np(g),l&&l[ie]?(l=l.i,h=String(h).toString(),h in l.g&&(q=l.g[h],g=la(q,g,k,B),-1<g&&(Ue(q[g]),Array.prototype.splice.call(q,g,1),q.length==0&&(delete l.g[h],l.h--)))):l&&(l=Vu(l))&&(h=l.g[h.toString()],l=-1,h&&(l=la(h,g,k,B)),(g=-1<l?h[l]:null)&&Oe(g))}function Oe(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[ie])vs(h.i,l);else{var g=l.type,k=l.proxy;h.removeEventListener?h.removeEventListener(g,k,l.capture):h.detachEvent?h.detachEvent(qt(g),k):h.addListener&&h.removeListener&&h.removeListener(k),(g=Vu(h))?(vs(g,l),g.h==0&&(g.src=null,h[Kn]=null)):Ue(l)}}}function qt(l){return l in ca?ca[l]:ca[l]="on"+l}function BN(l,h){if(l.da)l=!0;else{h=new X(h,this);var g=l.listener,k=l.ha||l.src;l.fa&&Oe(l),l=g.call(k,h)}return l}function Vu(l){return l=l[Kn],l instanceof ur?l:null}var Fu="__closure_events_fn_"+(1e9*Math.random()>>>0);function np(l){return typeof l=="function"?l:(l[Fu]||(l[Fu]=function(h){return l.handleEvent(h)}),l[Fu])}function wt(){V.call(this),this.i=new ur(this),this.M=this,this.F=null}I(wt,V),wt.prototype[ie]=!0,wt.prototype.removeEventListener=function(l,h,g,k){ue(this,l,h,g,k)};function Dt(l,h){var g,k=l.F;if(k)for(g=[];k;k=k.F)g.push(k);if(l=l.M,k=h.type||h,typeof h=="string")h=new z(h,l);else if(h instanceof z)h.target=h.target||l;else{var B=h;h=new z(k,l),A(h,B)}if(B=!0,g)for(var q=g.length-1;0<=q;q--){var Z=h.g=g[q];B=sl(Z,k,!0,h)&&B}if(Z=h.g=l,B=sl(Z,k,!0,h)&&B,B=sl(Z,k,!1,h)&&B,g)for(q=0;q<g.length;q++)Z=h.g=g[q],B=sl(Z,k,!1,h)&&B}wt.prototype.N=function(){if(wt.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var g=l.g[h],k=0;k<g.length;k++)Ue(g[k]);delete l.g[h],l.h--}}this.F=null},wt.prototype.K=function(l,h,g,k){return this.i.add(String(l),h,!1,g,k)},wt.prototype.L=function(l,h,g,k){return this.i.add(String(l),h,!0,g,k)};function sl(l,h,g,k){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var B=!0,q=0;q<h.length;++q){var Z=h[q];if(Z&&!Z.da&&Z.capture==g){var Pe=Z.listener,dt=Z.ha||Z.src;Z.fa&&vs(l.i,Z),B=Pe.call(dt,k)!==!1&&B}}return B&&!k.defaultPrevented}function ip(l,h,g){if(typeof l=="function")g&&(l=x(l,g));else if(l&&typeof l.handleEvent=="function")l=x(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(l,h||0)}function ap(l){l.g=ip(()=>{l.g=null,l.i&&(l.i=!1,ap(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class $N extends V{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:ap(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ua(l){V.call(this),this.h=l,this.g={}}I(ua,V);var op=[];function lp(l){F(l.g,function(h,g){this.g.hasOwnProperty(g)&&Oe(h)},l),l.g={}}ua.prototype.N=function(){ua.aa.N.call(this),lp(this)},ua.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Uu=c.JSON.stringify,zN=c.JSON.parse,qN=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Bu(){}Bu.prototype.h=null;function cp(l){return l.h||(l.h=l.i())}function up(){}var da={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $u(){z.call(this,"d")}I($u,z);function zu(){z.call(this,"c")}I(zu,z);var dn={},dp=null;function nl(){return dp=dp||new wt}dn.La="serverreachability";function hp(l){z.call(this,dn.La,l)}I(hp,z);function ha(l){const h=nl();Dt(h,new hp(h))}dn.STAT_EVENT="statevent";function mp(l,h){z.call(this,dn.STAT_EVENT,l),this.stat=h}I(mp,z);function Ot(l){const h=nl();Dt(h,new mp(h,l))}dn.Ma="timingevent";function fp(l,h){z.call(this,dn.Ma,l),this.size=h}I(fp,z);function ma(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},h)}function fa(){this.g=!0}fa.prototype.xa=function(){this.g=!1};function WN(l,h,g,k,B,q){l.info(function(){if(l.g)if(q)for(var Z="",Pe=q.split("&"),dt=0;dt<Pe.length;dt++){var Ee=Pe[dt].split("=");if(1<Ee.length){var bt=Ee[0];Ee=Ee[1];var Nt=bt.split("_");Z=2<=Nt.length&&Nt[1]=="type"?Z+(bt+"="+Ee+"&"):Z+(bt+"=redacted&")}}else Z=null;else Z=q;return"XMLHTTP REQ ("+k+") [attempt "+B+"]: "+h+`
`+g+`
`+Z})}function HN(l,h,g,k,B,q,Z){l.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+B+"]: "+h+`
`+g+`
`+q+" "+Z})}function Gn(l,h,g,k){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+GN(l,g)+(k?" "+k:"")})}function KN(l,h){l.info(function(){return"TIMEOUT: "+h})}fa.prototype.info=function(){};function GN(l,h){if(!l.g)return h;if(!h)return null;try{var g=JSON.parse(h);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var k=g[l];if(!(2>k.length)){var B=k[1];if(Array.isArray(B)&&!(1>B.length)){var q=B[0];if(q!="noop"&&q!="stop"&&q!="close")for(var Z=1;Z<B.length;Z++)B[Z]=""}}}}return Uu(g)}catch{return h}}var il={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},pp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},qu;function al(){}I(al,Bu),al.prototype.g=function(){return new XMLHttpRequest},al.prototype.i=function(){return{}},qu=new al;function ws(l,h,g,k){this.j=l,this.i=h,this.l=g,this.R=k||1,this.U=new ua(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new gp}function gp(){this.i=null,this.g="",this.h=!1}var xp={},Wu={};function Hu(l,h,g){l.L=1,l.v=ul(Kr(h)),l.m=g,l.P=!0,yp(l,null)}function yp(l,h){l.F=Date.now(),ol(l),l.A=Kr(l.v);var g=l.A,k=l.R;Array.isArray(k)||(k=[String(k)]),Pp(g.i,"t",k),l.C=0,g=l.j.J,l.h=new gp,l.g=Yp(l.j,g?h:null,!l.m),0<l.O&&(l.M=new $N(x(l.Y,l,l.g),l.O)),h=l.U,g=l.g,k=l.ca;var B="readystatechange";Array.isArray(B)||(B&&(op[0]=B.toString()),B=op);for(var q=0;q<B.length;q++){var Z=$(g,B[q],k||h.handleEvent,!1,h.h||h);if(!Z)break;h.g[Z.key]=Z}h=l.H?w(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),ha(),WN(l.i,l.u,l.A,l.l,l.R,l.m)}ws.prototype.ca=function(l){l=l.target;const h=this.M;h&&Gr(l)==3?h.j():this.Y(l)},ws.prototype.Y=function(l){try{if(l==this.g)e:{const Nt=Gr(this.g);var h=this.g.Ba();const Jn=this.g.Z();if(!(3>Nt)&&(Nt!=3||this.g&&(this.h.h||this.g.oa()||Fp(this.g)))){this.J||Nt!=4||h==7||(h==8||0>=Jn?ha(3):ha(2)),Ku(this);var g=this.g.Z();this.X=g;t:if(vp(this)){var k=Fp(this.g);l="";var B=k.length,q=Gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){hn(this),pa(this);var Z="";break t}this.h.i=new c.TextDecoder}for(h=0;h<B;h++)this.h.h=!0,l+=this.h.i.decode(k[h],{stream:!(q&&h==B-1)});k.length=0,this.h.g+=l,this.C=0,Z=this.h.g}else Z=this.g.oa();if(this.o=g==200,HN(this.i,this.u,this.A,this.l,this.R,Nt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Pe,dt=this.g;if((Pe=dt.g?dt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Pe)){var Ee=Pe;break t}}Ee=null}if(g=Ee)Gn(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gu(this,g);else{this.o=!1,this.s=3,Ot(12),hn(this),pa(this);break e}}if(this.P){g=!0;let vr;for(;!this.J&&this.C<Z.length;)if(vr=QN(this,Z),vr==Wu){Nt==4&&(this.s=4,Ot(14),g=!1),Gn(this.i,this.l,null,"[Incomplete Response]");break}else if(vr==xp){this.s=4,Ot(15),Gn(this.i,this.l,Z,"[Invalid Chunk]"),g=!1;break}else Gn(this.i,this.l,vr,null),Gu(this,vr);if(vp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Nt!=4||Z.length!=0||this.h.h||(this.s=1,Ot(16),g=!1),this.o=this.o&&g,!g)Gn(this.i,this.l,Z,"[Invalid Chunked Response]"),hn(this),pa(this);else if(0<Z.length&&!this.W){this.W=!0;var bt=this.j;bt.g==this&&bt.ba&&!bt.M&&(bt.j.info("Great, no buffering proxy detected. Bytes received: "+Z.length),ed(bt),bt.M=!0,Ot(11))}}else Gn(this.i,this.l,Z,null),Gu(this,Z);Nt==4&&hn(this),this.o&&!this.J&&(Nt==4?Hp(this.j,this):(this.o=!1,ol(this)))}else hj(this.g),g==400&&0<Z.indexOf("Unknown SID")?(this.s=3,Ot(12)):(this.s=0,Ot(13)),hn(this),pa(this)}}}catch{}finally{}};function vp(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function QN(l,h){var g=l.C,k=h.indexOf(`
`,g);return k==-1?Wu:(g=Number(h.substring(g,k)),isNaN(g)?xp:(k+=1,k+g>h.length?Wu:(h=h.slice(k,k+g),l.C=k+g,h)))}ws.prototype.cancel=function(){this.J=!0,hn(this)};function ol(l){l.S=Date.now()+l.I,wp(l,l.I)}function wp(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=ma(x(l.ba,l),h)}function Ku(l){l.B&&(c.clearTimeout(l.B),l.B=null)}ws.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(KN(this.i,this.A),this.L!=2&&(ha(),Ot(17)),hn(this),this.s=2,pa(this)):wp(this,this.S-l)};function pa(l){l.j.G==0||l.J||Hp(l.j,l)}function hn(l){Ku(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,lp(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Gu(l,h){try{var g=l.j;if(g.G!=0&&(g.g==l||Qu(g.h,l))){if(!l.K&&Qu(g.h,l)&&g.G==3){try{var k=g.Da.g.parse(h)}catch{k=null}if(Array.isArray(k)&&k.length==3){var B=k;if(B[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)gl(g),fl(g);else break e;Zu(g),Ot(18)}}else g.za=B[1],0<g.za-g.T&&37500>B[2]&&g.F&&g.v==0&&!g.C&&(g.C=ma(x(g.Za,g),6e3));if(1>=jp(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else fn(g,11)}else if((l.K||g.g==l)&&gl(g),!y(h))for(B=g.Da.g.parse(h),h=0;h<B.length;h++){let Ee=B[h];if(g.T=Ee[0],Ee=Ee[1],g.G==2)if(Ee[0]=="c"){g.K=Ee[1],g.ia=Ee[2];const bt=Ee[3];bt!=null&&(g.la=bt,g.j.info("VER="+g.la));const Nt=Ee[4];Nt!=null&&(g.Aa=Nt,g.j.info("SVER="+g.Aa));const Jn=Ee[5];Jn!=null&&typeof Jn=="number"&&0<Jn&&(k=1.5*Jn,g.L=k,g.j.info("backChannelRequestTimeoutMs_="+k)),k=g;const vr=l.g;if(vr){const yl=vr.g?vr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yl){var q=k.h;q.g||yl.indexOf("spdy")==-1&&yl.indexOf("quic")==-1&&yl.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(Yu(q,q.h),q.h=null))}if(k.D){const td=vr.g?vr.g.getResponseHeader("X-HTTP-Session-Id"):null;td&&(k.ya=td,Le(k.I,k.D,td))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),k=g;var Z=l;if(k.qa=Qp(k,k.J?k.ia:null,k.W),Z.K){_p(k.h,Z);var Pe=Z,dt=k.L;dt&&(Pe.I=dt),Pe.B&&(Ku(Pe),ol(Pe)),k.g=Z}else qp(k);0<g.i.length&&pl(g)}else Ee[0]!="stop"&&Ee[0]!="close"||fn(g,7);else g.G==3&&(Ee[0]=="stop"||Ee[0]=="close"?Ee[0]=="stop"?fn(g,7):Xu(g):Ee[0]!="noop"&&g.l&&g.l.ta(Ee),g.v=0)}}ha(4)}catch{}}var YN=class{constructor(l,h){this.g=l,this.map=h}};function bp(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Np(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function jp(l){return l.h?1:l.g?l.g.size:0}function Qu(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Yu(l,h){l.g?l.g.add(h):l.h=h}function _p(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}bp.prototype.cancel=function(){if(this.i=Sp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Sp(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const g of l.g.values())h=h.concat(g.D);return h}return b(l.i)}function JN(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],g=l.length,k=0;k<g;k++)h.push(l[k]);return h}h=[],g=0;for(k in l)h[g++]=l[k];return h}function XN(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var g=0;g<l;g++)h.push(g);return h}h=[],g=0;for(const k in l)h[g++]=k;return h}}}function Ep(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var g=XN(l),k=JN(l),B=k.length,q=0;q<B;q++)h.call(void 0,k[q],g&&g[q],l)}var Cp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ZN(l,h){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var k=l[g].indexOf("="),B=null;if(0<=k){var q=l[g].substring(0,k);B=l[g].substring(k+1)}else q=l[g];h(q,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function mn(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof mn){this.h=l.h,ll(this,l.j),this.o=l.o,this.g=l.g,cl(this,l.s),this.l=l.l;var h=l.i,g=new ya;g.i=h.i,h.g&&(g.g=new Map(h.g),g.h=h.h),kp(this,g),this.m=l.m}else l&&(h=String(l).match(Cp))?(this.h=!1,ll(this,h[1]||"",!0),this.o=ga(h[2]||""),this.g=ga(h[3]||"",!0),cl(this,h[4]),this.l=ga(h[5]||"",!0),kp(this,h[6]||"",!0),this.m=ga(h[7]||"")):(this.h=!1,this.i=new ya(null,this.h))}mn.prototype.toString=function(){var l=[],h=this.j;h&&l.push(xa(h,Ip,!0),":");var g=this.g;return(g||h=="file")&&(l.push("//"),(h=this.o)&&l.push(xa(h,Ip,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(xa(g,g.charAt(0)=="/"?rj:tj,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",xa(g,nj)),l.join("")};function Kr(l){return new mn(l)}function ll(l,h,g){l.j=g?ga(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function cl(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function kp(l,h,g){h instanceof ya?(l.i=h,ij(l.i,l.h)):(g||(h=xa(h,sj)),l.i=new ya(h,l.h))}function Le(l,h,g){l.i.set(h,g)}function ul(l){return Le(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ga(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function xa(l,h,g){return typeof l=="string"?(l=encodeURI(l).replace(h,ej),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function ej(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Ip=/[#\/\?@]/g,tj=/[#\?:]/g,rj=/[#\?]/g,sj=/[#\?@]/g,nj=/#/g;function ya(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function bs(l){l.g||(l.g=new Map,l.h=0,l.i&&ZN(l.i,function(h,g){l.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=ya.prototype,t.add=function(l,h){bs(this),this.i=null,l=Qn(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(h),this.h+=1,this};function Tp(l,h){bs(l),h=Qn(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Ap(l,h){return bs(l),h=Qn(l,h),l.g.has(h)}t.forEach=function(l,h){bs(this),this.g.forEach(function(g,k){g.forEach(function(B){l.call(h,B,k,this)},this)},this)},t.na=function(){bs(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),g=[];for(let k=0;k<h.length;k++){const B=l[k];for(let q=0;q<B.length;q++)g.push(h[k])}return g},t.V=function(l){bs(this);let h=[];if(typeof l=="string")Ap(this,l)&&(h=h.concat(this.g.get(Qn(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)h=h.concat(l[g])}return h},t.set=function(l,h){return bs(this),this.i=null,l=Qn(this,l),Ap(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Pp(l,h,g){Tp(l,h),0<g.length&&(l.i=null,l.g.set(Qn(l,h),b(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var g=0;g<h.length;g++){var k=h[g];const q=encodeURIComponent(String(k)),Z=this.V(k);for(k=0;k<Z.length;k++){var B=q;Z[k]!==""&&(B+="="+encodeURIComponent(String(Z[k]))),l.push(B)}}return this.i=l.join("&")};function Qn(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function ij(l,h){h&&!l.j&&(bs(l),l.i=null,l.g.forEach(function(g,k){var B=k.toLowerCase();k!=B&&(Tp(this,k),Pp(this,B,g))},l)),l.j=h}function aj(l,h){const g=new fa;if(c.Image){const k=new Image;k.onload=j(Ns,g,"TestLoadImage: loaded",!0,h,k),k.onerror=j(Ns,g,"TestLoadImage: error",!1,h,k),k.onabort=j(Ns,g,"TestLoadImage: abort",!1,h,k),k.ontimeout=j(Ns,g,"TestLoadImage: timeout",!1,h,k),c.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=l}else h(!1)}function oj(l,h){const g=new fa,k=new AbortController,B=setTimeout(()=>{k.abort(),Ns(g,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:k.signal}).then(q=>{clearTimeout(B),q.ok?Ns(g,"TestPingServer: ok",!0,h):Ns(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(B),Ns(g,"TestPingServer: error",!1,h)})}function Ns(l,h,g,k,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),k(g)}catch{}}function lj(){this.g=new qN}function cj(l,h,g){const k=g||"";try{Ep(l,function(B,q){let Z=B;d(B)&&(Z=Uu(B)),h.push(k+q+"="+encodeURIComponent(Z))})}catch(B){throw h.push(k+"type="+encodeURIComponent("_badmap")),B}}function dl(l){this.l=l.Ub||null,this.j=l.eb||!1}I(dl,Bu),dl.prototype.g=function(){return new hl(this.l,this.j)},dl.prototype.i=function(l){return function(){return l}}({});function hl(l,h){wt.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}I(hl,wt),t=hl.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,wa(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,va(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,wa(this)),this.g&&(this.readyState=3,wa(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rp(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Rp(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?va(this):wa(this),this.readyState==3&&Rp(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,va(this))},t.Qa=function(l){this.g&&(this.response=l,va(this))},t.ga=function(){this.g&&va(this)};function va(l){l.readyState=4,l.l=null,l.j=null,l.v=null,wa(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=h.next();return l.join(`\r
`)};function wa(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(hl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Dp(l){let h="";return F(l,function(g,k){h+=k,h+=":",h+=g,h+=`\r
`}),h}function Ju(l,h,g){e:{for(k in g){var k=!1;break e}k=!0}k||(g=Dp(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Le(l,h,g))}function Ge(l){wt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}I(Ge,wt);var uj=/^https?$/i,dj=["POST","PUT"];t=Ge.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,g,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():qu.g(),this.v=this.o?cp(this.o):cp(qu),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(q){Op(this,q);return}if(l=g||"",g=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var B in k)g.set(B,k[B]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const q of k.keys())g.set(q,k.get(q));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(g.keys()).find(q=>q.toLowerCase()=="content-type"),B=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(dj,h,void 0))||k||B||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,Z]of g)this.g.setRequestHeader(q,Z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Vp(this),this.u=!0,this.g.send(l),this.u=!1}catch(q){Op(this,q)}};function Op(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Lp(l),ml(l)}function Lp(l){l.A||(l.A=!0,Dt(l,"complete"),Dt(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Dt(this,"complete"),Dt(this,"abort"),ml(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ml(this,!0)),Ge.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Mp(this):this.bb())},t.bb=function(){Mp(this)};function Mp(l){if(l.h&&typeof o<"u"&&(!l.v[1]||Gr(l)!=4||l.Z()!=2)){if(l.u&&Gr(l)==4)ip(l.Ea,0,l);else if(Dt(l,"readystatechange"),Gr(l)==4){l.h=!1;try{const Z=l.Z();e:switch(Z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var k;if(k=Z===0){var B=String(l.D).match(Cp)[1]||null;!B&&c.self&&c.self.location&&(B=c.self.location.protocol.slice(0,-1)),k=!uj.test(B?B.toLowerCase():"")}g=k}if(g)Dt(l,"complete"),Dt(l,"success");else{l.m=6;try{var q=2<Gr(l)?l.g.statusText:""}catch{q=""}l.l=q+" ["+l.Z()+"]",Lp(l)}}finally{ml(l)}}}}function ml(l,h){if(l.g){Vp(l);const g=l.g,k=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||Dt(l,"ready");try{g.onreadystatechange=k}catch{}}}function Vp(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function Gr(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<Gr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),zN(h)}};function Fp(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function hj(l){const h={};l=(l.g&&2<=Gr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<l.length;k++){if(y(l[k]))continue;var g=D(l[k]);const B=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const q=h[B]||[];h[B]=q,q.push(g)}N(h,function(k){return k.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ba(l,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||h}function Up(l){this.Aa=0,this.i=[],this.j=new fa,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ba("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ba("baseRetryDelayMs",5e3,l),this.cb=ba("retryDelaySeedMs",1e4,l),this.Wa=ba("forwardChannelMaxRetries",2,l),this.wa=ba("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new bp(l&&l.concurrentRequestLimit),this.Da=new lj,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Up.prototype,t.la=8,t.G=1,t.connect=function(l,h,g,k){Ot(0),this.W=l,this.H=h||{},g&&k!==void 0&&(this.H.OSID=g,this.H.OAID=k),this.F=this.X,this.I=Qp(this,null,this.W),pl(this)};function Xu(l){if(Bp(l),l.G==3){var h=l.U++,g=Kr(l.I);if(Le(g,"SID",l.K),Le(g,"RID",h),Le(g,"TYPE","terminate"),Na(l,g),h=new ws(l,l.j,h),h.L=2,h.v=ul(Kr(g)),g=!1,c.navigator&&c.navigator.sendBeacon)try{g=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!g&&c.Image&&(new Image().src=h.v,g=!0),g||(h.g=Yp(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ol(h)}Gp(l)}function fl(l){l.g&&(ed(l),l.g.cancel(),l.g=null)}function Bp(l){fl(l),l.u&&(c.clearTimeout(l.u),l.u=null),gl(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function pl(l){if(!Np(l.h)&&!l.s){l.s=!0;var h=l.Ga;ce||U(),O||(ce(),O=!0),L.add(h,l),l.B=0}}function mj(l,h){return jp(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=ma(x(l.Ga,l,h),Kp(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const B=new ws(this,this.j,l);let q=this.o;if(this.S&&(q?(q=w(q),A(q,this.S)):q=this.S),this.m!==null||this.O||(B.H=q,q=null),this.P)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var k=this.i[g];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(h+=k,4096<h){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=zp(this,B,h),g=Kr(this.I),Le(g,"RID",l),Le(g,"CVER",22),this.D&&Le(g,"X-HTTP-Session-Id",this.D),Na(this,g),q&&(this.O?h="headers="+encodeURIComponent(String(Dp(q)))+"&"+h:this.m&&Ju(g,this.m,q)),Yu(this.h,B),this.Ua&&Le(g,"TYPE","init"),this.P?(Le(g,"$req",h),Le(g,"SID","null"),B.T=!0,Hu(B,g,null)):Hu(B,g,h),this.G=2}}else this.G==3&&(l?$p(this,l):this.i.length==0||Np(this.h)||$p(this))};function $p(l,h){var g;h?g=h.l:g=l.U++;const k=Kr(l.I);Le(k,"SID",l.K),Le(k,"RID",g),Le(k,"AID",l.T),Na(l,k),l.m&&l.o&&Ju(k,l.m,l.o),g=new ws(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),h&&(l.i=h.D.concat(l.i)),h=zp(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Yu(l.h,g),Hu(g,k,h)}function Na(l,h){l.H&&F(l.H,function(g,k){Le(h,k,g)}),l.l&&Ep({},function(g,k){Le(h,k,g)})}function zp(l,h,g){g=Math.min(l.i.length,g);var k=l.l?x(l.l.Na,l.l,l):null;e:{var B=l.i;let q=-1;for(;;){const Z=["count="+g];q==-1?0<g?(q=B[0].g,Z.push("ofs="+q)):q=0:Z.push("ofs="+q);let Pe=!0;for(let dt=0;dt<g;dt++){let Ee=B[dt].g;const bt=B[dt].map;if(Ee-=q,0>Ee)q=Math.max(0,B[dt].g-100),Pe=!1;else try{cj(bt,Z,"req"+Ee+"_")}catch{k&&k(bt)}}if(Pe){k=Z.join("&");break e}}}return l=l.i.splice(0,g),h.D=l,k}function qp(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;ce||U(),O||(ce(),O=!0),L.add(h,l),l.v=0}}function Zu(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=ma(x(l.Fa,l),Kp(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Wp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=ma(x(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ot(10),fl(this),Wp(this))};function ed(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Wp(l){l.g=new ws(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=Kr(l.qa);Le(h,"RID","rpc"),Le(h,"SID",l.K),Le(h,"AID",l.T),Le(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&Le(h,"TO",l.ja),Le(h,"TYPE","xmlhttp"),Na(l,h),l.m&&l.o&&Ju(h,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=ul(Kr(h)),g.m=null,g.P=!0,yp(g,l)}t.Za=function(){this.C!=null&&(this.C=null,fl(this),Zu(this),Ot(19))};function gl(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Hp(l,h){var g=null;if(l.g==h){gl(l),ed(l),l.g=null;var k=2}else if(Qu(l.h,h))g=h.D,_p(l.h,h),k=1;else return;if(l.G!=0){if(h.o)if(k==1){g=h.m?h.m.length:0,h=Date.now()-h.F;var B=l.B;k=nl(),Dt(k,new fp(k,g)),pl(l)}else qp(l);else if(B=h.s,B==3||B==0&&0<h.X||!(k==1&&mj(l,h)||k==2&&Zu(l)))switch(g&&0<g.length&&(h=l.h,h.i=h.i.concat(g)),B){case 1:fn(l,5);break;case 4:fn(l,10);break;case 3:fn(l,6);break;default:fn(l,2)}}}function Kp(l,h){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*h}function fn(l,h){if(l.j.info("Error code "+h),h==2){var g=x(l.fb,l),k=l.Xa;const B=!k;k=new mn(k||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||ll(k,"https"),ul(k),B?aj(k.toString(),g):oj(k.toString(),g)}else Ot(2);l.G=0,l.l&&l.l.sa(h),Gp(l),Bp(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Ot(2)):(this.j.info("Failed to ping google.com"),Ot(1))};function Gp(l){if(l.G=0,l.ka=[],l.l){const h=Sp(l.h);(h.length!=0||l.i.length!=0)&&(R(l.ka,h),R(l.ka,l.i),l.h.i.length=0,b(l.i),l.i.length=0),l.l.ra()}}function Qp(l,h,g){var k=g instanceof mn?Kr(g):new mn(g);if(k.g!="")h&&(k.g=h+"."+k.g),cl(k,k.s);else{var B=c.location;k=B.protocol,h=h?h+"."+B.hostname:B.hostname,B=+B.port;var q=new mn(null);k&&ll(q,k),h&&(q.g=h),B&&cl(q,B),g&&(q.l=g),k=q}return g=l.D,h=l.ya,g&&h&&Le(k,g,h),Le(k,"VER",l.la),Na(l,k),k}function Yp(l,h,g){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new Ge(new dl({eb:g})):new Ge(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Jp(){}t=Jp.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function xl(){}xl.prototype.g=function(l,h){return new er(l,h)};function er(l,h){wt.call(this),this.g=new Up(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!y(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!y(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Yn(this)}I(er,wt),er.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},er.prototype.close=function(){Xu(this.g)},er.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=Uu(l),l=g);h.i.push(new YN(h.Ya++,l)),h.G==3&&pl(h)},er.prototype.N=function(){this.g.l=null,delete this.j,Xu(this.g),delete this.g,er.aa.N.call(this)};function Xp(l){$u.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const g in h){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}I(Xp,$u);function Zp(){zu.call(this),this.status=1}I(Zp,zu);function Yn(l){this.g=l}I(Yn,Jp),Yn.prototype.ua=function(){Dt(this.g,"a")},Yn.prototype.ta=function(l){Dt(this.g,new Xp(l))},Yn.prototype.sa=function(l){Dt(this.g,new Zp)},Yn.prototype.ra=function(){Dt(this.g,"b")},xl.prototype.createWebChannel=xl.prototype.g,er.prototype.send=er.prototype.o,er.prototype.open=er.prototype.m,er.prototype.close=er.prototype.close,ab=function(){return new xl},ib=function(){return nl()},nb=dn,Gh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},il.NO_ERROR=0,il.TIMEOUT=8,il.HTTP_ERROR=6,nc=il,pp.COMPLETE="complete",sb=pp,up.EventType=da,da.OPEN="a",da.CLOSE="b",da.ERROR="c",da.MESSAGE="d",wt.prototype.listen=wt.prototype.K,Va=up,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,rb=Ge}).apply(typeof Ml<"u"?Ml:typeof self<"u"?self:typeof window<"u"?window:{});const Kx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Et=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Et.UNAUTHENTICATED=new Et(null),Et.GOOGLE_CREDENTIALS=new Et("google-credentials-uid"),Et.FIRST_PARTY=new Et("first-party-uid"),Et.MOCK_USER=new Et("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ea="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new cf("@firebase/firestore");function Aa(){return Rn.logLevel}function ae(t,...e){if(Rn.logLevel<=Ne.DEBUG){const r=e.map(bf);Rn.debug(`Firestore (${ea}): ${t}`,...r)}}function ms(t,...e){if(Rn.logLevel<=Ne.ERROR){const r=e.map(bf);Rn.error(`Firestore (${ea}): ${t}`,...r)}}function Vi(t,...e){if(Rn.logLevel<=Ne.WARN){const r=e.map(bf);Rn.warn(`Firestore (${ea}): ${t}`,...r)}}function bf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(t="Unexpected state"){const e=`FIRESTORE (${ea}) INTERNAL ASSERTION FAILED: `+t;throw ms(e),new Error(e)}function Ae(t,e){t||me()}function pe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends ys{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Bk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Et.UNAUTHENTICATED))}shutdown(){}}class $k{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class zk{constructor(e){this.t=e,this.currentUser=Et.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ae(this.o===void 0);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let a=new as;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new as,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new as)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ae(typeof n.accessToken=="string"),new ob(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ae(e===null||typeof e=="string"),new Et(e)}}class qk{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Et.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Wk{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new qk(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Et.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Hk{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Kk{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Ae(this.o===void 0);const n=a=>{a.error!=null&&ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.R;return this.R=a.token,ae("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?i(a):ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ae(typeof r.token=="string"),this.R=r.token,new Hk(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=Gk(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%e.length))}return n}}function Ce(t,e){return t<e?-1:t>e?1:0}function Fi(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new te(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new te(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new te(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return it.fromMillis(Date.now())}static fromDate(e){return it.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new it(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ce(this.nanoseconds,e.nanoseconds):Ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fe(e)}static min(){return new fe(new it(0,0))}static max(){return new fe(new it(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,r,n){r===void 0?r=0:r>e.length&&me(),n===void 0?n=e.length-r:n>e.length-r&&me(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Eo.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Eo?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=e.get(i),o=r.get(i);if(a<o)return-1;if(a>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Ve extends Eo{construct(e,r,n){return new Ve(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new te(G.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Ve(r)}static emptyPath(){return new Ve([])}}const Qk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ft extends Eo{construct(e,r,n){return new ft(e,r,n)}static isValidIdentifier(e){return Qk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ft.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ft(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new te(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new te(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new te(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(n+=c,i++):(a(),i++)}if(a(),o)throw new te(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ft(r)}static emptyPath(){return new ft([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(Ve.fromString(e))}static fromName(e){return new le(Ve.fromString(e).popFirst(5))}static empty(){return new le(Ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Ve.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new Ve(e.slice()))}}function Yk(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=fe.fromTimestamp(n===1e9?new it(r+1,0):new it(r,n));return new Zs(i,le.empty(),e)}function Jk(t){return new Zs(t.readTime,t.key,-1)}class Zs{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Zs(fe.min(),le.empty(),-1)}static max(){return new Zs(fe.max(),le.empty(),-1)}}function Xk(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=le.comparator(t.documentKey,e.documentKey),r!==0?r:Ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wo(t){if(t.code!==G.FAILED_PRECONDITION||t.message!==Zk)throw t;ae("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&me(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Y((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Y?r:Y.resolve(r)}catch(r){return Y.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Y.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Y.reject(r)}static resolve(e){return new Y((r,n)=>{r(e)})}static reject(e){return new Y((r,n)=>{n(e)})}static waitFor(e){return new Y((r,n)=>{let i=0,a=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++a,o&&a===i&&r()},u=>n(u))}),o=!0,a===i&&r()})}static or(e){let r=Y.resolve(!1);for(const n of e)r=r.next(i=>i?Y.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new Y((n,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;r(e[d]).next(m=>{o[d]=m,++c,c===a&&n(o)},m=>i(m))}})}static doWhile(e,r){return new Y((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function tI(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Ho(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Nf.oe=-1;function vu(t){return t==null}function zc(t){return t===0&&1/t==-1/0}function rI(t){return typeof t=="number"&&Number.isInteger(t)&&!zc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gx(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function zn(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function cb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,r){this.comparator=e,this.root=r||mt.EMPTY}insert(e,r){return new Ke(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,mt.BLACK,null,null))}remove(e){return new Ke(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mt.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vl(this.root,e,this.comparator,!0)}}class Vl{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mt{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??mt.RED,this.left=i??mt.EMPTY,this.right=a??mt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new mt(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return mt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return mt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw me();const e=this.left.check();if(e!==this.right.check())throw me();return e+(this.isRed()?0:1)}}mt.EMPTY=null,mt.RED=!0,mt.BLACK=!1;mt.EMPTY=new class{constructor(){this.size=0}get key(){throw me()}get value(){throw me()}get color(){throw me()}get left(){throw me()}get right(){throw me()}copy(e,r,n,i,a){return this}insert(e,r,n){return new mt(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.comparator=e,this.data=new Ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Qx(this.data.getIterator())}getIteratorFrom(e){return new Qx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof xt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new xt(this.comparator);return r.data=e,r}}class Qx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.fields=e,e.sort(ft.comparator)}static empty(){return new sr([])}unionWith(e){let r=new xt(ft.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new sr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Fi(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new ub("Invalid base64 string: "+a):a}}(e);return new vt(r)}static fromUint8Array(e){const r=function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a}(e);return new vt(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const sI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function en(t){if(Ae(!!t),typeof t=="string"){let e=0;const r=sI.exec(t);if(Ae(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ye(t.seconds),nanos:Ye(t.nanos)}}function Ye(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Dn(t){return typeof t=="string"?vt.fromBase64String(t):vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function _f(t){const e=t.mapValue.fields.__previous_value__;return jf(e)?_f(e):e}function Co(t){const e=en(t.mapValue.fields.__local_write_time__.timestampValue);return new it(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e,r,n,i,a,o,c,u,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d}}class ko{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new ko("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ko&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl={mapValue:{}};function On(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?jf(t)?4:aI(t)?9007199254740991:iI(t)?10:11:me()}function zr(t,e){if(t===e)return!0;const r=On(t);if(r!==On(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Co(t).isEqual(Co(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=en(i.timestampValue),c=en(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return Dn(i.bytesValue).isEqual(Dn(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return Ye(i.geoPointValue.latitude)===Ye(a.geoPointValue.latitude)&&Ye(i.geoPointValue.longitude)===Ye(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return Ye(i.integerValue)===Ye(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=Ye(i.doubleValue),c=Ye(a.doubleValue);return o===c?zc(o)===zc(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Fi(t.arrayValue.values||[],e.arrayValue.values||[],zr);case 10:case 11:return function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(Gx(o)!==Gx(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!zr(o[u],c[u])))return!1;return!0}(t,e);default:return me()}}function Io(t,e){return(t.values||[]).find(r=>zr(r,e))!==void 0}function Ui(t,e){if(t===e)return 0;const r=On(t),n=On(e);if(r!==n)return Ce(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Ce(t.booleanValue,e.booleanValue);case 2:return function(a,o){const c=Ye(a.integerValue||a.doubleValue),u=Ye(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return Yx(t.timestampValue,e.timestampValue);case 4:return Yx(Co(t),Co(e));case 5:return Ce(t.stringValue,e.stringValue);case 6:return function(a,o){const c=Dn(a),u=Dn(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const m=Ce(c[d],u[d]);if(m!==0)return m}return Ce(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const c=Ce(Ye(a.latitude),Ye(o.latitude));return c!==0?c:Ce(Ye(a.longitude),Ye(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Jx(t.arrayValue,e.arrayValue);case 10:return function(a,o){var c,u,d,m;const p=a.fields||{},x=o.fields||{},j=(c=p.value)===null||c===void 0?void 0:c.arrayValue,I=(u=x.value)===null||u===void 0?void 0:u.arrayValue,b=Ce(((d=j==null?void 0:j.values)===null||d===void 0?void 0:d.length)||0,((m=I==null?void 0:I.values)===null||m===void 0?void 0:m.length)||0);return b!==0?b:Jx(j,I)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===Fl.mapValue&&o===Fl.mapValue)return 0;if(a===Fl.mapValue)return 1;if(o===Fl.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},m=Object.keys(d);u.sort(),m.sort();for(let p=0;p<u.length&&p<m.length;++p){const x=Ce(u[p],m[p]);if(x!==0)return x;const j=Ui(c[u[p]],d[m[p]]);if(j!==0)return j}return Ce(u.length,m.length)}(t.mapValue,e.mapValue);default:throw me()}}function Yx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ce(t,e);const r=en(t),n=en(e),i=Ce(r.seconds,n.seconds);return i!==0?i:Ce(r.nanos,n.nanos)}function Jx(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=Ui(r[i],n[i]);if(a)return a}return Ce(r.length,n.length)}function Bi(t){return Qh(t)}function Qh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=en(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Dn(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return le.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=Qh(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const o of n)a?a=!1:i+=",",i+=`${o}:${Qh(r.fields[o])}`;return i+"}"}(t.mapValue):me()}function Xx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Yh(t){return!!t&&"integerValue"in t}function Sf(t){return!!t&&"arrayValue"in t}function Zx(t){return!!t&&"nullValue"in t}function e0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ic(t){return!!t&&"mapValue"in t}function iI(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Za(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return zn(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Za(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Za(t.arrayValue.values[r]);return e}return Object.assign({},t)}function aI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.value=e}static empty(){return new Ht({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ic(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Za(r)}setAll(e){let r=ft.emptyPath(),n={},i=[];e.forEach((o,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=c.popLast()}o?n[c.lastSegment()]=Za(o):i.push(c.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());ic(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return zr(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];ic(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){zn(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new Ht(Za(this.value))}}function db(t){const e=[];return zn(t.fields,(r,n)=>{const i=new ft([r]);if(ic(n)){const a=db(n.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)}),new sr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,r,n,i,a,o,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new kt(e,0,fe.min(),fe.min(),fe.min(),Ht.empty(),0)}static newFoundDocument(e,r,n,i){return new kt(e,1,r,fe.min(),n,i,0)}static newNoDocument(e,r){return new kt(e,2,r,fe.min(),fe.min(),Ht.empty(),0)}static newUnknownDocument(e,r){return new kt(e,3,r,fe.min(),fe.min(),Ht.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ht.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ht.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof kt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new kt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,r){this.position=e,this.inclusive=r}}function t0(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?n=le.comparator(le.fromName(o.referenceValue),r.key):n=Ui(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function r0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!zr(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,r="asc"){this.field=e,this.dir=r}}function oI(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{}class et extends hb{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new cI(e,r,n):r==="array-contains"?new hI(e,n):r==="in"?new mI(e,n):r==="not-in"?new fI(e,n):r==="array-contains-any"?new pI(e,n):new et(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new uI(e,n):new dI(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Ui(r,this.value)):r!==null&&On(this.value)===On(r)&&this.matchesComparison(Ui(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tr extends hb{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Tr(e,r)}matches(e){return mb(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function mb(t){return t.op==="and"}function fb(t){return lI(t)&&mb(t)}function lI(t){for(const e of t.filters)if(e instanceof Tr)return!1;return!0}function Jh(t){if(t instanceof et)return t.field.canonicalString()+t.op.toString()+Bi(t.value);if(fb(t))return t.filters.map(e=>Jh(e)).join(",");{const e=t.filters.map(r=>Jh(r)).join(",");return`${t.op}(${e})`}}function pb(t,e){return t instanceof et?function(n,i){return i instanceof et&&n.op===i.op&&n.field.isEqual(i.field)&&zr(n.value,i.value)}(t,e):t instanceof Tr?function(n,i){return i instanceof Tr&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,o,c)=>a&&pb(o,i.filters[c]),!0):!1}(t,e):void me()}function gb(t){return t instanceof et?function(r){return`${r.field.canonicalString()} ${r.op} ${Bi(r.value)}`}(t):t instanceof Tr?function(r){return r.op.toString()+" {"+r.getFilters().map(gb).join(" ,")+"}"}(t):"Filter"}class cI extends et{constructor(e,r,n){super(e,r,n),this.key=le.fromName(n.referenceValue)}matches(e){const r=le.comparator(e.key,this.key);return this.matchesComparison(r)}}class uI extends et{constructor(e,r){super(e,"in",r),this.keys=xb("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class dI extends et{constructor(e,r){super(e,"not-in",r),this.keys=xb("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function xb(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>le.fromName(n.referenceValue))}class hI extends et{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Sf(r)&&Io(r.arrayValue,this.value)}}class mI extends et{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Io(this.value.arrayValue,r)}}class fI extends et{constructor(e,r){super(e,"not-in",r)}matches(e){if(Io(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Io(this.value.arrayValue,r)}}class pI extends et{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Sf(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Io(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e,r=null,n=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.ue=null}}function s0(t,e=null,r=[],n=[],i=null,a=null,o=null){return new gI(t,e,r,n,i,a,o)}function Ef(t){const e=pe(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Jh(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),vu(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Bi(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Bi(n)).join(",")),e.ue=r}return e.ue}function Cf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!oI(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!pb(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!r0(t.startAt,e.startAt)&&r0(t.endAt,e.endAt)}function Xh(t){return le.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e,r=null,n=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function xI(t,e,r,n,i,a,o,c){return new ta(t,e,r,n,i,a,o,c)}function kf(t){return new ta(t)}function n0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yb(t){return t.collectionGroup!==null}function eo(t){const e=pe(t);if(e.ce===null){e.ce=[];const r=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new xt(ft.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.ce.push(new To(a,n))}),r.has(ft.keyField().canonicalString())||e.ce.push(new To(ft.keyField(),n))}return e.ce}function Br(t){const e=pe(t);return e.le||(e.le=yI(e,eo(t))),e.le}function yI(t,e){if(t.limitType==="F")return s0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new To(i.field,a)});const r=t.endAt?new qc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new qc(t.startAt.position,t.startAt.inclusive):null;return s0(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Zh(t,e){const r=t.filters.concat([e]);return new ta(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function em(t,e,r){return new ta(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function wu(t,e){return Cf(Br(t),Br(e))&&t.limitType===e.limitType}function vb(t){return`${Ef(Br(t))}|lt:${t.limitType}`}function ei(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>gb(i)).join(", ")}]`),vu(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Bi(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Bi(i)).join(",")),`Target(${n})`}(Br(t))}; limitType=${t.limitType})`}function bu(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):le.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of eo(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(o,c,u){const d=t0(o,c,u);return o.inclusive?d<=0:d<0}(n.startAt,eo(n),i)||n.endAt&&!function(o,c,u){const d=t0(o,c,u);return o.inclusive?d>=0:d>0}(n.endAt,eo(n),i))}(t,e)}function vI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wb(t){return(e,r)=>{let n=!1;for(const i of eo(t)){const a=wI(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function wI(t,e,r){const n=t.field.isKeyField()?le.comparator(e.key,r.key):function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?Ui(u,d):me()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return me()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){zn(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return cb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI=new Ke(le.comparator);function fs(){return bI}const bb=new Ke(le.comparator);function Fa(...t){let e=bb;for(const r of t)e=e.insert(r.key,r);return e}function Nb(t){let e=bb;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function bn(){return to()}function jb(){return to()}function to(){return new ra(t=>t.toString(),(t,e)=>t.isEqual(e))}const NI=new Ke(le.comparator),jI=new xt(le.comparator);function be(...t){let e=jI;for(const r of t)e=e.add(r);return e}const _I=new xt(Ce);function SI(){return _I}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function If(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zc(e)?"-0":e}}function _b(t){return{integerValue:""+t}}function EI(t,e){return rI(e)?_b(e):If(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(){this._=void 0}}function CI(t,e,r){return t instanceof Ao?function(i,a){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&jf(a)&&(a=_f(a)),a&&(o.fields.__previous_value__=a),{mapValue:o}}(r,e):t instanceof Po?Eb(t,e):t instanceof Ro?Cb(t,e):function(i,a){const o=Sb(i,a),c=i0(o)+i0(i.Pe);return Yh(o)&&Yh(i.Pe)?_b(c):If(i.serializer,c)}(t,e)}function kI(t,e,r){return t instanceof Po?Eb(t,e):t instanceof Ro?Cb(t,e):r}function Sb(t,e){return t instanceof Wc?function(n){return Yh(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Ao extends Nu{}class Po extends Nu{constructor(e){super(),this.elements=e}}function Eb(t,e){const r=kb(e);for(const n of t.elements)r.some(i=>zr(i,n))||r.push(n);return{arrayValue:{values:r}}}class Ro extends Nu{constructor(e){super(),this.elements=e}}function Cb(t,e){let r=kb(e);for(const n of t.elements)r=r.filter(i=>!zr(i,n));return{arrayValue:{values:r}}}class Wc extends Nu{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function i0(t){return Ye(t.integerValue||t.doubleValue)}function kb(t){return Sf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e,r){this.field=e,this.transform=r}}function TI(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Po&&i instanceof Po||n instanceof Ro&&i instanceof Ro?Fi(n.elements,i.elements,zr):n instanceof Wc&&i instanceof Wc?zr(n.Pe,i.Pe):n instanceof Ao&&i instanceof Ao}(t.transform,e.transform)}class AI{constructor(e,r){this.version=e,this.transformResults=r}}class Vt{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Vt}static exists(e){return new Vt(void 0,e)}static updateTime(e){return new Vt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ac(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ju{}function Ib(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _u(t.key,Vt.none()):new Ko(t.key,t.data,Vt.none());{const r=t.data,n=Ht.empty();let i=new xt(ft.comparator);for(let a of e.fields)if(!i.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),i=i.add(a)}return new cn(t.key,n,new sr(i.toArray()),Vt.none())}}function PI(t,e,r){t instanceof Ko?function(i,a,o){const c=i.value.clone(),u=o0(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):t instanceof cn?function(i,a,o){if(!ac(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=o0(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(Tb(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,r):function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function ro(t,e,r,n){return t instanceof Ko?function(a,o,c,u){if(!ac(a.precondition,o))return c;const d=a.value.clone(),m=l0(a.fieldTransforms,u,o);return d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof cn?function(a,o,c,u){if(!ac(a.precondition,o))return c;const d=l0(a.fieldTransforms,u,o),m=o.data;return m.setAll(Tb(a)),m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(a,o,c){return ac(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,r)}function RI(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=Sb(n.transform,i||null);a!=null&&(r===null&&(r=Ht.empty()),r.set(n.field,a))}return r||null}function a0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Fi(n,i,(a,o)=>TI(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ko extends ju{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class cn extends ju{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Tb(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function o0(t,e,r){const n=new Map;Ae(t.length===r.length);for(let i=0;i<r.length;i++){const a=t[i],o=a.transform,c=e.data.field(a.field);n.set(a.field,kI(o,c,r[i]))}return n}function l0(t,e,r){const n=new Map;for(const i of t){const a=i.transform,o=r.data.field(i.field);n.set(i.field,CI(a,o,e))}return n}class _u extends ju{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class DI extends ju{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&PI(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=ro(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=ro(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=jb();return this.mutations.forEach(i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=r.has(i.key)?null:c;const u=Ib(o,c);u!==null&&n.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(fe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),be())}isEqual(e){return this.batchId===e.batchId&&Fi(this.mutations,e.mutations,(r,n)=>a0(r,n))&&Fi(this.baseMutations,e.baseMutations,(r,n)=>a0(r,n))}}class Tf{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Ae(e.mutations.length===n.length);let i=function(){return NI}();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,n[o].version);return new Tf(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe,je;function VI(t){switch(t){default:return me();case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0}}function Ab(t){if(t===void 0)return ms("GRPC error has no .code"),G.UNKNOWN;switch(t){case Xe.OK:return G.OK;case Xe.CANCELLED:return G.CANCELLED;case Xe.UNKNOWN:return G.UNKNOWN;case Xe.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case Xe.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case Xe.INTERNAL:return G.INTERNAL;case Xe.UNAVAILABLE:return G.UNAVAILABLE;case Xe.UNAUTHENTICATED:return G.UNAUTHENTICATED;case Xe.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case Xe.NOT_FOUND:return G.NOT_FOUND;case Xe.ALREADY_EXISTS:return G.ALREADY_EXISTS;case Xe.PERMISSION_DENIED:return G.PERMISSION_DENIED;case Xe.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case Xe.ABORTED:return G.ABORTED;case Xe.OUT_OF_RANGE:return G.OUT_OF_RANGE;case Xe.UNIMPLEMENTED:return G.UNIMPLEMENTED;case Xe.DATA_LOSS:return G.DATA_LOSS;default:return me()}}(je=Xe||(Xe={}))[je.OK=0]="OK",je[je.CANCELLED=1]="CANCELLED",je[je.UNKNOWN=2]="UNKNOWN",je[je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",je[je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",je[je.NOT_FOUND=5]="NOT_FOUND",je[je.ALREADY_EXISTS=6]="ALREADY_EXISTS",je[je.PERMISSION_DENIED=7]="PERMISSION_DENIED",je[je.UNAUTHENTICATED=16]="UNAUTHENTICATED",je[je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",je[je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",je[je.ABORTED=10]="ABORTED",je[je.OUT_OF_RANGE=11]="OUT_OF_RANGE",je[je.UNIMPLEMENTED=12]="UNIMPLEMENTED",je[je.INTERNAL=13]="INTERNAL",je[je.UNAVAILABLE=14]="UNAVAILABLE",je[je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=new _n([4294967295,4294967295],0);function c0(t){const e=FI().encode(t),r=new tb;return r.update(e),new Uint8Array(r.digest())}function u0(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new _n([r,n],0),new _n([i,a],0)]}class Af{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ua(`Invalid padding: ${r}`);if(n<0)throw new Ua(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ua(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Ua(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=_n.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(_n.fromNumber(n)));return i.compare(UI)===1&&(i=new _n([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=c0(e),[n,i]=u0(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,i,a);if(!this.de(o))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new Af(a,i,r);return n.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;const r=c0(e),[n,i]=u0(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,i,a);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Ua extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Go.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Su(fe.min(),i,new Ke(Ce),fs(),be())}}class Go{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Go(n,r,be(),be(),be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class Pb{constructor(e,r){this.targetId=e,this.me=r}}class Rb{constructor(e,r,n=vt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class d0{constructor(){this.fe=0,this.ge=m0(),this.pe=vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=be(),r=be(),n=be();return this.ge.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:me()}}),new Go(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=m0()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ae(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class BI{constructor(e){this.Le=e,this.Be=new Map,this.ke=fs(),this.qe=h0(),this.Qe=new Ke(Ce)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:me()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const a=i.target;if(Xh(a))if(n===0){const o=new le(a.path);this.Ue(r,o,kt.newNoDocument(o,fe.min()))}else Ae(n===1);else{const o=this.Ye(r);if(o!==n){const c=this.Ze(e),u=c?this.Xe(c,e,o):1;if(u!==0){this.je(r);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,d)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let o,c;try{o=Dn(n).toUint8Array()}catch(u){if(u instanceof ub)return Vi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Af(o,i,a)}catch(u){return Vi(u instanceof Ua?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.Ue(r,a,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((a,o)=>{const c=this.Je(o);if(c){if(a.current&&Xh(c.target)){const u=new le(c.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,kt.newNoDocument(u,e))}a.be&&(r.set(o,a.ve()),a.Ce())}});let n=be();this.qe.forEach((a,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(a))}),this.ke.forEach((a,o)=>o.setReadTime(e));const i=new Su(e,r,this.Qe,this.ke,n);return this.ke=fs(),this.qe=h0(),this.Qe=new Ke(Ce),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new d0,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new xt(Ce),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||ae("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new d0),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function h0(){return new Ke(le.comparator)}function m0(){return new Ke(le.comparator)}const $I={asc:"ASCENDING",desc:"DESCENDING"},zI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qI={and:"AND",or:"OR"};class WI{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function tm(t,e){return t.useProto3Json||vu(e)?e:{value:e}}function Hc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Db(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function HI(t,e){return Hc(t,e.toTimestamp())}function $r(t){return Ae(!!t),fe.fromTimestamp(function(r){const n=en(r);return new it(n.seconds,n.nanos)}(t))}function Pf(t,e){return rm(t,e).canonicalString()}function rm(t,e){const r=function(i){return new Ve(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Ob(t){const e=Ve.fromString(t);return Ae(Ub(e)),e}function sm(t,e){return Pf(t.databaseId,e.path)}function Ld(t,e){const r=Ob(e);if(r.get(1)!==t.databaseId.projectId)throw new te(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new te(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new le(Mb(r))}function Lb(t,e){return Pf(t.databaseId,e)}function KI(t){const e=Ob(t);return e.length===4?Ve.emptyPath():Mb(e)}function nm(t){return new Ve(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Mb(t){return Ae(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function f0(t,e,r){return{name:sm(t,e),fields:r.value.mapValue.fields}}function GI(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:me()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(d,m){return d.useProto3Json?(Ae(m===void 0||typeof m=="string"),vt.fromBase64String(m||"")):(Ae(m===void 0||m instanceof Buffer||m instanceof Uint8Array),vt.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const m=d.code===void 0?G.UNKNOWN:Ab(d.code);return new te(m,d.message||"")}(o);r=new Rb(n,i,a,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Ld(t,n.document.name),a=$r(n.document.updateTime),o=n.document.createTime?$r(n.document.createTime):fe.min(),c=new Ht({mapValue:{fields:n.document.fields}}),u=kt.newFoundDocument(i,a,o,c),d=n.targetIds||[],m=n.removedTargetIds||[];r=new oc(d,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Ld(t,n.document),a=n.readTime?$r(n.readTime):fe.min(),o=kt.newNoDocument(i,a),c=n.removedTargetIds||[];r=new oc([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Ld(t,n.document),a=n.removedTargetIds||[];r=new oc([],a,i,null)}else{if(!("filter"in e))return me();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,o=new MI(i,a),c=n.targetId;r=new Pb(c,o)}}return r}function QI(t,e){let r;if(e instanceof Ko)r={update:f0(t,e.key,e.value)};else if(e instanceof _u)r={delete:sm(t,e.key)};else if(e instanceof cn)r={update:f0(t,e.key,e.data),updateMask:nT(e.fieldMask)};else{if(!(e instanceof DI))return me();r={verify:sm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,o){const c=o.transform;if(c instanceof Ao)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Po)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ro)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Wc)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw me()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:HI(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:me()}(t,e.precondition)),r}function YI(t,e){return t&&t.length>0?(Ae(e!==void 0),t.map(r=>function(i,a){let o=i.updateTime?$r(i.updateTime):$r(a);return o.isEqual(fe.min())&&(o=$r(a)),new AI(o,i.transformResults||[])}(r,e))):[]}function JI(t,e){return{documents:[Lb(t,e.path)]}}function XI(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Lb(t,i);const a=function(d){if(d.length!==0)return Fb(Tr.create(d,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const o=function(d){if(d.length!==0)return d.map(m=>function(x){return{field:ti(x.field),direction:tT(x.dir)}}(m))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const c=tm(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:r,parent:i}}function ZI(t){let e=KI(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Ae(n===1);const m=r.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let a=[];r.where&&(a=function(p){const x=Vb(p);return x instanceof Tr&&fb(x)?x.getFilters():[x]}(r.where));let o=[];r.orderBy&&(o=function(p){return p.map(x=>function(I){return new To(ri(I.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction))}(x))}(r.orderBy));let c=null;r.limit&&(c=function(p){let x;return x=typeof p=="object"?p.value:p,vu(x)?null:x}(r.limit));let u=null;r.startAt&&(u=function(p){const x=!!p.before,j=p.values||[];return new qc(j,x)}(r.startAt));let d=null;return r.endAt&&(d=function(p){const x=!p.before,j=p.values||[];return new qc(j,x)}(r.endAt)),xI(e,i,o,a,c,"F",u,d)}function eT(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Vb(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ri(r.unaryFilter.field);return et.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ri(r.unaryFilter.field);return et.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ri(r.unaryFilter.field);return et.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ri(r.unaryFilter.field);return et.create(o,"!=",{nullValue:"NULL_VALUE"});default:return me()}}(t):t.fieldFilter!==void 0?function(r){return et.create(ri(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return me()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Tr.create(r.compositeFilter.filters.map(n=>Vb(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return me()}}(r.compositeFilter.op))}(t):me()}function tT(t){return $I[t]}function rT(t){return zI[t]}function sT(t){return qI[t]}function ti(t){return{fieldPath:t.canonicalString()}}function ri(t){return ft.fromServerFormat(t.fieldPath)}function Fb(t){return t instanceof et?function(r){if(r.op==="=="){if(e0(r.value))return{unaryFilter:{field:ti(r.field),op:"IS_NAN"}};if(Zx(r.value))return{unaryFilter:{field:ti(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(e0(r.value))return{unaryFilter:{field:ti(r.field),op:"IS_NOT_NAN"}};if(Zx(r.value))return{unaryFilter:{field:ti(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ti(r.field),op:rT(r.op),value:r.value}}}(t):t instanceof Tr?function(r){const n=r.getFilters().map(i=>Fb(i));return n.length===1?n[0]:{compositeFilter:{op:sT(r.op),filters:n}}}(t):me()}function nT(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Ub(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,r,n,i,a=fe.min(),o=fe.min(),c=vt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ls(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ls(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ls(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ls(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e){this.ct=e}}function aT(t){const e=ZI({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?em(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(){this.un=new lT}addToCollectionParentIndex(e,r){return this.un.add(r),Y.resolve()}getCollectionParents(e,r){return Y.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Y.resolve()}deleteFieldIndex(e,r){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,r){return Y.resolve()}getDocumentsMatchingTarget(e,r){return Y.resolve(null)}getIndexType(e,r){return Y.resolve(0)}getFieldIndexes(e,r){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,r){return Y.resolve(Zs.min())}getMinOffsetFromCollectionGroup(e,r){return Y.resolve(Zs.min())}updateCollectionGroup(e,r,n){return Y.resolve()}updateIndexEntries(e,r){return Y.resolve()}}class lT{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new xt(Ve.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new xt(Ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new $i(0)}static kn(){return new $i(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(){this.changes=new ra(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,kt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Y.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&ro(n.mutation,i,sr.empty(),it.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,be()).next(()=>n))}getLocalViewOfDocuments(e,r,n=be()){const i=bn();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let o=Fa();return a.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=bn();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,be()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((o,c)=>{r.set(o,c)})})}computeViews(e,r,n,i){let a=fs();const o=to(),c=function(){return to()}();return r.forEach((u,d)=>{const m=n.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof cn)?a=a.insert(d.key,d):m!==void 0?(o.set(d.key,m.mutation.getFieldMask()),ro(m.mutation,d,m.mutation.getFieldMask(),it.now())):o.set(d.key,sr.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((d,m)=>o.set(d,m)),r.forEach((d,m)=>{var p;return c.set(d,new uT(m,(p=o.get(d))!==null&&p!==void 0?p:null))}),c))}recalculateAndSaveOverlays(e,r){const n=to();let i=new Ke((o,c)=>o-c),a=be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=r.get(u);if(d===null)return;let m=n.get(u)||sr.empty();m=c.applyToLocalView(d,m),n.set(u,m);const p=(i.get(c.batchId)||be()).add(u);i=i.insert(c.batchId,p)})}).next(()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,m=u.value,p=jb();m.forEach(x=>{if(!a.has(x)){const j=Ib(r.get(x),n.get(x));j!==null&&p.set(x,j),a=a.add(x)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return Y.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(o){return le.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):yb(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):Y.resolve(bn());let c=-1,u=a;return o.next(d=>Y.forEach(d,(m,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(m)?Y.resolve():this.remoteDocumentCache.getEntry(e,m).next(x=>{u=u.insert(m,x)}))).next(()=>this.populateOverlays(e,d,a)).next(()=>this.computeViews(e,u,d,be())).next(m=>({batchId:c,changes:Nb(m)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new le(r)).next(n=>{let i=Fa();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let o=Fa();return this.indexManager.getCollectionParents(e,a).next(c=>Y.forEach(c,u=>{const d=function(p,x){return new ta(x,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next(m=>{m.forEach((p,x)=>{o=o.insert(p,x)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(o=>{a.forEach((u,d)=>{const m=d.getKey();o.get(m)===null&&(o=o.insert(m,kt.newInvalidDocument(m)))});let c=Fa();return o.forEach((u,d)=>{const m=a.get(u);m!==void 0&&ro(m.mutation,d,sr.empty(),it.now()),bu(r,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Y.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:$r(i.createTime)}}(r)),Y.resolve()}getNamedQuery(e,r){return Y.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:aT(i.bundledQuery),readTime:$r(i.readTime)}}(r)),Y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(){this.overlays=new Ke(le.comparator),this.Ir=new Map}getOverlay(e,r){return Y.resolve(this.overlays.get(r))}getOverlays(e,r){const n=bn();return Y.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.ht(e,r,a)}),Y.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),Y.resolve()}getOverlaysForCollection(e,r,n){const i=bn(),a=r.length+1,o=new le(r.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>n&&i.set(u.getKey(),u)}return Y.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new Ke((d,m)=>d-m);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let m=a.get(d.largestBatchId);m===null&&(m=bn(),a=a.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const c=bn(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,m)=>c.set(d,m)),!(c.size()>=i)););return Y.resolve(c)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new LI(r,n));let a=this.Ir.get(r);a===void 0&&(a=be(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(){this.sessionToken=vt.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Y.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(){this.Tr=new xt(ot.Er),this.dr=new xt(ot.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new ot(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new ot(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new le(new Ve([])),n=new ot(r,e),i=new ot(r,e+1),a=[];return this.dr.forEachInRange([n,i],o=>{this.Vr(o),a.push(o.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new le(new Ve([])),n=new ot(r,e),i=new ot(r,e+1);let a=be();return this.dr.forEachInRange([n,i],o=>{a=a.add(o.key)}),a}containsKey(e){const r=new ot(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ot{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return le.comparator(e.key,r.key)||Ce(e.wr,r.wr)}static Ar(e,r){return Ce(e.wr,r.wr)||le.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new xt(ot.Er)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new OI(a,r,n,i);this.mutationQueue.push(o);for(const c of i)this.br=this.br.add(new ot(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Y.resolve(o)}lookupMutationBatch(e,r){return Y.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),a=i<0?0:i;return Y.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ot(r,0),i=new ot(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,i],o=>{const c=this.Dr(o.wr);a.push(c)}),Y.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new xt(Ce);return r.forEach(i=>{const a=new ot(i,0),o=new ot(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,o],c=>{n=n.add(c.wr)})}),Y.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;le.isDocumentKey(a)||(a=a.child(""));const o=new ot(new le(a),0);let c=new xt(Ce);return this.br.forEachWhile(u=>{const d=u.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.wr)),!0)},o),Y.resolve(this.Cr(c))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Ae(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Y.forEach(r.mutations,i=>{const a=new ot(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new ot(r,0),i=this.br.firstAfterOrEqual(n);return Y.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e){this.Mr=e,this.docs=function(){return new Ke(le.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Y.resolve(n?n.document.mutableCopy():kt.newInvalidDocument(r))}getEntries(e,r){let n=fs();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():kt.newInvalidDocument(i))}),Y.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=fs();const o=r.path,c=new le(o.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:m}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Xk(Jk(m),n)<=0||(i.has(m.key)||bu(r,m))&&(a=a.insert(m.key,m.mutableCopy()))}return Y.resolve(a)}getAllFromCollectionGroup(e,r,n,i){me()}Or(e,r){return Y.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new xT(this)}getSize(e){return Y.resolve(this.size)}}class xT extends cT{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Y.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e){this.persistence=e,this.Nr=new ra(r=>Ef(r),Cf),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Rf,this.targetCount=0,this.kr=$i.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Y.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new $i(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Y.resolve()}updateTargetData(e,r){return this.Kn(r),Y.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.Nr.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),Y.waitFor(a).next(()=>i)}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Y.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Y.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(o=>{a.push(i.markPotentiallyOrphaned(e,o))}),Y.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Y.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Y.resolve(n)}containsKey(e,r){return Y.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Nf(0),this.Kr=!1,this.Kr=!0,this.$r=new fT,this.referenceDelegate=e(this),this.Ur=new yT(this),this.indexManager=new oT,this.remoteDocumentCache=function(i){return new gT(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new iT(r),this.Gr=new hT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new mT,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new pT(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){ae("MemoryPersistence","Starting transaction:",e);const i=new wT(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(a=>this.referenceDelegate.jr(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Hr(e,r){return Y.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class wT extends eI{constructor(e){super(),this.currentSequenceNumber=e}}class Df{constructor(e){this.persistence=e,this.Jr=new Rf,this.Yr=null}static Zr(e){return new Df(e)}get Xr(){if(this.Yr)return this.Yr;throw me()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Y.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Y.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Y.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.Xr,n=>{const i=le.fromPath(n);return this.ei(e,i).next(a=>{a||r.removeEntry(i,fe.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Y.or([()=>Y.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=be(),i=be();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Of(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return cE()?8:tI(Pt())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.Yi(e,r).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.Zi(e,r,i,n).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new bT;return this.Xi(e,r,o).next(c=>{if(a.result=c,this.zi)return this.es(e,r,o,c.size)})}).next(()=>a.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Aa()<=Ne.DEBUG&&ae("QueryEngine","SDK will not create cache indexes for query:",ei(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Y.resolve()):(Aa()<=Ne.DEBUG&&ae("QueryEngine","Query:",ei(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Aa()<=Ne.DEBUG&&ae("QueryEngine","The SDK decides to create cache indexes for query:",ei(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Br(r))):Y.resolve())}Yi(e,r){if(n0(r))return Y.resolve(null);let n=Br(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=em(r,null,"F"),n=Br(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const o=be(...a);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const d=this.ts(r,c);return this.ns(r,d,o,u.readTime)?this.Yi(e,em(r,null,"F")):this.rs(e,d,r,u)}))})))}Zi(e,r,n,i){return n0(r)||i.isEqual(fe.min())?Y.resolve(null):this.Ji.getDocuments(e,n).next(a=>{const o=this.ts(r,a);return this.ns(r,o,n,i)?Y.resolve(null):(Aa()<=Ne.DEBUG&&ae("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ei(r)),this.rs(e,o,r,Yk(i,-1)).next(c=>c))})}ts(e,r){let n=new xt(wb(e));return r.forEach((i,a)=>{bu(e,a)&&(n=n.add(a))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Xi(e,r,n){return Aa()<=Ne.DEBUG&&ae("QueryEngine","Using full collection scan to execute query:",ei(r)),this.Ji.getDocumentsMatchingQuery(e,r,Zs.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Ke(Ce),this._s=new ra(a=>Ef(a),Cf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dT(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function _T(t,e,r,n){return new jT(t,e,r,n)}async function Bb(t,e){const r=pe(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const o=[],c=[];let u=be();for(const d of i){o.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}for(const d of a){c.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}return r.localDocuments.getDocuments(n,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:c}))})})}function ST(t,e){const r=pe(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,d,m){const p=d.batch,x=p.keys();let j=Y.resolve();return x.forEach(I=>{j=j.next(()=>m.getEntry(u,I)).next(b=>{const R=d.docVersions.get(I);Ae(R!==null),b.version.compareTo(R)<0&&(p.applyToRemoteDocument(b,d),b.isValidDocument()&&(b.setReadTime(d.commitVersion),m.addEntry(b)))})}),j.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=be();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function $b(t){const e=pe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function ET(t,e){const r=pe(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const c=[];e.targetChanges.forEach((m,p)=>{const x=i.get(p);if(!x)return;c.push(r.Ur.removeMatchingKeys(a,m.removedDocuments,p).next(()=>r.Ur.addMatchingKeys(a,m.addedDocuments,p)));let j=x.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?j=j.withResumeToken(vt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):m.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(m.resumeToken,n)),i=i.insert(p,j),function(b,R,v){return b.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(x,j,m)&&c.push(r.Ur.updateTargetData(a,j))});let u=fs(),d=be();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(a,m))}),c.push(CT(a,o,e.documentUpdates).next(m=>{u=m.Ps,d=m.Is})),!n.isEqual(fe.min())){const m=r.Ur.getLastRemoteSnapshotVersion(a).next(p=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));c.push(m)}return Y.waitFor(c).next(()=>o.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,u,d)).next(()=>u)}).then(a=>(r.os=i,a))}function CT(t,e,r){let n=be(),i=be();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let o=fs();return r.forEach((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(fe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):ae("LocalStore","Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function kT(t,e){const r=pe(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function IT(t,e){const r=pe(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(a=>a?(i=a,Y.resolve(i)):r.Ur.allocateTargetId(n).next(o=>(i=new Ls(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function im(t,e,r){const n=pe(t),i=n.os.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Ho(o))throw o;ae("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function p0(t,e,r){const n=pe(t);let i=fe.min(),a=be();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,m){const p=pe(u),x=p._s.get(m);return x!==void 0?Y.resolve(p.os.get(x)):p.Ur.getTargetData(d,m)}(n,o,Br(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,c.targetId).next(u=>{a=u})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?i:fe.min(),r?a:be())).next(c=>(TT(n,vI(e),c),{documents:c,Ts:a})))}function TT(t,e,r){let n=t.us.get(e)||fe.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.us.set(e,n)}class g0{constructor(){this.activeTargetIds=SI()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class AT{constructor(){this.so=new g0,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new g0,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ae("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ae("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ul=null;function Md(){return Ul===null?Ul=function(){return 268435456+Math.round(2147483648*Math.random())}():Ul++,"0x"+Ul.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="WebChannelConnection";class OT extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${a}`}get Fo(){return!1}Mo(r,n,i,a,o){const c=Md(),u=this.xo(r,n.toUriEncodedString());ae("RestConnection",`Sending RPC '${r}' ${c}:`,u,i);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,a,o),this.No(r,u,d,i).then(m=>(ae("RestConnection",`Received RPC '${r}' ${c}: `,m),m),m=>{throw Vi("RestConnection",`RPC '${r}' ${c} failed with error: `,m,"url: ",u,"request:",i),m})}Lo(r,n,i,a,o,c){return this.Mo(r,n,i,a,o)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ea}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,o)=>r[o]=a),i&&i.headers.forEach((a,o)=>r[o]=a)}xo(r,n){const i=RT[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const a=Md();return new Promise((o,c)=>{const u=new rb;u.setWithCredentials(!0),u.listenOnce(sb.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case nc.NO_ERROR:const m=u.getResponseJson();ae(St,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),o(m);break;case nc.TIMEOUT:ae(St,`RPC '${e}' ${a} timed out`),c(new te(G.DEADLINE_EXCEEDED,"Request time out"));break;case nc.HTTP_ERROR:const p=u.getStatus();if(ae(St,`RPC '${e}' ${a} failed with status:`,p,"response text:",u.getResponseText()),p>0){let x=u.getResponseJson();Array.isArray(x)&&(x=x[0]);const j=x==null?void 0:x.error;if(j&&j.status&&j.message){const I=function(R){const v=R.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(v)>=0?v:G.UNKNOWN}(j.status);c(new te(I,j.message))}else c(new te(G.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new te(G.UNAVAILABLE,"Connection failed."));break;default:me()}}finally{ae(St,`RPC '${e}' ${a} completed.`)}});const d=JSON.stringify(i);ae(St,`RPC '${e}' ${a} sending request:`,i),u.send(r,"POST",d,n,15)})}Bo(e,r,n){const i=Md(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ab(),c=ib(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const m=a.join("");ae(St,`Creating RPC '${e}' stream ${i}: ${m}`,u);const p=o.createWebChannel(m,u);let x=!1,j=!1;const I=new DT({Io:R=>{j?ae(St,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(x||(ae(St,`Opening RPC '${e}' stream ${i} transport.`),p.open(),x=!0),ae(St,`RPC '${e}' stream ${i} sending:`,R),p.send(R))},To:()=>p.close()}),b=(R,v,y)=>{R.listen(v,f=>{try{y(f)}catch(E){setTimeout(()=>{throw E},0)}})};return b(p,Va.EventType.OPEN,()=>{j||(ae(St,`RPC '${e}' stream ${i} transport opened.`),I.yo())}),b(p,Va.EventType.CLOSE,()=>{j||(j=!0,ae(St,`RPC '${e}' stream ${i} transport closed`),I.So())}),b(p,Va.EventType.ERROR,R=>{j||(j=!0,Vi(St,`RPC '${e}' stream ${i} transport errored:`,R),I.So(new te(G.UNAVAILABLE,"The operation could not be completed")))}),b(p,Va.EventType.MESSAGE,R=>{var v;if(!j){const y=R.data[0];Ae(!!y);const f=y,E=f.error||((v=f[0])===null||v===void 0?void 0:v.error);if(E){ae(St,`RPC '${e}' stream ${i} received error:`,E);const P=E.status;let F=function(T){const A=Xe[T];if(A!==void 0)return Ab(A)}(P),N=E.message;F===void 0&&(F=G.INTERNAL,N="Unknown error status: "+P+" with message "+E.message),j=!0,I.So(new te(F,N)),p.close()}else ae(St,`RPC '${e}' stream ${i} received:`,y),I.bo(y)}}),b(c,nb.STAT_EVENT,R=>{R.stat===Gh.PROXY?ae(St,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Gh.NOPROXY&&ae(St,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{I.wo()},0),I}}function Vd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(t){return new WI(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e,r,n=1e3,i=1.5,a=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&ae("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e,r,n,i,a,o,c,u){this.ui=e,this.Ho=n,this.Jo=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new zb(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===G.RESOURCE_EXHAUSTED?(ms(r.toString()),ms("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new te(G.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ae("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(ae("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class LT extends qb{constructor(e,r,n,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,o),this.serializer=a}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=GI(this.serializer,e),n=function(a){if(!("targetChange"in a))return fe.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?$r(o.readTime):fe.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=nm(this.serializer),r.addTarget=function(a,o){let c;const u=o.target;if(c=Xh(u)?{documents:JI(a,u)}:{query:XI(a,u)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=Db(a,o.resumeToken);const d=tm(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(fe.min())>0){c.readTime=Hc(a,o.snapshotVersion.toTimestamp());const d=tm(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const n=eT(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=nm(this.serializer),r.removeTarget=e,this.a_(r)}}class MT extends qb{constructor(e,r,n,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,o),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Ae(!!e.streamToken),this.lastStreamToken=e.streamToken,Ae(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ae(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=YI(e.writeResults,e.commitTime),n=$r(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=nm(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>QI(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new te(G.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Mo(e,rm(r,n),i,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new te(G.UNKNOWN,a.toString())})}Lo(e,r,n,i,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,rm(r,n),i,o,c,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new te(G.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class FT{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ms(r),this.D_=!1):ae("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(o=>{n.enqueueAndForget(async()=>{qn(this)&&(ae("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=pe(u);d.L_.add(4),await Qo(d),d.q_.set("Unknown"),d.L_.delete(4),await Cu(d)}(this))})}),this.q_=new FT(n,i)}}async function Cu(t){if(qn(t))for(const e of t.B_)await e(!0)}async function Qo(t){for(const e of t.B_)await e(!1)}function Wb(t,e){const r=pe(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Ff(r)?Vf(r):sa(r).r_()&&Mf(r,e))}function Lf(t,e){const r=pe(t),n=sa(r);r.N_.delete(e),n.r_()&&Hb(r,e),r.N_.size===0&&(n.r_()?n.o_():qn(r)&&r.q_.set("Unknown"))}function Mf(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}sa(t).A_(e)}function Hb(t,e){t.Q_.xe(e),sa(t).R_(e)}function Vf(t){t.Q_=new BI({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),sa(t).start(),t.q_.v_()}function Ff(t){return qn(t)&&!sa(t).n_()&&t.N_.size>0}function qn(t){return pe(t).L_.size===0}function Kb(t){t.Q_=void 0}async function BT(t){t.q_.set("Online")}async function $T(t){t.N_.forEach((e,r)=>{Mf(t,e)})}async function zT(t,e){Kb(t),Ff(t)?(t.q_.M_(e),Vf(t)):t.q_.set("Unknown")}async function qT(t,e,r){if(t.q_.set("Online"),e instanceof Rb&&e.state===2&&e.cause)try{await async function(i,a){const o=a.cause;for(const c of a.targetIds)i.N_.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.N_.delete(c),i.Q_.removeTarget(c))}(t,e)}catch(n){ae("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Kc(t,n)}else if(e instanceof oc?t.Q_.Ke(e):e instanceof Pb?t.Q_.He(e):t.Q_.We(e),!r.isEqual(fe.min()))try{const n=await $b(t.localStore);r.compareTo(n)>=0&&await function(a,o){const c=a.Q_.rt(o);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const m=a.N_.get(d);m&&a.N_.set(d,m.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,d)=>{const m=a.N_.get(u);if(!m)return;a.N_.set(u,m.withResumeToken(vt.EMPTY_BYTE_STRING,m.snapshotVersion)),Hb(a,u);const p=new Ls(m.target,u,d,m.sequenceNumber);Mf(a,p)}),a.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){ae("RemoteStore","Failed to raise snapshot:",n),await Kc(t,n)}}async function Kc(t,e,r){if(!Ho(e))throw e;t.L_.add(1),await Qo(t),t.q_.set("Offline"),r||(r=()=>$b(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ae("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Cu(t)})}function Gb(t,e){return e().catch(r=>Kc(t,r,e))}async function ku(t){const e=pe(t),r=tn(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;WT(e);)try{const i=await kT(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,HT(e,i)}catch(i){await Kc(e,i)}Qb(e)&&Yb(e)}function WT(t){return qn(t)&&t.O_.length<10}function HT(t,e){t.O_.push(e);const r=tn(t);r.r_()&&r.V_&&r.m_(e.mutations)}function Qb(t){return qn(t)&&!tn(t).n_()&&t.O_.length>0}function Yb(t){tn(t).start()}async function KT(t){tn(t).p_()}async function GT(t){const e=tn(t);for(const r of t.O_)e.m_(r.mutations)}async function QT(t,e,r){const n=t.O_.shift(),i=Tf.from(n,e,r);await Gb(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await ku(t)}async function YT(t,e){e&&tn(t).V_&&await async function(n,i){if(function(o){return VI(o)&&o!==G.ABORTED}(i.code)){const a=n.O_.shift();tn(n).s_(),await Gb(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await ku(n)}}(t,e),Qb(t)&&Yb(t)}async function y0(t,e){const r=pe(t);r.asyncQueue.verifyOperationInProgress(),ae("RemoteStore","RemoteStore received new credentials");const n=qn(r);r.L_.add(3),await Qo(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Cu(r)}async function JT(t,e){const r=pe(t);e?(r.L_.delete(2),await Cu(r)):e||(r.L_.add(2),await Qo(r),r.q_.set("Unknown"))}function sa(t){return t.K_||(t.K_=function(r,n,i){const a=pe(r);return a.w_(),new LT(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Eo:BT.bind(null,t),Ro:$T.bind(null,t),mo:zT.bind(null,t),d_:qT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Ff(t)?Vf(t):t.q_.set("Unknown")):(await t.K_.stop(),Kb(t))})),t.K_}function tn(t){return t.U_||(t.U_=function(r,n,i){const a=pe(r);return a.w_(),new MT(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:KT.bind(null,t),mo:YT.bind(null,t),f_:GT.bind(null,t),g_:QT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await ku(t)):(await t.U_.stop(),t.O_.length>0&&(ae("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new as,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const o=Date.now()+n,c=new Uf(e,r,o,i,a);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bf(t,e){if(ms("AsyncQueue",`${e}: ${t}`),Ho(t))return new te(G.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this.comparator=e?(r,n)=>e(r,n)||le.comparator(r.key,n.key):(r,n)=>le.comparator(r.key,n.key),this.keyedMap=Fa(),this.sortedSet=new Ke(this.comparator)}static emptySet(e){return new Si(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Si)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Si;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(){this.W_=new Ke(le.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):me():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class zi{constructor(e,r,n,i,a,o,c,u,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,i,a){const o=[];return r.forEach(c=>{o.push({type:0,doc:c})}),new zi(e,r,Si.emptySet(r),o,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class ZT{constructor(){this.queries=w0(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=pe(r),a=i.queries;i.queries=w0(),a.forEach((o,c)=>{for(const u of c.j_)u.onError(n)})})(this,new te(G.ABORTED,"Firestore shutting down"))}}function w0(){return new ra(t=>vb(t),wu)}async function Jb(t,e){const r=pe(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.H_()&&e.J_()&&(n=2):(a=new XT,n=e.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(i,!0);break;case 1:a.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(o){const c=Bf(o,`Initialization of query '${ei(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,a),a.j_.push(e),e.Z_(r.onlineState),a.z_&&e.X_(a.z_)&&$f(r)}async function Xb(t,e){const r=pe(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const o=a.j_.indexOf(e);o>=0&&(a.j_.splice(o,1),a.j_.length===0?i=e.J_()?0:1:!a.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function eA(t,e){const r=pe(t);let n=!1;for(const i of e){const a=i.query,o=r.queries.get(a);if(o){for(const c of o.j_)c.X_(i)&&(n=!0);o.z_=i}}n&&$f(r)}function tA(t,e,r){const n=pe(t),i=n.queries.get(e);if(i)for(const a of i.j_)a.onError(r);n.queries.delete(e)}function $f(t){t.Y_.forEach(e=>{e.next()})}var am,b0;(b0=am||(am={})).ea="default",b0.Cache="cache";class Zb{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new zi(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=zi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==am.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(e){this.key=e}}class tN{constructor(e){this.key=e}}class rA{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=be(),this.mutatedKeys=be(),this.Aa=wb(e),this.Ra=new Si(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new v0,i=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,p)=>{const x=i.get(m),j=bu(this.query,p)?p:null,I=!!x&&this.mutatedKeys.has(x.key),b=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let R=!1;x&&j?x.data.isEqual(j.data)?I!==b&&(n.track({type:3,doc:j}),R=!0):this.ga(x,j)||(n.track({type:2,doc:j}),R=!0,(u&&this.Aa(j,u)>0||d&&this.Aa(j,d)<0)&&(c=!0)):!x&&j?(n.track({type:0,doc:j}),R=!0):x&&!j&&(n.track({type:1,doc:x}),R=!0,(u||d)&&(c=!0)),R&&(j?(o=o.add(j),a=b?a.add(m):a.delete(m)):(o=o.delete(m),a=a.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),a=a.delete(m.key),n.track({type:1,doc:m})}return{Ra:o,fa:n,ns:c,mutatedKeys:a}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((m,p)=>function(j,I){const b=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me()}};return b(j)-b(I)}(m.type,p.type)||this.Aa(m.doc,p.doc)),this.pa(n),i=i!=null&&i;const c=r&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new zi(this.query,e.Ra,a,o,e.mutatedKeys,u===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new v0,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=be(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new tN(n))}),this.da.forEach(n=>{e.has(n)||r.push(new eN(n))}),r}ba(e){this.Ta=e.Ts,this.da=be();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return zi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class sA{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class nA{constructor(e){this.key=e,this.va=!1}}class iA{constructor(e,r,n,i,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ra(c=>vb(c),wu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ke(le.comparator),this.Na=new Map,this.La=new Rf,this.Ba={},this.ka=new Map,this.qa=$i.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function aA(t,e,r=!0){const n=oN(t);let i;const a=n.Fa.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Da()):i=await rN(n,e,r,!0),i}async function oA(t,e){const r=oN(t);await rN(r,e,!0,!1)}async function rN(t,e,r,n){const i=await IT(t.localStore,Br(e)),a=i.targetId,o=t.sharedClientState.addLocalQueryTarget(a,r);let c;return n&&(c=await lA(t,e,a,o==="current",i.resumeToken)),t.isPrimaryClient&&r&&Wb(t.remoteStore,i),c}async function lA(t,e,r,n,i){t.Ka=(p,x,j)=>async function(b,R,v,y){let f=R.view.ma(v);f.ns&&(f=await p0(b.localStore,R.query,!1).then(({documents:N})=>R.view.ma(N,f)));const E=y&&y.targetChanges.get(R.targetId),P=y&&y.targetMismatches.get(R.targetId)!=null,F=R.view.applyChanges(f,b.isPrimaryClient,E,P);return j0(b,R.targetId,F.wa),F.snapshot}(t,p,x,j);const a=await p0(t.localStore,e,!0),o=new rA(e,a.Ts),c=o.ma(a.documents),u=Go.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),d=o.applyChanges(c,t.isPrimaryClient,u);j0(t,r,d.wa);const m=new sA(e,r,o);return t.Fa.set(e,m),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),d.snapshot}async function cA(t,e,r){const n=pe(t),i=n.Fa.get(e),a=n.Ma.get(i.targetId);if(a.length>1)return n.Ma.set(i.targetId,a.filter(o=>!wu(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await im(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Lf(n.remoteStore,i.targetId),om(n,i.targetId)}).catch(Wo)):(om(n,i.targetId),await im(n.localStore,i.targetId,!0))}async function uA(t,e){const r=pe(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Lf(r.remoteStore,n.targetId))}async function dA(t,e,r){const n=yA(t);try{const i=await function(o,c){const u=pe(o),d=it.now(),m=c.reduce((j,I)=>j.add(I.key),be());let p,x;return u.persistence.runTransaction("Locally write mutations","readwrite",j=>{let I=fs(),b=be();return u.cs.getEntries(j,m).next(R=>{I=R,I.forEach((v,y)=>{y.isValidDocument()||(b=b.add(v))})}).next(()=>u.localDocuments.getOverlayedDocuments(j,I)).next(R=>{p=R;const v=[];for(const y of c){const f=RI(y,p.get(y.key).overlayedDocument);f!=null&&v.push(new cn(y.key,f,db(f.value.mapValue),Vt.exists(!0)))}return u.mutationQueue.addMutationBatch(j,d,v,c)}).next(R=>{x=R;const v=R.applyToLocalDocumentSet(p,b);return u.documentOverlayCache.saveOverlays(j,R.batchId,v)})}).then(()=>({batchId:x.batchId,changes:Nb(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,c,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new Ke(Ce)),d=d.insert(c,u),o.Ba[o.currentUser.toKey()]=d}(n,i.batchId,r),await Yo(n,i.changes),await ku(n.remoteStore)}catch(i){const a=Bf(i,"Failed to persist write");r.reject(a)}}async function sN(t,e){const r=pe(t);try{const n=await ET(r.localStore,e);e.targetChanges.forEach((i,a)=>{const o=r.Na.get(a);o&&(Ae(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Ae(o.va):i.removedDocuments.size>0&&(Ae(o.va),o.va=!1))}),await Yo(r,n,e)}catch(n){await Wo(n)}}function N0(t,e,r){const n=pe(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((a,o)=>{const c=o.view.Z_(e);c.snapshot&&i.push(c.snapshot)}),function(o,c){const u=pe(o);u.onlineState=c;let d=!1;u.queries.forEach((m,p)=>{for(const x of p.j_)x.Z_(c)&&(d=!0)}),d&&$f(u)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function hA(t,e,r){const n=pe(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),a=i&&i.key;if(a){let o=new Ke(le.comparator);o=o.insert(a,kt.newNoDocument(a,fe.min()));const c=be().add(a),u=new Su(fe.min(),new Map,new Ke(Ce),o,c);await sN(n,u),n.Oa=n.Oa.remove(a),n.Na.delete(e),zf(n)}else await im(n.localStore,e,!1).then(()=>om(n,e,r)).catch(Wo)}async function mA(t,e){const r=pe(t),n=e.batch.batchId;try{const i=await ST(r.localStore,e);iN(r,n,null),nN(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Yo(r,i)}catch(i){await Wo(i)}}async function fA(t,e,r){const n=pe(t);try{const i=await function(o,c){const u=pe(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return u.mutationQueue.lookupMutationBatch(d,c).next(p=>(Ae(p!==null),m=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,m,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>u.localDocuments.getDocuments(d,m))})}(n.localStore,e);iN(n,e,r),nN(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Yo(n,i)}catch(i){await Wo(i)}}function nN(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function iN(t,e,r){const n=pe(t);let i=n.Ba[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function om(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||aN(t,n)})}function aN(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Lf(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),zf(t))}function j0(t,e,r){for(const n of r)n instanceof eN?(t.La.addReference(n.key,e),pA(t,n)):n instanceof tN?(ae("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||aN(t,n.key)):me()}function pA(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(ae("SyncEngine","New document in limbo: "+r),t.xa.add(n),zf(t))}function zf(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new le(Ve.fromString(e)),n=t.qa.next();t.Na.set(n,new nA(r)),t.Oa=t.Oa.insert(r,n),Wb(t.remoteStore,new Ls(Br(kf(r.path)),n,"TargetPurposeLimboResolution",Nf.oe))}}async function Yo(t,e,r){const n=pe(t),i=[],a=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((c,u)=>{o.push(n.Ka(u,e,r).then(d=>{var m;if((d||r)&&n.isPrimaryClient){const p=d?!d.fromCache:(m=r==null?void 0:r.targetChanges.get(u.targetId))===null||m===void 0?void 0:m.current;n.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){i.push(d);const p=Of.Wi(u.targetId,d);a.push(p)}}))}),await Promise.all(o),n.Ca.d_(i),await async function(u,d){const m=pe(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Y.forEach(d,x=>Y.forEach(x.$i,j=>m.persistence.referenceDelegate.addReference(p,x.targetId,j)).next(()=>Y.forEach(x.Ui,j=>m.persistence.referenceDelegate.removeReference(p,x.targetId,j)))))}catch(p){if(!Ho(p))throw p;ae("LocalStore","Failed to update sequence numbers: "+p)}for(const p of d){const x=p.targetId;if(!p.fromCache){const j=m.os.get(x),I=j.snapshotVersion,b=j.withLastLimboFreeSnapshotVersion(I);m.os=m.os.insert(x,b)}}}(n.localStore,a))}async function gA(t,e){const r=pe(t);if(!r.currentUser.isEqual(e)){ae("SyncEngine","User change. New user:",e.toKey());const n=await Bb(r.localStore,e);r.currentUser=e,function(a,o){a.ka.forEach(c=>{c.forEach(u=>{u.reject(new te(G.CANCELLED,o))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Yo(r,n.hs)}}function xA(t,e){const r=pe(t),n=r.Na.get(e);if(n&&n.va)return be().add(n.key);{let i=be();const a=r.Ma.get(e);if(!a)return i;for(const o of a){const c=r.Fa.get(o);i=i.unionWith(c.view.Va)}return i}}function oN(t){const e=pe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=sN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hA.bind(null,e),e.Ca.d_=eA.bind(null,e.eventManager),e.Ca.$a=tA.bind(null,e.eventManager),e}function yA(t){const e=pe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fA.bind(null,e),e}class Gc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Eu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return _T(this.persistence,new NT,e.initialUser,this.serializer)}Ga(e){return new vT(Df.Zr,this.serializer)}Wa(e){return new AT}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gc.provider={build:()=>new Gc};class lm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>N0(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=gA.bind(null,this.syncEngine),await JT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ZT}()}createDatastore(e){const r=Eu(e.databaseInfo.databaseId),n=function(a){return new OT(a)}(e.databaseInfo);return function(a,o,c,u){return new VT(a,o,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,o,c){return new UT(n,i,a,o,c)}(this.localStore,this.datastore,e.asyncQueue,r=>N0(this.syncEngine,r,0),function(){return x0.D()?new x0:new PT}())}createSyncEngine(e,r){return function(i,a,o,c,u,d,m){const p=new iA(i,a,o,c,u,d);return m&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const a=pe(i);ae("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await Qo(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}lm.provider={build:()=>new lm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ms("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Et.UNAUTHENTICATED,this.clientId=lb.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async o=>{ae("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(ae("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new as;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Bf(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Fd(t,e){t.asyncQueue.verifyOperationInProgress(),ae("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Bb(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function _0(t,e){t.asyncQueue.verifyOperationInProgress();const r=await wA(t);ae("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>y0(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>y0(e.remoteStore,i)),t._onlineComponents=e}async function wA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ae("FirestoreClient","Using user provided OfflineComponentProvider");try{await Fd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===G.FAILED_PRECONDITION||i.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Vi("Error using user provided cache. Falling back to memory cache: "+r),await Fd(t,new Gc)}}else ae("FirestoreClient","Using default OfflineComponentProvider"),await Fd(t,new Gc);return t._offlineComponents}async function cN(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ae("FirestoreClient","Using user provided OnlineComponentProvider"),await _0(t,t._uninitializedComponentsProvider._online)):(ae("FirestoreClient","Using default OnlineComponentProvider"),await _0(t,new lm))),t._onlineComponents}function bA(t){return cN(t).then(e=>e.syncEngine)}async function uN(t){const e=await cN(t),r=e.eventManager;return r.onListen=aA.bind(null,e.syncEngine),r.onUnlisten=cA.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=oA.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=uA.bind(null,e.syncEngine),r}function NA(t,e,r={}){const n=new as;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,d){const m=new lN({next:x=>{m.Za(),o.enqueueAndForget(()=>Xb(a,p));const j=x.docs.has(c);!j&&x.fromCache?d.reject(new te(G.UNAVAILABLE,"Failed to get document because the client is offline.")):j&&x.fromCache&&u&&u.source==="server"?d.reject(new te(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(x)},error:x=>d.reject(x)}),p=new Zb(kf(c.path),m,{includeMetadataChanges:!0,_a:!0});return Jb(a,p)}(await uN(t),t.asyncQueue,e,r,n)),n.promise}function jA(t,e,r={}){const n=new as;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,d){const m=new lN({next:x=>{m.Za(),o.enqueueAndForget(()=>Xb(a,p)),x.fromCache&&u.source==="server"?d.reject(new te(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(x)},error:x=>d.reject(x)}),p=new Zb(c,m,{includeMetadataChanges:!0,_a:!0});return Jb(a,p)}(await uN(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dN(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hN(t,e,r){if(!r)throw new te(G.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function _A(t,e,r,n){if(e===!0&&n===!0)throw new te(G.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function E0(t){if(!le.isDocumentKey(t))throw new te(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function C0(t){if(le.isDocumentKey(t))throw new te(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Iu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":me()}function xr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Iu(t);throw new te(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new te(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_A("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dN((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new te(G.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new te(G.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new te(G.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Tu{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new k0({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new k0(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Bk;switch(n.type){case"firstParty":return new Wk(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new te(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=S0.get(r);n&&(ae("ComponentProvider","Removing Datastore"),S0.delete(r),n.terminate())}(this),Promise.resolve()}}function SA(t,e,r,n={}){var i;const a=(t=xr(t,Tu))._getSettings(),o=`${e}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==o&&Vi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),n.mockUserToken){let c,u;if(typeof n.mockUserToken=="string")c=n.mockUserToken,u=Et.MOCK_USER;else{c=rE(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new te(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Et(d)}t._authCredentials=new $k(new ob(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Wn(this.firestore,e,this._query)}}class Ft{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ft(this.firestore,e,this._key)}}class Qs extends Wn{constructor(e,r,n){super(e,r,kf(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new le(e))}withConverter(e){return new Qs(this.firestore,e,this._path)}}function ke(t,e,...r){if(t=tt(t),hN("collection","path",e),t instanceof Tu){const n=Ve.fromString(e,...r);return C0(n),new Qs(t,null,n)}{if(!(t instanceof Ft||t instanceof Qs))throw new te(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ve.fromString(e,...r));return C0(n),new Qs(t.firestore,null,n)}}function Re(t,e,...r){if(t=tt(t),arguments.length===1&&(e=lb.newId()),hN("doc","path",e),t instanceof Tu){const n=Ve.fromString(e,...r);return E0(n),new Ft(t,null,new le(n))}{if(!(t instanceof Ft||t instanceof Qs))throw new te(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ve.fromString(e,...r));return E0(n),new Ft(t.firestore,t instanceof Qs?t.converter:null,new le(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new zb(this,"async_queue_retry"),this.Vu=()=>{const n=Vd();n&&ae("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Vd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Vd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new as;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ho(e))throw e;ae("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(n);throw ms("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Uf.createAndSchedule(this,e,r,n,a=>this.yu(a));return this.Tu.push(i),i}fu(){this.Eu&&me()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}class un extends Tu{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new I0,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new I0(e),this._firestoreClient=void 0,await e}}}function EA(t,e){const r=typeof t=="object"?t:yw(),n=typeof t=="string"?t:"(default)",i=df(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=eE("firestore");a&&SA(i,...a)}return i}function Au(t){if(t._terminated)throw new te(G.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||CA(t),t._firestoreClient}function CA(t){var e,r,n;const i=t._freezeSettings(),a=function(c,u,d,m){return new nI(c,u,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,dN(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new vA(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qi(vt.fromBase64String(e))}catch(r){throw new te(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new qi(vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new te(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ft(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new te(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new te(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ce(this._lat,e._lat)||Ce(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA=/^__.*__$/;class IA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new cn(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ko(e,this.data,r,this.fieldTransforms)}}class mN{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new cn(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function fN(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me()}}class Hf{constructor(e,r,n,i,a,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Hf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Qc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(fN(this.Cu)&&kA.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class TA{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Eu(e)}Qu(e,r,n,i=!1){return new Hf({Cu:e,methodName:r,qu:n,path:ft.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xo(t){const e=t._freezeSettings(),r=Eu(t._databaseId);return new TA(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Kf(t,e,r,n,i,a={}){const o=t.Qu(a.merge||a.mergeFields?2:0,e,r,i);Qf("Data must be an object, but it was:",o,n);const c=xN(n,o);let u,d;if(a.merge)u=new sr(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const m=[];for(const p of a.mergeFields){const x=cm(e,p,r);if(!o.contains(x))throw new te(G.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);vN(m,x)||m.push(x)}u=new sr(m),d=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=o.fieldTransforms;return new IA(new Ht(c),u,d)}class Ru extends Pu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ru}}class Gf extends Pu{_toFieldTransform(e){return new II(e.path,new Ao)}isEqual(e){return e instanceof Gf}}function pN(t,e,r,n){const i=t.Qu(1,e,r);Qf("Data must be an object, but it was:",i,n);const a=[],o=Ht.empty();zn(n,(u,d)=>{const m=Yf(e,u,r);d=tt(d);const p=i.Nu(m);if(d instanceof Ru)a.push(m);else{const x=Zo(d,p);x!=null&&(a.push(m),o.set(m,x))}});const c=new sr(a);return new mN(o,c,i.fieldTransforms)}function gN(t,e,r,n,i,a){const o=t.Qu(1,e,r),c=[cm(e,n,r)],u=[i];if(a.length%2!=0)throw new te(G.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)c.push(cm(e,a[x])),u.push(a[x+1]);const d=[],m=Ht.empty();for(let x=c.length-1;x>=0;--x)if(!vN(d,c[x])){const j=c[x];let I=u[x];I=tt(I);const b=o.Nu(j);if(I instanceof Ru)d.push(j);else{const R=Zo(I,b);R!=null&&(d.push(j),m.set(j,R))}}const p=new sr(d);return new mN(m,p,o.fieldTransforms)}function AA(t,e,r,n=!1){return Zo(r,t.Qu(n?4:3,e))}function Zo(t,e){if(yN(t=tt(t)))return Qf("Unsupported field value:",e,t),xN(t,e);if(t instanceof Pu)return function(n,i){if(!fN(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const a=[];let o=0;for(const c of n){let u=Zo(c,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=tt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return EI(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=it.fromDate(n);return{timestampValue:Hc(i.serializer,a)}}if(n instanceof it){const a=new it(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Hc(i.serializer,a)}}if(n instanceof qf)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof qi)return{bytesValue:Db(i.serializer,n._byteString)};if(n instanceof Ft){const a=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(a))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Pf(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Wf)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return If(c.serializer,u)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Iu(n)}`)}(t,e)}function xN(t,e){const r={};return cb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zn(t,(n,i)=>{const a=Zo(i,e.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function yN(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof it||t instanceof qf||t instanceof qi||t instanceof Ft||t instanceof Pu||t instanceof Wf)}function Qf(t,e,r){if(!yN(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Iu(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function cm(t,e,r){if((e=tt(e))instanceof Jo)return e._internalPath;if(typeof e=="string")return Yf(t,e);throw Qc("Field path arguments must be of type string or ",t,!1,void 0,r)}const PA=new RegExp("[~\\*/\\[\\]]");function Yf(t,e,r){if(e.search(PA)>=0)throw Qc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Jo(...e.split("."))._internalPath}catch{throw Qc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Qc(t,e,r,n,i){const a=n&&!n.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${n}`),o&&(u+=` in document ${i}`),u+=")"),new te(G.INVALID_ARGUMENT,c+t+u)}function vN(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Du("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class RA extends wN{data(){return super.data()}}function Du(t,e){return typeof e=="string"?Yf(t,e):e instanceof Jo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new te(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jf{}class bN extends Jf{}function It(t,e,...r){let n=[];e instanceof Jf&&n.push(e),n=n.concat(r),function(a){const o=a.filter(u=>u instanceof Xf).length,c=a.filter(u=>u instanceof Ou).length;if(o>1||o>0&&c>0)throw new te(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class Ou extends bN{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Ou(e,r,n)}_apply(e){const r=this._parse(e);return NN(e._query,r),new Wn(e.firestore,e.converter,Zh(e._query,r))}_parse(e){const r=Xo(e.firestore);return function(a,o,c,u,d,m,p){let x;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new te(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){A0(p,m);const j=[];for(const I of p)j.push(T0(u,a,I));x={arrayValue:{values:j}}}else x=T0(u,a,p)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||A0(p,m),x=AA(c,o,p,m==="in"||m==="not-in");return et.create(d,m,x)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Ei(t,e,r){const n=e,i=Du("where",t);return Ou._create(i,n,r)}class Xf extends Jf{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Xf(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Tr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)NN(o,u),o=Zh(o,u)}(e._query,r),new Wn(e.firestore,e.converter,Zh(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Zf extends bN{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Zf(e,r)}_apply(e){const r=function(i,a,o){if(i.startAt!==null)throw new te(G.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new te(G.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new To(a,o)}(e._query,this._field,this._direction);return new Wn(e.firestore,e.converter,function(i,a){const o=i.explicitOrderBy.concat([a]);return new ta(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function _r(t,e="asc"){const r=e,n=Du("orderBy",t);return Zf._create(n,r)}function T0(t,e,r){if(typeof(r=tt(r))=="string"){if(r==="")throw new te(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yb(e)&&r.indexOf("/")!==-1)throw new te(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Ve.fromString(r));if(!le.isDocumentKey(n))throw new te(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Xx(t,new le(n))}if(r instanceof Ft)return Xx(t,r._key);throw new te(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Iu(r)}.`)}function A0(t,e){if(!Array.isArray(t)||t.length===0)throw new te(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function NN(t,e){const r=function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new te(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class OA{convertValue(e,r="none"){switch(On(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Dn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw me()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return zn(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,i;const a=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>Ye(o.doubleValue));return new Wf(a)}convertGeoPoint(e){return new qf(Ye(e.latitude),Ye(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=_f(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Co(e));default:return null}}convertTimestamp(e){const r=en(e);return new it(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Ve.fromString(e);Ae(Ub(n));const i=new ko(n.get(1),n.get(3)),a=new le(n.popFirst(5));return i.isEqual(r)||ms(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jN extends wN{constructor(e,r,n,i,a,o){super(e,r,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new lc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Du("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class lc extends jN{data(e={}){return super.data(e)}}class LA{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Ba(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new lc(this._firestore,this._userDataWriter,n.key,n,new Ba(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new te(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{const u=new lc(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Ba(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>a||c.type!==3).map(c=>{const u=new lc(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Ba(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,m=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:MA(c.type),doc:u,oldIndex:d,newIndex:m}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function MA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(t){t=xr(t,Ft);const e=xr(t.firestore,un);return NA(Au(e),t._key).then(r=>FA(e,t,r))}class _N extends OA{constructor(e){super(),this.firestore=e}convertBytes(e){return new qi(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,r)}}function st(t){t=xr(t,Wn);const e=xr(t.firestore,un),r=Au(e),n=new _N(e);return DA(t._query),jA(r,t._query).then(i=>new LA(e,n,t,i))}function Zn(t,e,r){t=xr(t,Ft);const n=xr(t.firestore,un),i=ep(t.converter,e,r);return el(n,[Kf(Xo(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Vt.none())])}function rs(t,e,r,...n){t=xr(t,Ft);const i=xr(t.firestore,un),a=Xo(i);let o;return o=typeof(e=tt(e))=="string"||e instanceof Jo?gN(a,"updateDoc",t._key,e,r,n):pN(a,"updateDoc",t._key,e),el(i,[o.toMutation(t._key,Vt.exists(!0))])}function Ln(t){return el(xr(t.firestore,un),[new _u(t._key,Vt.none())])}function ss(t,e){const r=xr(t.firestore,un),n=Re(t),i=ep(t.converter,e);return el(r,[Kf(Xo(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,Vt.exists(!1))]).then(()=>n)}function el(t,e){return function(n,i){const a=new as;return n.asyncQueue.enqueueAndForget(async()=>dA(await bA(n),i,a)),a.promise}(Au(t),e)}function FA(t,e,r){const n=r.docs.get(e._key),i=new _N(t);return new jN(t,i,e._key,n,new Ba(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Xo(e)}set(e,r,n){this._verifyNotCommitted();const i=Ud(e,this._firestore),a=ep(i.converter,r,n),o=Kf(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,Vt.none())),this}update(e,r,n,...i){this._verifyNotCommitted();const a=Ud(e,this._firestore);let o;return o=typeof(r=tt(r))=="string"||r instanceof Jo?gN(this._dataReader,"WriteBatch.update",a._key,r,n,i):pN(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(o.toMutation(a._key,Vt.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Ud(e,this._firestore);return this._mutations=this._mutations.concat(new _u(r._key,Vt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new te(G.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ud(t,e){if((t=tt(t)).firestore!==e)throw new te(G.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Be(){return new Gf("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(t){return Au(t=xr(t,un)),new UA(t,e=>el(t,e))}(function(e,r=!0){(function(i){ea=i})(Xi),Mi(new Tn("firestore",(n,{instanceIdentifier:i,options:a})=>{const o=n.getProvider("app").getImmediate(),c=new un(new zk(n.getProvider("auth-internal")),new Kk(n.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new te(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ko(d.options.projectId,m)}(o,i),o);return a=Object.assign({useFetchStreams:r},a),c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),Gs(Kx,"4.7.3",e),Gs(Kx,"4.7.3","esm2017")})();const BA={apiKey:"AIzaSyCmweaSrha0Cldy8Ar1Sa98ulvJbXXJB-8",authDomain:"business-management-syst-d29bc.firebaseapp.com",projectId:"business-management-syst-d29bc",storageBucket:"business-management-syst-d29bc.firebasestorage.app",messagingSenderId:"1029415433799",appId:"1:1029415433799:web:7e8161378ca18ee7b9a362",measurementId:"G-PB5EYSNNYW"},SN=xw(BA),Bl=Mk(SN),oe=EA(SN),Bd={uid:"mock-user-id",email:"test@example.com",displayName:"Test User",photoURL:null,phoneNumber:null,providerId:"mock",metadata:{creationTime:new Date().toISOString(),lastSignInTime:new Date().toISOString()}},EN=_.createContext({}),Ar=()=>{const t=_.useContext(EN);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},$A=({children:t})=>{const[e,r]=_.useState(null),[n,i]=_.useState(!0),a=async(d,m)=>{var p;try{await NC(Bl,d,m)}catch(x){if(console.error("Login error:",x),x.code==="resource-exhausted"||(p=x.message)!=null&&p.includes("quota"))console.log("Firebase quota exceeded, using mock authentication for testing"),r(Bd);else{if(x.code==="auth/user-not-found"||x.code==="auth/wrong-password")throw new Error("Invalid email or password");console.log("Firebase error, using mock authentication for testing"),r(Bd)}}},o=async(d,m,p)=>{try{const x=await bC(Bl,d,m);if(p&&x.user){const j={firstName:p.firstName,lastName:p.lastName,phone:p.phone||"",email:x.user.email,createdAt:new Date().toISOString()};localStorage.setItem("userProfile",JSON.stringify(j))}}catch{console.log("Firebase blocked, using mock authentication for testing"),r(Bd)}},c=async()=>{try{await EC(Bl)}catch{console.log("Firebase blocked, clearing mock authentication"),r(null)}};_.useEffect(()=>{try{return SC(Bl,m=>{r(m),i(!1)})}catch{console.log("Firebase blocked, skipping authentication"),i(!1)}},[]);const u={currentUser:e,login:a,register:o,logout:c,loading:n};return s.jsx(EN.Provider,{value:u,children:!n&&t})},CN=_.createContext({}),$t=()=>{const t=_.useContext(CN);if(!t)throw new Error("useBusiness must be used within a BusinessProvider");return t},zA=({children:t})=>{const{currentUser:e}=Ar(),[r,n]=_.useState(null),[i,a]=_.useState([]),[o,c]=_.useState([]),[u,d]=_.useState(!0),m=async(R,v)=>{if(!e)throw new Error("User must be authenticated");const y=localStorage.getItem("userProfile"),f=y?JSON.parse(y):{},P=R.name.replace(/[^a-zA-Z0-9]/g,"_").toUpperCase(),F={...R,createdAt:new Date,ownerId:e.uid,businessAuthorizationCode:v.businessCode,systemAuthorizationCode:v.systemCode},N=Re(oe,P,"main");await Zn(N,F),await Zn(Re(oe,"business_registry",P),{id:P,name:R.name,businessAuthorizationCode:v.businessCode,systemAuthorizationCode:v.systemCode,createdAt:new Date,ownerId:e.uid});const w=Re(ke(oe,P,"main","users"));await Zn(w,{userId:e.uid,role:"admin",status:"active",joinedAt:new Date,approvedBy:e.uid,approvedAt:new Date,firstName:f.firstName||"",lastName:f.lastName||"",email:e.email||"",phone:f.phone||""}),localStorage.removeItem("userProfile");const T={id:P,...F};n(T),localStorage.setItem("currentBusinessId",T.id)},p=async(R,v,y)=>{if(!e)throw new Error("User must be authenticated");const f=await st(ke(oe,"business_registry"));let E=null,P="";for(const C of f.docs){const S=C.data();if(S.businessAuthorizationCode===R){E={id:C.id,...S},P=C.id;break}}if(!E)throw new Error("Invalid business authorization code");if(v==="admin"&&(!y||y!==E.systemAuthorizationCode))throw new Error("Invalid system authorization code for admin role");const F=It(ke(oe,P,"main","users"),Ei("userId","==",e.uid));if(!(await st(F)).empty)throw new Error("You are already a member of this business");const w=localStorage.getItem("userProfile"),T=w?JSON.parse(w):{},A=Re(ke(oe,P,"main","users")),D={userId:e.uid,role:v,status:v==="admin"&&y===E.systemAuthorizationCode?"active":"pending",joinedAt:new Date,firstName:T.firstName||"",lastName:T.lastName||"",email:e.email||"",phone:T.phone||"",...v==="admin"&&y===E.systemAuthorizationCode?{approvedBy:e.uid,approvedAt:new Date}:{}};await Zn(A,D),localStorage.removeItem("userProfile"),v==="admin"&&y===E.systemAuthorizationCode&&(n(E),localStorage.setItem("currentBusinessId",E.id))},x=async R=>{if(!r||!e)throw new Error("User must be authenticated");const v=Re(oe,r.id,"main","users",R);await Zn(v,{status:"active",approvedBy:e.uid,approvedAt:new Date},{merge:!0}),I()},j=async R=>{if(!r||!e)throw new Error("User must be authenticated");const v=Re(oe,r.id,"main","users",R);await Zn(v,{status:"suspended",approvedBy:e.uid,approvedAt:new Date},{merge:!0}),I()},I=async()=>{if(!(!r||!e))try{const R=It(ke(oe,r.id,"main","users"),Ei("status","==","pending")),y=(await st(R)).docs.map(f=>{var E;return{id:f.id,...f.data(),joinedAt:((E=f.data().joinedAt)==null?void 0:E.toDate())||new Date}});c(y)}catch(R){console.error("Error fetching pending members:",R),c([])}};_.useEffect(()=>{(async()=>{var v,y,f;if(!e){d(!1);return}try{const E=[],P=await st(ke(oe,"business_registry"));for(const N of P.docs){const w=N.id,T=N.data(),A=It(ke(oe,w,"main","users"),Ei("userId","==",e.uid));(await st(A)).empty||E.push({id:w,...T})}a(E);const F=localStorage.getItem("currentBusinessId");if(F){const N=E.find(w=>w.id===F);N?n(N):E.length>0&&!r&&n(E[0])}else E.length>0&&!r&&n(E[0])}catch(E){if(console.error("Error fetching businesses:",E),E.code==="resource-exhausted"||(v=E.message)!=null&&v.includes("quota")){console.log("Firebase quota exceeded, using mock business for testing");const P={id:"mock-business-id",name:"Test Business",email:"test@business.com",phone:"+1234567890",address:"123 Test Street",businessType:"Retail",createdAt:new Date,ownerId:(e==null?void 0:e.uid)||"mock-owner",businessAuthorizationCode:"TEST123",systemAuthorizationCode:"SYSTEM123",settings:{mainStoreLocation:"Main Store",approvalRoles:["admin","sales_rep"],currency:"TZS",timezone:"Africa/Dar_es_Salaam"}};a([P]),n(P),localStorage.setItem("currentBusinessId",P.id)}else if((y=E.message)!=null&&y.includes("BLOCKED_BY_CLIENT")||(f=E.message)!=null&&f.includes("ERR_BLOCKED_BY_CLIENT")){console.log("Firebase blocked, using mock business for testing");const P={id:"mock-business-id",name:"Test Business",email:"test@business.com",phone:"+1234567890",address:"123 Test Street",businessType:"Retail",createdAt:new Date,ownerId:(e==null?void 0:e.uid)||"mock-owner",businessAuthorizationCode:"TEST123",systemAuthorizationCode:"SYSTEM123",settings:{mainStoreLocation:"Main Store",approvalRoles:["admin","sales_rep"],currency:"TZS",timezone:"Africa/Dar_es_Salaam"}};a([P]),n(P),localStorage.setItem("currentBusinessId",P.id)}}finally{d(!1)}})()},[e,r]),_.useEffect(()=>{r&&I()},[r]);const b={currentBusiness:r,businesses:i,pendingMembers:o,setCurrentBusiness:n,createBusiness:m,joinBusiness:p,approveMember:x,rejectMember:j,loading:u};return s.jsx(CN.Provider,{value:b,children:t})},kN=_.createContext({}),Lu=()=>{const t=_.useContext(kN);if(!t)throw new Error("useUserApproval must be used within a UserApprovalProvider");return t},qA=({children:t})=>{const{currentUser:e}=Ar(),{currentBusiness:r}=$t(),[n,i]=_.useState({isApproved:!1,businessId:null,role:null,status:null,loading:!0}),a=async()=>{var c;if(!e){i({isApproved:!1,businessId:null,role:null,status:null,loading:!1});return}try{if(r){const d=It(ke(oe,r.id,"main","users"),Ei("userId","==",e.uid)),m=await st(d);if(!m.empty){const p=m.docs[0].data(),x=p.status==="active";i({isApproved:x,businessId:r.id,role:p.role,status:p.status,loading:!1});return}}const u=await st(ke(oe,"business_registry"));for(const d of u.docs){const m=d.id,p=It(ke(oe,m,"main","users"),Ei("userId","==",e.uid)),x=await st(p);if(!x.empty){const j=x.docs[0].data(),I=j.status==="active";i({isApproved:I,businessId:m,role:j.role,status:j.status,loading:!1});return}}i({isApproved:!1,businessId:null,role:null,status:null,loading:!1})}catch(u){console.error("Error checking user approval:",u),u.code==="resource-exhausted"||(c=u.message)!=null&&c.includes("quota")?(console.log("Firebase quota exceeded, allowing access for testing"),i({isApproved:!0,businessId:(r==null?void 0:r.id)||null,role:"sales_rep",status:"active",loading:!1})):i({isApproved:!1,businessId:null,role:null,status:null,loading:!1})}};_.useEffect(()=>{a()},[e,r]);const o={approvalStatus:n,checkUserApproval:a};return s.jsx(kN.Provider,{value:o,children:t})},WA=[{name:"admin",description:"Full system access and administrative privileges",canApproveOrders:!0,canApproveCredit:!0,canApproveTransfers:!0,maxApprovalAmount:1e7,requiresSecondaryApproval:!1,secondaryApprovalAmount:0,isActive:!0},{name:"Business Owner",description:"Oversees all business operations and has final approval authority",canApproveOrders:!0,canApproveCredit:!0,canApproveTransfers:!0,maxApprovalAmount:1e7,requiresSecondaryApproval:!1,secondaryApprovalAmount:0,isActive:!0},{name:"sales_rep",description:"Handles customer sales and order processing",canApproveOrders:!0,canApproveCredit:!1,canApproveTransfers:!1,maxApprovalAmount:1e6,requiresSecondaryApproval:!0,secondaryApprovalAmount:5e5,isActive:!0}],IN=_.createContext(void 0),na=()=>{const t=_.useContext(IN);if(t===void 0)throw new Error("useUserManagement must be used within a UserManagementProvider");return t},HA=({children:t})=>{const{currentBusiness:e}=$t(),{currentUser:r}=Ar(),[n,i]=_.useState([]),[a,o]=_.useState([]),[c,u]=_.useState([]),[d,m]=_.useState(!1),[p,x]=_.useState(!1),[j,I]=_.useState(!1),[b,R]=_.useState(!1),[v,y]=_.useState(!1),[f,E]=_.useState(!1),[P,F]=_.useState(!1),[N,w]=_.useState(null),T=_.useCallback(async()=>{if(e){m(!0);try{w(null);const M=ke(oe,e.id,"main","approval_roles"),V=It(M,_r("createdAt","desc")),K=(await st(V)).docs.map(X=>{var Q,ie,ye,_e,Ue,ur;return{id:X.id,...X.data(),createdAt:((ye=(ie=(Q=X.data().createdAt)==null?void 0:Q.toDate)==null?void 0:ie.call(Q))==null?void 0:ye.toISOString())||X.data().createdAt,updatedAt:((ur=(Ue=(_e=X.data().updatedAt)==null?void 0:_e.toDate)==null?void 0:Ue.call(_e))==null?void 0:ur.toISOString())||X.data().updatedAt}});i(K),R(!0)}catch(M){console.error("Error fetching approval roles:",M),w(M.message||"Failed to fetch approval roles")}finally{m(!1)}}},[e]),A=_.useCallback(async()=>{if(e){x(!0);try{w(null);const M=ke(oe,e.id,"main","approval_users"),V=It(M,_r("assignedAt","desc")),K=(await st(V)).docs.map(X=>{var Q,ie,ye;return{id:X.id,...X.data(),assignedAt:((ye=(ie=(Q=X.data().assignedAt)==null?void 0:Q.toDate)==null?void 0:ie.call(Q))==null?void 0:ye.toISOString())||X.data().assignedAt}});o(K),y(!0)}catch(M){console.error("Error fetching approval users:",M),w(M.message||"Failed to fetch approval users")}finally{x(!1)}}},[e]),D=_.useCallback(async()=>{if(e){I(!0);try{w(null);const M=ke(oe,e.id,"main","users"),V=It(M,_r("joinedAt","desc")),K=(await st(V)).docs.map(X=>{var ie,ye,_e;const Q=X.data();return{id:X.id,userId:Q.userId||Q.uid||"",userName:Q.userName||Q.displayName||Q.firstName+" "+Q.lastName||Q.email||"Unknown User",userEmail:Q.userEmail||Q.email||"",role:Q.role||"",status:Q.status||"active",joinedAt:((_e=(ye=(ie=Q.joinedAt)==null?void 0:ie.toDate)==null?void 0:ye.call(ie))==null?void 0:_e.toISOString())||Q.joinedAt||new Date().toISOString(),invitedBy:Q.invitedBy||""}});u(K),E(!0)}catch(M){console.error("Error fetching business users:",M),w(M.message||"Failed to fetch business users")}finally{I(!1)}}},[e]);_.useEffect(()=>{F(!1)},[e]),_.useEffect(()=>{e&&!b&&(console.log("Fetching approval roles..."),T())},[e,b,T]),_.useEffect(()=>{e&&!v&&(console.log("Fetching approval users..."),A())},[e,v,A]),_.useEffect(()=>{e&&!f&&(console.log("Fetching business users..."),D())},[e,f,D]);const C=_.useCallback(async()=>{if(!(!e||n.length>0||P))try{F(!0),m(!0);const M=P0(oe),V=ke(oe,e.id,"main","approval_roles");for(const z of WA){const K=Re(V);M.set(K,{...z,createdAt:Be(),updatedAt:Be()})}await M.commit(),console.log("Default approval roles created"),await T()}catch(M){console.error("Error creating default approval roles:",M),w(M.message||"Failed to create default approval roles"),F(!1)}finally{m(!1)}},[e,n.length,P,T]);_.useEffect(()=>{e&&b&&n.length===0&&!P&&(console.log("Creating default approval roles..."),C())},[e,b,n.length,P,C]);const S=async M=>{if(!e||!r)throw new Error("No business or user selected");try{w(null);const V={...M,createdAt:Be(),updatedAt:Be()};Object.keys(V).forEach(Q=>{V[Q]===void 0&&delete V[Q]});const z=ke(oe,e.id,"main","approval_roles"),K=await ss(z,V),X={id:K.id,...M,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return i(Q=>[X,...Q]),K.id}catch(V){throw console.error("Error creating approval role:",V),w(V.message||"Failed to create approval role"),V}},H=async(M,V)=>{if(!e)throw new Error("No business selected");try{w(null);const z=Re(oe,e.id,"main","approval_roles",M),K={...V,updatedAt:Be()};Object.keys(K).forEach(X=>{K[X]===void 0&&delete K[X]}),await rs(z,K),i(X=>X.map(Q=>Q.id===M?{...Q,...V,updatedAt:new Date().toISOString()}:Q))}catch(z){throw console.error("Error updating approval role:",z),w(z.message||"Failed to update approval role"),z}},W=async M=>{if(!e)throw new Error("No business selected");try{w(null);const V=Re(oe,e.id,"main","approval_roles",M);await Ln(V),i(z=>z.filter(K=>K.id!==M)),o(z=>z.filter(K=>K.roleId!==M))}catch(V){throw console.error("Error deleting approval role:",V),w(V.message||"Failed to delete approval role"),V}},re=async M=>{if(!e||!r)throw new Error("No business or user selected");try{w(null);const V={...M,assignedBy:r.uid,assignedAt:Be()};Object.keys(V).forEach(Q=>{V[Q]===void 0&&delete V[Q]});const z=ke(oe,e.id,"main","approval_users"),K=await ss(z,V),X={id:K.id,...M,assignedBy:r.uid,assignedAt:new Date().toISOString()};return o(Q=>[X,...Q]),K.id}catch(V){throw console.error("Error assigning user to role:",V),w(V.message||"Failed to assign user to role"),V}},ce=async(M,V)=>{if(!e)throw new Error("No business selected");try{w(null);const z=Re(oe,e.id,"main","approval_users",M),K={...V};Object.keys(K).forEach(X=>{K[X]===void 0&&delete K[X]}),await rs(z,K),o(X=>X.map(Q=>Q.id===M?{...Q,...V}:Q))}catch(z){throw console.error("Error updating approval user:",z),w(z.message||"Failed to update approval user"),z}},O=async M=>{if(!e)throw new Error("No business selected");try{w(null);const V=Re(oe,e.id,"main","approval_users",M);await Ln(V),o(z=>z.filter(K=>K.id!==M))}catch(V){throw console.error("Error removing approval user:",V),w(V.message||"Failed to remove approval user"),V}},L=_.useCallback(M=>c.find(V=>V.userId===M),[c]),U={approvalRoles:n,rolesLoading:d,approvalUsers:a,usersLoading:p,businessUsers:c,businessUsersLoading:j,error:N,fetchApprovalRoles:T,createApprovalRole:S,updateApprovalRole:H,deleteApprovalRole:W,fetchApprovalUsers:A,assignUserToRole:re,updateApprovalUser:ce,removeApprovalUser:O,fetchBusinessUsers:D,getBusinessUserById:L,_initializeDefaultRolePermissions:async()=>{if(e)try{console.log("Initializing default role permissions...");const M=ke(oe,e.id,"main","role_permissions");if(!(await st(M)).empty){console.log("Role permissions already exist");return}const z=P0(oe),K={admin:{role:"admin",permissions:["view_dashboard","view_orders","create_orders","edit_orders","approve_orders","delete_orders","view_inventory","manage_inventory","view_stores","manage_stores","manage_transfers","view_customers","manage_customers","view_customer_accounts","manage_credit","view_sales","create_sales","view_reports","view_financial_reports","view_settings","manage_users","manage_system","view_approvals"],menuItems:["dashboard","orders","inventory","customers","sales","delivery","invoicing","reports","settings","help"],canAccessSettings:!0,canManageUsers:!0,canViewReports:!0,canManageInventory:!0,canManageOrders:!0,canManageCustomers:!0,createdAt:Be(),updatedAt:Be()},business_owner:{role:"business_owner",permissions:["view_dashboard","view_orders","create_orders","edit_orders","approve_orders","delete_orders","view_inventory","manage_inventory","view_stores","manage_stores","manage_transfers","view_customers","manage_customers","view_customer_accounts","manage_credit","view_sales","create_sales","view_reports","view_financial_reports","view_settings","manage_users","manage_system","view_approvals"],menuItems:["dashboard","orders","inventory","customers","sales","delivery","invoicing","reports","settings","help"],canAccessSettings:!0,canManageUsers:!0,canViewReports:!0,canManageInventory:!0,canManageOrders:!0,canManageCustomers:!0,createdAt:Be(),updatedAt:Be()},sales_rep:{role:"sales_rep",permissions:["view_dashboard","view_orders","create_orders","edit_orders","view_customers","manage_customers","view_sales","create_sales","view_inventory"],menuItems:["dashboard","orders","customers","sales","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!0,canManageCustomers:!0,createdAt:Be(),updatedAt:Be()},inventory_manager:{role:"inventory_manager",permissions:["view_dashboard","view_inventory","manage_inventory","view_stores","manage_stores","manage_transfers","view_orders","view_customers"],menuItems:["dashboard","inventory","orders","customers","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!0,canManageOrders:!1,canManageCustomers:!1,createdAt:Be(),updatedAt:Be()},packer:{role:"packer",permissions:["view_dashboard","view_orders","edit_orders","prepare_orders","view_inventory","view_delivery","manage_delivery","view_settings"],menuItems:["dashboard","orders","preparation","delivery","settings","help"],canAccessSettings:!0,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!0,canManageCustomers:!1,createdAt:Be(),updatedAt:Be()},accountant:{role:"accountant",permissions:["view_dashboard","view_orders","view_customers","view_sales","view_reports","view_financial_reports","view_inventory"],menuItems:["dashboard","orders","customers","sales","reports","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!0,canManageInventory:!1,canManageOrders:!1,canManageCustomers:!1,createdAt:Be(),updatedAt:Be()},customer:{role:"customer",permissions:["view_dashboard","view_orders"],menuItems:["dashboard","orders","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!1,canManageCustomers:!1,createdAt:Be(),updatedAt:Be()}};for(const[,X]of Object.entries(K)){const Q=Re(M);z.set(Q,X)}await z.commit(),console.log("Default role permissions initialized")}catch(M){console.error("Error initializing role permissions:",M)}}};return s.jsx(IN.Provider,{value:U,children:t})},tp=_.createContext(void 0),ia=()=>{const t=_.useContext(tp);if(!t)throw new Error("useCustomer must be used within a CustomerProvider");return t},KA=({children:t})=>{const{currentBusiness:e}=$t(),[r,n]=_.useState([]),[i,a]=_.useState(!1),[o,c]=_.useState(null);_.useEffect(()=>{e!=null&&e.id?u():n([])},[e==null?void 0:e.id]);const u=_.useCallback(async()=>{var y,f,E;if(e)try{a(!0),c(null);const P=ke(oe,e.id,"main","customers"),F=It(P,_r("createdAt","desc")),w=(await st(F)).docs.map(T=>({id:T.id,...T.data()}));n(w)}catch(P){if(console.error("Error fetching customers:",P),P.code==="resource-exhausted"||(y=P.message)!=null&&y.includes("quota")?(c("Firebase quota exceeded. Please wait for quota reset or upgrade your plan."),n([])):c(P.message||"Failed to fetch customers"),(f=P.message)!=null&&f.includes("BLOCKED_BY_CLIENT")||(E=P.message)!=null&&E.includes("ERR_BLOCKED_BY_CLIENT")){console.log("Firebase blocked, using mock customers for testing");const F=[{id:"mock-customer-1",firstName:"John",lastName:"Doe",email:"john.doe@example.com",phone:"+1234567890",address:"123 Main St",city:"New York",creditLimit:5e3,creditUsed:1200,isActive:!0,notes:"Test customer",registrationDate:new Date().toISOString(),totalOrders:5,totalSpent:1250},{id:"mock-customer-2",firstName:"Jane",lastName:"Smith",email:"jane.smith@example.com",phone:"+0987654321",address:"456 Oak Ave",city:"Los Angeles",creditLimit:3e3,creditUsed:2800,isActive:!0,notes:"Premium customer",registrationDate:new Date().toISOString(),totalOrders:8,totalSpent:2500}];n(F)}}finally{a(!1)}},[e==null?void 0:e.id]),d=async y=>{if(!e)throw new Error("No business selected");try{c(null);const f=ke(oe,e.id,"main","customers"),P={id:(await ss(f,{...y,createdAt:new Date,updatedAt:new Date})).id,...y};n(F=>[P,...F])}catch(f){throw console.error("Error adding customer:",f),c(f.message||"Failed to add customer"),f}},m=async(y,f)=>{if(!e)throw new Error("No business selected");try{c(null);const E=Re(oe,e.id,"main","customers",y);await rs(E,{...f,updatedAt:new Date}),n(P=>P.map(F=>F.id===y?{...F,...f}:F))}catch(E){throw console.error("Error updating customer:",E),c(E.message||"Failed to update customer"),E}},p=async y=>{if(!e)throw new Error("No business selected");try{c(null);const f=Re(oe,e.id,"main","customers",y);await Ln(f),n(E=>E.filter(P=>P.id!==y))}catch(f){throw console.error("Error deleting customer:",f),c(f.message||"Failed to delete customer"),f}},x=y=>r.find(f=>f.id===y),v={customers:r,loading:i,error:o,addCustomer:d,updateCustomer:m,deleteCustomer:p,fetchCustomers:u,getCustomerById:x,searchCustomers:y=>{if(!y.trim())return r;const f=y.toLowerCase();return r.filter(E=>E.firstName.toLowerCase().includes(f)||E.lastName.toLowerCase().includes(f)||E.email.toLowerCase().includes(f)||E.phone.includes(f)||E.address.toLowerCase().includes(f))},getCustomersByCreditStatus:y=>r.filter(f=>{if(y==="cash-only")return f.creditLimit===0;if(f.creditLimit===0)return!1;const E=f.creditUsed/f.creditLimit*100;switch(y){case"good":return E<70;case"warning":return E>=70&&E<90;case"high-risk":return E>=90;default:return!1}}),addCustomerTransaction:async(y,f)=>{if(!e)throw new Error("No business selected");const E=x(y);if(!E)throw new Error("Customer not found");const P=f.type==="invoice",F=f.type==="payment"||f.type==="refund"||f.type==="credit-adjustment";let N=E.creditUsed;P&&(N+=f.amount),F&&(N=Math.max(0,N-f.amount));const w=ke(oe,e.id,"main","customers",y,"transactions");await ss(w,{type:f.type,amount:f.amount,reference:f.reference||null,note:f.note||null,createdAt:Be()}),await m(y,{creditUsed:N,totalSpent:P?E.totalSpent+f.amount:E.totalSpent,updatedAt:new Date().toISOString()})},fetchCustomerTransactions:async y=>{if(!e)return[];const f=ke(oe,e.id,"main","customers",y,"transactions"),E=It(f,_r("createdAt","desc"));return(await st(E)).docs.map(F=>({id:F.id,...F.data()}))}};return s.jsx(tp.Provider,{value:v,children:t})},GA=()=>{const t=_.useContext(tp);if(!t)throw new Error("useCustomers must be used within a CustomerProvider");return t},TN=_.createContext(void 0),zt=()=>{const t=_.useContext(TN);if(!t)throw new Error("useInventory must be used within an InventoryProvider");return t},QA=({children:t})=>{const{currentBusiness:e}=$t(),[r,n]=_.useState([]),[i,a]=_.useState(!1),[o,c]=_.useState([]),[u,d]=_.useState(!1),[m,p]=_.useState([]),[x,j]=_.useState(!1),[I,b]=_.useState([]),[R,v]=_.useState(!1),[y,f]=_.useState(null);_.useEffect(()=>{e?(E(),T(),H(),O()):(n([]),c([]),p([]),b([]))},[e==null?void 0:e.id]);const E=_.useCallback(async()=>{var V;if(e)try{a(!0),f(null);const z=ke(oe,e.id,"main","products"),K=It(z,_r("createdAt","desc")),Q=(await st(K)).docs.map(ie=>({id:ie.id,...ie.data()}));n(Q)}catch(z){console.error("Error fetching products:",z),z.code==="resource-exhausted"||(V=z.message)!=null&&V.includes("quota")?(f("Firebase quota exceeded. Please wait for quota reset or upgrade your plan."),n([])):f(z.message||"Failed to fetch products")}finally{a(!1)}},[e==null?void 0:e.id]),P=async(V,z)=>{if(!e)throw new Error("No business selected");try{f(null);const K=ke(oe,e.id,"main","products"),X={...V,createdAt:new Date,updatedAt:new Date};Object.keys(X).forEach(ye=>{X[ye]===void 0&&delete X[ye]});const Q=await ss(K,X);if(z&&z.length>0){const ye=ke(oe,e.id,"main","stock");for(const _e of z)_e.quantity>0&&await ss(ye,{productId:Q.id,storeId:_e.storeId,currentStock:_e.quantity,reservedStock:0,availableStock:_e.quantity,lastUpdated:new Date().toISOString(),createdAt:new Date,updatedAt:new Date})}const ie={id:Q.id,...V};n(ye=>[ie,...ye]),z&&z.length>0&&H()}catch(K){throw console.error("Error adding product:",K),f(K.message||"Failed to add product"),K}},F=async(V,z)=>{if(!e)throw new Error("No business selected");try{f(null);const K=Re(oe,e.id,"main","products",V),X={...z,updatedAt:new Date};Object.keys(X).forEach(Q=>{X[Q]===void 0&&delete X[Q]}),await rs(K,X),n(Q=>Q.map(ie=>ie.id===V?{...ie,...z}:ie))}catch(K){throw console.error("Error updating product:",K),f(K.message||"Failed to update product"),K}},N=async V=>{if(!e)throw new Error("No business selected");try{f(null);const z=Re(oe,e.id,"main","products",V);await Ln(z),n(K=>K.filter(X=>X.id!==V))}catch(z){throw console.error("Error deleting product:",z),f(z.message||"Failed to delete product"),z}},w=_.useCallback(V=>r.find(z=>z.id===V),[r]),T=_.useCallback(async()=>{if(e)try{d(!0),f(null);const V=ke(oe,e.id,"main","stores"),z=It(V,_r("createdAt","desc")),X=(await st(z)).docs.map(Q=>({id:Q.id,...Q.data()}));c(X)}catch(V){console.error("Error fetching stores:",V),f(V.message||"Failed to fetch stores")}finally{d(!1)}},[e==null?void 0:e.id]),A=async V=>{if(!e)throw new Error("No business selected");try{f(null);const z=ke(oe,e.id,"main","stores"),X={id:(await ss(z,{...V,createdAt:new Date,updatedAt:new Date})).id,...V};c(Q=>[X,...Q])}catch(z){throw console.error("Error adding store:",z),f(z.message||"Failed to add store"),z}},D=async(V,z)=>{if(!e)throw new Error("No business selected");try{f(null);const K=Re(oe,e.id,"main","stores",V);await rs(K,{...z,updatedAt:new Date}),c(X=>X.map(Q=>Q.id===V?{...Q,...z}:Q))}catch(K){throw console.error("Error updating store:",K),f(K.message||"Failed to update store"),K}},C=async V=>{if(!e)throw new Error("No business selected");try{f(null);const z=Re(oe,e.id,"main","stores",V);await Ln(z),c(K=>K.filter(X=>X.id!==V))}catch(z){throw console.error("Error deleting store:",z),f(z.message||"Failed to delete store"),z}},S=V=>o.find(z=>z.id===V),H=_.useCallback(async V=>{if(e)try{j(!0),f(null);const z=ke(oe,e.id,"main","stock");let K=It(z,_r("lastUpdated","desc"));V&&(K=It(z,Ei("storeId","==",V),_r("lastUpdated","desc")));const Q=(await st(K)).docs.map(ie=>({id:ie.id,...ie.data()}));p(Q)}catch(z){console.error("Error fetching stock:",z),f(z.message||"Failed to fetch stock")}finally{j(!1)}},[e==null?void 0:e.id]),W=async(V,z)=>{if(!e)throw new Error("No business selected");try{f(null);const K=Re(oe,e.id,"main","stock",V);await rs(K,{...z,lastUpdated:new Date().toISOString(),updatedAt:new Date}),p(X=>X.map(Q=>Q.id===V?{...Q,...z}:Q))}catch(K){throw console.error("Error updating stock:",K),f(K.message||"Failed to update stock"),K}},re=(V,z)=>m.filter(K=>{const X=K.productId===V,Q=!z||K.storeId===z;return X&&Q}),ce=V=>m.filter(z=>{if(!(!V||z.storeId===V))return!1;const X=w(z.productId);return X?z.currentStock<=X.minStockLevel:!1}),O=_.useCallback(async()=>{if(e)try{v(!0),f(null);const V=ke(oe,e.id,"main","transfers"),z=It(V,_r("createdAt","desc")),X=(await st(z)).docs.map(Q=>({id:Q.id,...Q.data()}));b(X)}catch(V){console.error("Error fetching transfers:",V),f(V.message||"Failed to fetch transfers")}finally{v(!1)}},[e==null?void 0:e.id]),M={products:r,productsLoading:i,addProduct:P,updateProduct:F,deleteProduct:N,fetchProducts:E,getProductById:w,stores:o,storesLoading:u,addStore:A,updateStore:D,deleteStore:C,fetchStores:T,getStoreById:S,stockItems:m,stockLoading:x,fetchStock:H,updateStock:W,getStockByProduct:re,getLowStockItems:ce,transfers:I,transfersLoading:R,fetchTransfers:O,createTransfer:async V=>{if(!e)throw new Error("No business selected");try{f(null);const z=ke(oe,e.id,"main","transfers"),X={id:(await ss(z,{...V,createdAt:new Date,updatedAt:new Date})).id,...V};b(Q=>[X,...Q])}catch(z){throw console.error("Error creating transfer:",z),f(z.message||"Failed to create transfer"),z}},updateTransferStatus:async(V,z,K)=>{if(!e)throw new Error("No business selected");try{f(null);const X=Re(oe,e.id,"main","transfers",V),Q={status:z,updatedAt:new Date};if(K&&(Q.approvedBy=K,Q.approvedAt=new Date().toISOString()),z==="completed"&&(Q.completedAt=new Date().toISOString()),await rs(X,Q),z==="completed"){const ie=I.find(ye=>ye.id===V);if(ie){const ye=m.find(Ue=>Ue.storeId===ie.fromStoreId&&Ue.productId===ie.productId);ye!=null&&ye.id&&await W(ye.id,{currentStock:Math.max(0,ye.currentStock-ie.quantity),availableStock:Math.max(0,(ye.availableStock??ye.currentStock)-ie.quantity)});const _e=m.find(Ue=>Ue.storeId===ie.toStoreId&&Ue.productId===ie.productId);_e!=null&&_e.id&&await W(_e.id,{currentStock:_e.currentStock+ie.quantity,availableStock:(_e.availableStock??_e.currentStock)+ie.quantity})}}b(ie=>ie.map(ye=>ye.id===V?{...ye,...Q}:ye))}catch(X){throw console.error("Error updating transfer status:",X),f(X.message||"Failed to update transfer status"),X}},error:y};return s.jsx(TN.Provider,{value:M,children:t})},AN=_.createContext(void 0),Hn=()=>{const t=_.useContext(AN);if(t===void 0)throw new Error("useOrders must be used within an OrderProvider");return t},YA=({children:t})=>{const{currentBusiness:e}=$t(),{currentUser:r}=Ar(),{addCustomerTransaction:n}=ia(),{stockItems:i,updateStock:a}=zt(),[o,c]=_.useState([]),[u,d]=_.useState(!1),[m,p]=_.useState(null),[x,j]=_.useState(!1),I=async(C,S)=>{if(a)for(const H of C){const W=i.find(re=>re.productId===H.productId&&re.storeId===H.storeId);if(W!=null&&W.id){let re=W.availableStock||W.currentStock,ce=W.currentStock;switch(S){case"reserve":re=Math.max(0,re-H.quantity);break;case"deduct":re=Math.max(0,re-H.quantity),ce=Math.max(0,ce-H.quantity);break;case"restore":re=re+H.quantity,ce=ce+H.quantity;break}try{await a(W.id,{availableStock:re,currentStock:ce})}catch(O){console.error(`Failed to update stock for product ${H.productId}:`,O)}}}},b=_.useCallback(async()=>{var C;if(e){d(!0);try{p(null);const S=ke(oe,e.id,"main","orders"),H=It(S,_r("createdAt","desc")),re=(await st(H)).docs.map(ce=>{var L,U,M,V,z,K,X,Q,ie,ye,_e,Ue,ur;const O=ce.data();return{id:ce.id,...O,itemsCount:((L=O.items)==null?void 0:L.length)||0,createdAt:((V=(M=(U=O.createdAt)==null?void 0:U.toDate)==null?void 0:M.call(U))==null?void 0:V.toISOString())||O.createdAt,updatedAt:((X=(K=(z=O.updatedAt)==null?void 0:z.toDate)==null?void 0:K.call(z))==null?void 0:X.toISOString())||O.updatedAt,orderDate:((ye=(ie=(Q=O.orderDate)==null?void 0:Q.toDate)==null?void 0:ie.call(Q))==null?void 0:ye.toISOString())||O.orderDate,approvedAt:((ur=(Ue=(_e=O.approvedAt)==null?void 0:_e.toDate)==null?void 0:Ue.call(_e))==null?void 0:ur.toISOString())||O.approvedAt}});c(re),j(!0)}catch(S){console.error("Error fetching orders:",S),S.code==="resource-exhausted"||(C=S.message)!=null&&C.includes("quota")?(p("Firebase quota exceeded. Please wait for quota reset or upgrade your plan."),c([])):p(S.message||"Failed to fetch orders")}finally{d(!1)}}},[e]);_.useEffect(()=>{e&&!x&&b()},[e,x,b]);const R=async C=>{var S,H;if(!e||!r)throw new Error("No business or user selected");try{p(null);const W=`ORD-${Date.now().toString().slice(-6)}`,re={...C,orderNumber:W,createdBy:r.uid,createdAt:Be(),updatedAt:Be()};Object.keys(re).forEach(U=>{re[U]===void 0&&delete re[U]});const ce=ke(oe,e.id,"main","orders"),O=await ss(ce,re),L={id:O.id,...C,orderNumber:C.orderNumber,itemsCount:C.items.length,createdBy:r.uid,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};try{await I(C.items,"reserve")}catch(U){console.error("Failed to reserve stock:",U)}if(C.paymentType==="credit")try{await n(C.customerId,{type:"invoice",amount:C.totalAmount,reference:`Order ${W}`,note:`Credit order for ${C.totalAmount}`})}catch(U){console.error("Failed to update customer credit:",U)}return c(U=>[L,...U]),O.id}catch(W){if(console.error("Error creating order:",W),(S=W.message)!=null&&S.includes("BLOCKED_BY_CLIENT")||(H=W.message)!=null&&H.includes("ERR_BLOCKED_BY_CLIENT")){console.log("Firebase blocked, creating mock order");const re=`mock-order-${Date.now()}`,ce={id:re,...C,orderNumber:`ORD-${Date.now().toString().slice(-6)}`,itemsCount:C.items.length,createdBy:(r==null?void 0:r.uid)||"mock-user",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};try{await I(C.items,"reserve")}catch(O){console.error("Failed to reserve stock:",O)}if(C.paymentType==="credit")try{await n(C.customerId,{type:"invoice",amount:C.totalAmount,reference:`Order ${C.orderNumber}`,note:`Credit order for ${C.totalAmount}`})}catch(O){console.error("Failed to update customer credit:",O)}return c(O=>[ce,...O]),p(null),re}throw p(W.message||"Failed to create order"),W}},v=async(C,S)=>{if(!e)throw new Error("No business selected");try{p(null),console.log(`OrderContext: updateOrder called for ${C} with updates:`,S);const H=Re(oe,e.id,"main","orders",C),W={...S,updatedAt:Be()};Object.keys(W).forEach(re=>{W[re]===void 0&&delete W[re]}),console.log("OrderContext: Updating Firestore with payload:",W),await rs(H,W),console.log(`OrderContext: Firestore update successful for ${C}`),c(re=>re.map(ce=>ce.id===C?{...ce,...S,updatedAt:new Date().toISOString()}:ce)),console.log(`OrderContext: Local state updated for ${C}`)}catch(H){throw console.error("Error updating order:",H),p(H.message||"Failed to update order"),H}},y=async C=>{if(!e)throw new Error("No business selected");try{p(null);const S=o.find(W=>W.id===C),H=Re(oe,e.id,"main","orders",C);if(await Ln(H),S)try{await I(S.items,"restore")}catch(W){console.error("Failed to restore stock:",W)}if(S&&S.paymentType==="credit")try{await n(S.customerId,{type:"refund",amount:S.totalAmount,reference:`Order ${S.orderNumber} (Cancelled)`,note:"Refund for cancelled credit order"})}catch(W){console.error("Failed to refund customer credit:",W)}c(W=>W.filter(re=>re.id!==C))}catch(S){throw console.error("Error deleting order:",S),p(S.message||"Failed to delete order"),S}},f=_.useCallback(C=>o.find(S=>S.id===C),[o]),D={orders:o,ordersLoading:u,error:m,fetchOrders:b,createOrder:R,updateOrder:v,deleteOrder:y,getOrderById:f,approveOrder:async(C,S)=>{if(!r)throw new Error("No user authenticated");const H=o.find(W=>W.id===C);if(!H)throw new Error("Order not found");if(!H.assignedPacker)throw new Error("Cannot approve order: No packer assigned");if(!H.deliveryMethod)throw new Error("Cannot approve order: No delivery method selected");if(H.deliveryMethod!=="customer_pickup"&&!H.deliveryAddress)throw new Error("Cannot approve order: Delivery address required for non-pickup orders");try{await I(H.items,"deduct")}catch(W){console.error("Failed to deduct stock:",W)}await v(C,{status:"approved",approvedBy:S,approvedAt:new Date().toISOString()})},updateOrderStatus:async(C,S)=>{const H=o.find(W=>W.id===C);if(!H)throw new Error("Order not found");if(S==="cancelled")try{await I(H.items,"restore")}catch(W){console.error("Failed to restore stock:",W)}await v(C,{status:S})},updatePaymentStatus:async(C,S)=>{await v(C,{paymentStatus:S})},markOrderAsPrepared:async(C,S)=>{if(!r)throw new Error("No user authenticated");const H=o.find(W=>W.id===C);if(!H)throw new Error("Order not found");if(H.status!=="approved")throw new Error("Only approved orders can be prepared");await v(C,{status:"processing",preparedBy:r.uid,preparedAt:new Date().toISOString()})},updatePackerStatus:async(C,S)=>{if(!r)throw new Error("No user authenticated");const H=o.find(W=>W.id===C);if(!H)throw new Error("Order not found");if(console.log(`OrderContext: Updating order ${C} from ${H.status} to ${S}`),H.status==="handed_to_delivery"&&S!=="transported")throw new Error('Cannot go backward from "Handed to Delivery"');if(H.status==="transported")throw new Error("Order is already completed and cannot be changed");try{await v(C,{status:S,preparedBy:r.uid,preparedAt:new Date().toISOString()}),console.log(`OrderContext: Successfully updated order ${C} to ${S}`)}catch(W){throw console.error(`OrderContext: Failed to update order ${C}:`,W),W}},updateTransporterDetails:async(C,S)=>{if(!r)throw new Error("No user authenticated");if(!o.find(W=>W.id===C))throw new Error("Order not found");try{await v(C,{transporterDetails:S,preparedBy:r.uid,preparedAt:new Date().toISOString()}),console.log(`OrderContext: Successfully updated transporter details for order ${C}`)}catch(W){throw console.error(`OrderContext: Failed to update transporter details for order ${C}:`,W),W}},updateCargoReceipt:async(C,S)=>{if(!r)throw new Error("No user authenticated");if(!o.find(W=>W.id===C))throw new Error("Order not found");try{await v(C,{cargoReceipt:S,status:"transported",preparedBy:r.uid,preparedAt:new Date().toISOString()}),console.log(`OrderContext: Successfully updated cargo receipt for order ${C}`)}catch(W){throw console.error(`OrderContext: Failed to update cargo receipt for order ${C}:`,W),W}}};return s.jsx(AN.Provider,{value:D,children:t})},PN=_.createContext({}),aa=()=>{const t=_.useContext(PN);if(!t)throw new Error("useRole must be used within a RoleProvider");return t},um=[{id:"view_dashboard",name:"View Dashboard",description:"Access to main dashboard",category:"Dashboard"},{id:"view_orders",name:"View Orders",description:"View order list and details",category:"Orders"},{id:"create_orders",name:"Create Orders",description:"Create new orders",category:"Orders"},{id:"edit_orders",name:"Edit Orders",description:"Modify existing orders",category:"Orders"},{id:"approve_orders",name:"Approve Orders",description:"Approve pending orders",category:"Orders"},{id:"delete_orders",name:"Delete Orders",description:"Delete orders",category:"Orders"},{id:"view_inventory",name:"View Inventory",description:"View inventory items",category:"Inventory"},{id:"manage_inventory",name:"Manage Inventory",description:"Add, edit, delete inventory items",category:"Inventory"},{id:"view_stores",name:"View Stores",description:"View store information",category:"Inventory"},{id:"manage_stores",name:"Manage Stores",description:"Add, edit, delete stores",category:"Inventory"},{id:"manage_transfers",name:"Manage Transfers",description:"Handle inventory transfers",category:"Inventory"},{id:"view_customers",name:"View Customers",description:"View customer list and details",category:"Customers"},{id:"manage_customers",name:"Manage Customers",description:"Add, edit, delete customers",category:"Customers"},{id:"view_customer_accounts",name:"View Customer Accounts",description:"View customer account balances",category:"Customers"},{id:"manage_credit",name:"Manage Credit",description:"Manage customer credit limits",category:"Customers"},{id:"view_sales",name:"View Sales",description:"View sales data and reports",category:"Sales"},{id:"create_sales",name:"Create Sales",description:"Create new sales",category:"Sales"},{id:"view_reports",name:"View Reports",description:"Access to reports section",category:"Reports"},{id:"view_financial_reports",name:"View Financial Reports",description:"Access financial reports",category:"Reports"},{id:"view_settings",name:"View Settings",description:"Access settings page",category:"Settings"},{id:"manage_users",name:"Manage Users",description:"Manage user accounts and permissions",category:"Settings"},{id:"manage_system",name:"Manage System",description:"System configuration and settings",category:"Settings"},{id:"view_approvals",name:"View Approvals",description:"View pending approvals",category:"Settings"}],R0={admin:{role:"admin",permissions:um.map(t=>t.id),menuItems:["dashboard","orders","inventory","customers","sales","delivery","invoicing","reports","settings","help"],canAccessSettings:!0,canManageUsers:!0,canViewReports:!0,canManageInventory:!0,canManageOrders:!0,canManageCustomers:!0},business_owner:{role:"business_owner",permissions:um.map(t=>t.id),menuItems:["dashboard","orders","inventory","customers","sales","delivery","invoicing","reports","settings","help"],canAccessSettings:!0,canManageUsers:!0,canViewReports:!0,canManageInventory:!0,canManageOrders:!0,canManageCustomers:!0},sales_rep:{role:"sales_rep",permissions:["view_dashboard","view_orders","create_orders","edit_orders","view_customers","manage_customers","view_sales","create_sales","view_inventory"],menuItems:["dashboard","orders","customers","sales","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!0,canManageCustomers:!0},inventory_manager:{role:"inventory_manager",permissions:["view_dashboard","view_inventory","manage_inventory","view_stores","manage_stores","manage_transfers","view_orders","view_customers"],menuItems:["dashboard","inventory","orders","customers","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!0,canManageOrders:!1,canManageCustomers:!1},packer:{role:"packer",permissions:["view_dashboard","view_orders","edit_orders","prepare_orders","view_inventory","view_delivery","manage_delivery","view_settings"],menuItems:["dashboard","orders","preparation","delivery","settings","help"],canAccessSettings:!0,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!0,canManageCustomers:!1},accountant:{role:"accountant",permissions:["view_dashboard","view_orders","view_customers","view_sales","view_reports","view_financial_reports","view_inventory"],menuItems:["dashboard","orders","customers","sales","reports","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!0,canManageInventory:!1,canManageOrders:!1,canManageCustomers:!1},customer:{role:"customer",permissions:["view_dashboard","view_orders"],menuItems:["dashboard","orders","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!1,canManageCustomers:!1}},JA=({children:t})=>{const{currentUser:e}=Ar(),{approvalStatus:r}=Lu(),[n,i]=_.useState(null),[a,o]=_.useState(!0);_.useEffect(()=>{if(e&&r.role&&!r.loading){const I=r.role.toLowerCase(),b=R0[I]||R0.customer;i(b),o(!1)}else e||(i(null),o(!1))},[e,r.role,r.loading]);const c=async(I,b)=>{console.log("Updating permissions for user:",I,b)},u=I=>n?n.permissions.includes(I):!1,d=I=>n?I.some(b=>n.permissions.includes(b)):!1,m=I=>n?I.every(b=>n.permissions.includes(b)):!1,p=I=>n?n.menuItems.includes(I):!1,x=I=>{if(!n)return!1;const R={dashboard:["view_dashboard"],orders:["view_orders"],inventory:["view_inventory"],customers:["view_customers"],sales:["view_sales"],reports:["view_reports"],settings:["view_settings"],preparation:["prepare_orders"],delivery:["view_delivery"]}[I]||[];return d(R)},j={currentUserRole:r.role,userPermissions:n,availablePermissions:um,updateUserPermissions:c,loading:a,hasPermission:u,hasAnyPermission:d,hasAllPermissions:m,canAccessMenu:p,canAccessPage:x};return s.jsx(PN.Provider,{value:j,children:t})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var XA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),he=(t,e)=>{const r=_.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:c="",children:u,...d},m)=>_.createElement("svg",{ref:m,...XA,width:i,height:i,stroke:n,strokeWidth:o?Number(a)*24/Number(i):a,className:["lucide",`lucide-${ZA(t)}`,c].join(" "),...d},[...e.map(([p,x])=>_.createElement(p,x)),...Array.isArray(u)?u:[u]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=he("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=he("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=he("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=he("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=he("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RN=he("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=he("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DN=he("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=he("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ON=he("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LN=he("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=he("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=he("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=he("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=he("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dm=he("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=he("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MN=he("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=he("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=he("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=he("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VN=he("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=he("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=he("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=he("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=he("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=he("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=he("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=he("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=he("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=he("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=he("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=he("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=he("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=he("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=he("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=he("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=he("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=he("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=he("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=he("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=he("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=he("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UN=he("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=he("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=he("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=he("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=he("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),dP=({children:t})=>{const{currentUser:e,loading:r,logout:n}=Ar(),{currentBusiness:i,loading:a}=$t(),{approvalStatus:o}=Lu(),c=async()=>{try{await n()}catch(u){console.error("Failed to log out:",u)}};return r||a||o.loading?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):e?i?o.isApproved?s.jsx(s.Fragment,{children:t}):o.status==="pending"?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Waiting for Approval"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Your account is pending admin approval."}),s.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Please wait for an administrator to approve your access."}),s.jsxs("button",{onClick:c,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[s.jsx(VN,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})}):o.status==="suspended"?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Your account has been suspended."}),s.jsx("p",{className:"text-sm text-gray-500",children:"Please contact an administrator for assistance."})]})}):s.jsx(Xs,{to:"/business-setup",replace:!0}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Business Selected"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Complete registration or join an existing business to continue."}),s.jsx("a",{href:"/business-setup",className:"inline-block px-4 py-2 rounded-lg text-white bg-blue-600 hover:bg-blue-700",children:"Go to Business Setup"})]})}):s.jsx(Xs,{to:"/login",replace:!0})},$a=({children:t,permission:e,permissions:r=[],requireAll:n=!1,fallback:i=null,showAccessDenied:a=!1})=>{const{hasPermission:o,hasAnyPermission:c,hasAllPermissions:u}=aa();let d=!1;return e?d=o(e):r.length>0?n?d=u(r):d=c(r):d=!0,d?s.jsx(s.Fragment,{children:t}):a?s.jsx("div",{className:"flex items-center justify-center p-8 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"text-center",children:[s.jsx(FN,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this content."})]})}):i},hP=({isCollapsed:t})=>{const e=Un(),{userPermissions:r}=aa(),[n,i]=_.useState(null),a=d=>{i(m=>m===d?null:d)};_.useEffect(()=>{t&&n&&i(null)},[t]);const o=()=>r?u.filter(d=>{const m=d.name.toLowerCase().replace(/\s+/g,"-");return r.menuItems.includes(m)}):[],c=d=>({Dashboard:["view_dashboard"],Orders:["view_orders"],Preparation:["prepare_orders"],Inventory:["view_inventory"],Customers:["view_customers"],Sales:["view_sales"],Delivery:["view_delivery"],Invoicing:["view_invoicing"],Reports:["view_reports"],Settings:["view_settings"],Help:[]})[d]||[],u=[{name:"Dashboard",icon:nP,path:"/dashboard"},{name:"Orders",icon:ir,path:"/orders",children:[{name:"All Orders",path:"/orders"},{name:"Create Order",path:"/orders/create"},{name:"Pending Approvals",path:"/orders/approvals"},{name:"Order History",path:"/orders/history"}]},{name:"Preparation",icon:Ie,path:"/preparation",children:[{name:"Preparation Queue",path:"/preparation/queue"},{name:"My Assignments",path:"/preparation/assignments"},{name:"Preparation History",path:"/preparation/history"}]},{name:"Inventory",icon:Ie,path:"/inventory",children:[{name:"Main Store",path:"/inventory/main"},{name:"Sub-Stores",path:"/inventory/substores"},{name:"Product Catalog",path:"/inventory/products"},{name:"Inventory Transfers",path:"/inventory/transfers",icon:ki},{name:"Low Stock Alerts",path:"/inventory/alerts"}]},{name:"Customers",icon:Sr,path:"/customers",children:[{name:"Customer List",path:"/customers"},{name:"Add Customer",path:"/customers/add"},{name:"Customer Accounts",path:"/customers/accounts"},{name:"Credit Management",path:"/customers/credit"}]},{name:"Sales",icon:oa,path:"/sales",children:[{name:"Sales Dashboard",path:"/sales"},{name:"Create Sale",path:"/sales/create"},{name:"Sales Reports",path:"/sales/reports"}]},{name:"Delivery",icon:Wi,path:"/transport",children:[{name:"Active Deliveries",path:"/transport/active"},{name:"Transport Management",path:"/transport/management"},{name:"Delivery History",path:"/transport/history"}]},{name:"Invoicing",icon:MN,path:"/invoicing",children:[{name:"Generate Invoice",path:"/invoicing/generate"},{name:"Invoice History",path:"/invoicing/history"},{name:"Payment Tracking",path:"/invoicing/payments"}]},{name:"Reports",icon:RN,path:"/reports",children:[{name:"Sales Reports",path:"/reports/sales"},{name:"Inventory Reports",path:"/reports/inventory"},{name:"Financial Reports",path:"/reports/financial"},{name:"Custom Reports",path:"/reports/custom"}]},{name:"Settings",icon:sp,path:"/settings",children:[{name:"My Role Settings",path:"/settings/my-role"},{name:"Pending Approvals",path:"/settings/approvals"},{name:"Order Approval Settings",path:"/settings/order-approval"},{name:"User Management",path:"/settings/users"},{name:"System Settings",path:"/settings/system"},{name:"Store Configuration",path:"/settings/stores"}]},{name:"Help",icon:rP,path:"/help"}];return s.jsx("div",{className:`${t?"w-16":"w-64"} sidebar-gradient text-white flex flex-col transition-all duration-500 ease-in-out overflow-hidden`,children:s.jsx("nav",{className:`flex-1 py-4 ${t?"px-2":"px-4"} transition-all duration-300`,children:o().map(d=>{const m=d.icon,p=d.name.toLowerCase().replace(/\s+/g,"-"),x=n===p,j=d.children&&d.children.length>0,I=c(d.name);return s.jsx($a,{permissions:I,fallback:null,children:s.jsx("div",{className:"mb-2",children:j?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`flex items-center ${t?"justify-start":"justify-between"} p-3 rounded-lg cursor-pointer transition-all duration-300 ${e.pathname.startsWith(d.path)?"bg-blue-700":"hover:bg-blue-700/50"}`,onClick:()=>!t&&a(p),title:t?d.name:void 0,children:[s.jsxs("div",{className:`flex items-center ${t?"justify-start":"space-x-3"} transition-all duration-300`,children:[s.jsx(m,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{className:`font-medium transition-all duration-300 ${t?"opacity-0 w-0 overflow-hidden":"opacity-100 w-auto"}`,children:d.name})]}),s.jsx("div",{className:`transition-all duration-300 ${t?"opacity-0 w-0 overflow-hidden":"opacity-100 w-auto"}`,children:!t&&(x?s.jsx(ON,{className:"w-4 h-4"}):s.jsx(LN,{className:"w-4 h-4"}))})]}),s.jsx("div",{className:`transition-all duration-300 overflow-hidden ${t||!x?"max-h-0 opacity-0":"max-h-96 opacity-100"}`,children:s.jsx("div",{className:"ml-8 mt-2 space-y-1",children:d.children.map(b=>{const R=b.icon;return s.jsxs(px,{to:b.path,className:({isActive:v})=>`flex items-center space-x-3 p-2 rounded-lg text-sm transition-all duration-300 ${v?"bg-blue-600 text-white":"text-blue-200 hover:bg-blue-700/30 hover:text-white"}`,children:[R&&s.jsx(R,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{className:"transition-all duration-300",children:b.name})]},b.path)})})})]}):s.jsx(px,{to:d.path,className:({isActive:b})=>`block p-3 rounded-lg transition-all duration-300 ${b?"bg-blue-700":"hover:bg-blue-700/50"}`,title:t?d.name:void 0,children:s.jsxs("div",{className:`flex items-center ${t?"justify-start":"space-x-3"} transition-all duration-300`,children:[s.jsx(m,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{className:`font-medium transition-all duration-300 ${t?"opacity-0 w-0 overflow-hidden":"opacity-100 w-auto"}`,children:d.name})]})})})},d.name)})})})},mP=({onToggleSidebar:t})=>{const{currentUser:e,logout:r}=Ar(),{currentBusiness:n,pendingMembers:i}=$t(),{approvalStatus:a}=Lu(),{businessUsers:o}=na(),[c,u]=_.useState(!1),d=o.find(j=>j.userId===(e==null?void 0:e.uid)),m=()=>{var j;return d!=null&&d.userName?d.userName:((j=e==null?void 0:e.email)==null?void 0:j.split("@")[0])||"User"},p=()=>a.role?a.role.replace("_"," ").toUpperCase():"USER",x=async()=>{try{await r()}catch(j){console.error("Failed to log out:",j)}};return s.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-6 py-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:t,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"Toggle sidebar",children:s.jsx(iP,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:(n==null?void 0:n.name)||"Business Management System"}),s.jsxs("p",{className:"text-gray-600 text-sm",children:[m(),", ",p()]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{className:"relative p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[s.jsx(eP,{className:"w-5 h-5"}),i.length>0&&s.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>u(!c),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:m(),children:s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx(Xt,{className:"w-5 h-5 text-white"})})}),c&&s.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[s.jsxs("button",{className:"flex items-center space-x-3 w-full px-4 py-2 text-gray-700 hover:bg-gray-100 transition-colors",children:[s.jsx(Xt,{className:"w-4 h-4"}),s.jsx("span",{children:"Profile"})]}),s.jsxs("button",{className:"flex items-center space-x-3 w-full px-4 py-2 text-gray-700 hover:bg-gray-100 transition-colors",children:[s.jsx(sp,{className:"w-4 h-4"}),s.jsx("span",{children:"Settings"})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("button",{onClick:x,className:"flex items-center space-x-3 w-full px-4 py-2 text-red-600 hover:bg-red-50 transition-colors",children:[s.jsx(VN,{className:"w-4 h-4"}),s.jsx("span",{children:"Logout"})]})]})]})]})]})})},fP=()=>{const[t,e]=_.useState(()=>{const n=localStorage.getItem("sidebarCollapsed");return n?JSON.parse(n):!1}),r=()=>{e(n=>!n)};return _.useEffect(()=>{localStorage.setItem("sidebarCollapsed",JSON.stringify(t))},[t]),s.jsxs("div",{className:"h-screen bg-gray-50 flex flex-col",children:[s.jsx(mP,{onToggleSidebar:r}),s.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[s.jsx(hP,{isCollapsed:t}),s.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6",children:s.jsx(P1,{})})]})]})},pP=()=>{const t=()=>{window.location.reload()},e=()=>{window.open("https://console.firebase.google.com/","_blank")};return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:s.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4",children:s.jsx(Rt,{className:"w-6 h-6 text-red-600"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Firebase Quota Exceeded"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Your Firebase project has exceeded its usage limits. This is preventing the application from loading data."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"text-left",children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Solutions:"}),s.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("li",{children:" Wait for quota reset (usually 24 hours)"}),s.jsx("li",{children:" Upgrade to Blaze plan (pay-as-you-go)"}),s.jsx("li",{children:" Check Firebase Console for usage details"})]})]}),s.jsxs("div",{className:"flex flex-col space-y-2",children:[s.jsxs("button",{onClick:t,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(lP,{className:"w-4 h-4 mr-2"}),"Try Again"]}),s.jsxs("button",{onClick:e,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[s.jsx(tP,{className:"w-4 h-4 mr-2"}),"Open Firebase Console"]})]})]})]})]})})};class gP extends _.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("Error caught by boundary:",e,r)}render(){var e,r,n,i;return this.state.hasError?(r=(e=this.state.error)==null?void 0:e.message)!=null&&r.includes("quota")||(i=(n=this.state.error)==null?void 0:n.message)!=null&&i.includes("resource-exhausted")?s.jsx(pP,{}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:s.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"An error occurred while loading the application."}),s.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Reload Page"})]})})}):this.props.children}}const xP=()=>{const[t,e]=_.useState(""),[r,n]=_.useState(""),[i,a]=_.useState(!1),[o,c]=_.useState(!1),[u,d]=_.useState(""),[m,p]=_.useState(!1),[x,j]=_.useState(5),{login:I}=Ar(),{approvalStatus:b}=Lu(),R=Zt(),v=async y=>{y.preventDefault(),c(!0),d("");try{if(await I(t,r),b.status==="pending"){p(!0),c(!1),j(5);const f=setInterval(()=>{j(E=>E<=1?(clearInterval(f),p(!1),0):E-1)},1e3);return}R("/dashboard")}catch(f){d(f.message||"Failed to log in")}finally{c(!1)}};return s.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-white py-12 px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto h-16 w-16 bg-blue-600 rounded-full flex items-center justify-center",children:s.jsx(DN,{className:"h-8 w-8 text-white"})}),s.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Business Management System"}),s.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Sign in to your account"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-8 shadow-lg",children:s.jsxs("form",{className:"space-y-6",onSubmit:v,children:[u&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:u}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:y=>e(y.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your email"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),s.jsxs("div",{className:"mt-1 relative",children:[s.jsx("input",{id:"password",name:"password",type:i?"text":"password",autoComplete:"current-password",required:!0,value:r,onChange:y=>n(y.target.value),className:"appearance-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your password"}),s.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>a(!i),children:i?s.jsx(dm,{className:"h-5 w-5 text-gray-400"}):s.jsx(rn,{className:"h-5 w-5 text-gray-400"})})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),s.jsx("div",{className:"text-sm",children:s.jsx("a",{href:"#",className:"font-medium text-blue-600 hover:text-blue-500",children:"Forgot your password?"})})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:o,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Sign in"})}),s.jsx("div",{className:"text-center",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",s.jsx(xe,{to:"/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"Create your account"})]})})]})})]}),m&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-sm w-full",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(at,{className:"w-5 h-5 text-yellow-600 mr-2"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Account Pending Approval"})]}),s.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(Hi,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"px-6 py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx(at,{className:"w-6 h-6 text-yellow-600"})}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Waiting for Admin Approval"}),s.jsx("p",{className:"text-gray-600 text-sm mb-3",children:"Your account is pending admin approval. You'll be able to access the system once approved."}),s.jsxs("p",{className:"text-xs text-gray-500",children:["This message will close in ",x," seconds"]})]})})]})})]})},yP=()=>{const[t,e]=_.useState({firstName:"",lastName:"",email:"",phone:"",password:"",confirmPassword:""}),[r,n]=_.useState(!1),[i,a]=_.useState(!1),[o,c]=_.useState(!1),[u,d]=_.useState(""),{register:m}=Ar(),p=Zt(),x=async I=>{if(I.preventDefault(),c(!0),d(""),t.password!==t.confirmPassword){d("Passwords do not match"),c(!1);return}if(t.password.length<6){d("Password must be at least 6 characters long"),c(!1);return}try{await m(t.email,t.password,{firstName:t.firstName,lastName:t.lastName,phone:t.phone}),p("/business-setup")}catch(b){d(b.message||"Failed to create account")}finally{c(!1)}},j=I=>{e({...t,[I.target.name]:I.target.value})};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-white py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto h-16 w-16 bg-blue-600 rounded-full flex items-center justify-center",children:s.jsx(Xt,{className:"h-8 w-8 text-white"})}),s.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Create Your Account"}),s.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Sign up to get started with the Business Management System"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-8 shadow-lg",children:s.jsxs("form",{className:"space-y-6",onSubmit:x,children:[u&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:u}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First Name *"}),s.jsx("input",{id:"firstName",name:"firstName",type:"text",required:!0,value:t.firstName,onChange:j,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter first name"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last Name *"}),s.jsx("input",{id:"lastName",name:"lastName",type:"text",required:!0,value:t.lastName,onChange:j,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter last name"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address *"}),s.jsxs("div",{className:"mt-1 relative",children:[s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t.email,onChange:j,className:"appearance-none relative block w-full px-3 py-2 pl-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter your email"}),s.jsx(tl,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),s.jsxs("div",{className:"mt-1 relative",children:[s.jsx("input",{id:"phone",name:"phone",type:"tel",value:t.phone,onChange:j,className:"appearance-none relative block w-full px-3 py-2 pl-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter phone number"}),s.jsx(Mu,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password *"}),s.jsxs("div",{className:"mt-1 relative",children:[s.jsx("input",{id:"password",name:"password",type:r?"text":"password",autoComplete:"new-password",required:!0,value:t.password,onChange:j,className:"appearance-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Create a password"}),s.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>n(!r),children:r?s.jsx(dm,{className:"h-5 w-5 text-gray-400"}):s.jsx(rn,{className:"h-5 w-5 text-gray-400"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password *"}),s.jsxs("div",{className:"mt-1 relative",children:[s.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:i?"text":"password",autoComplete:"new-password",required:!0,value:t.confirmPassword,onChange:j,className:"appearance-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Confirm your password"}),s.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>a(!i),children:i?s.jsx(dm,{className:"h-5 w-5 text-gray-400"}):s.jsx(rn,{className:"h-5 w-5 text-gray-400"})})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:o,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Create Account"})}),s.jsx("div",{className:"text-center",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",s.jsx(xe,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in"})]})})]})})]})})},vP=()=>{const[t,e]=_.useState("register"),[r,n]=_.useState(!1),[i,a]=_.useState(""),[o,c]=_.useState(""),[u,d]=_.useState(null),{createBusiness:m,joinBusiness:p}=$t(),x=Zt(),[j,I]=_.useState({businessName:"",email:"",phone:"",address:"",businessType:"",mainStoreLocation:"",currency:"USD",timezone:"UTC"}),[b,R]=_.useState({authorizationCode:"",role:"sales_rep",systemAuthCode:""}),v=async E=>{E.preventDefault(),n(!0),a(""),c("");try{const P=Math.random().toString(36).substring(2,8).toUpperCase(),F=Math.random().toString(36).substring(2,8).toUpperCase();await m({name:j.businessName,email:j.email,phone:j.phone,address:j.address,businessType:j.businessType,ownerId:"",settings:{mainStoreLocation:j.mainStoreLocation,approvalRoles:["Admin","Sales Manager"],currency:j.currency,timezone:j.timezone}},{businessCode:P,systemCode:F}),d({businessCode:P,systemCode:F}),c("Business registered successfully! Save these authorization codes.")}catch(P){a(P.message||"Failed to register business")}finally{n(!1)}},y=async E=>{E.preventDefault(),n(!0),a(""),c("");try{await p(b.authorizationCode,b.role,b.role==="admin"?b.systemAuthCode:void 0),b.role==="admin"&&b.systemAuthCode?(c("Successfully joined as admin! You now have full access."),setTimeout(()=>x("/app/dashboard"),1500)):(c("Join request submitted! Please wait for admin approval. Redirecting to login..."),setTimeout(()=>x("/login"),1500))}catch(P){a(P.message||"Failed to join business")}finally{n(!1)}},f=E=>{t==="register"?I({...j,[E.target.name]:E.target.value}):R({...b,[E.target.name]:E.target.value})};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-white py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-2xl w-full space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto h-16 w-16 bg-blue-600 rounded-full flex items-center justify-center",children:t==="register"?s.jsx(DN,{className:"h-8 w-8 text-white"}):s.jsx(UN,{className:"h-8 w-8 text-white"})}),s.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:t==="register"?"Register Your Business":"Join Existing Business"}),s.jsx("p",{className:"mt-2 text-sm text-gray-600",children:t==="register"?"Set up your business profile and create an authorization code for your team":"Enter the authorization code provided by your business administrator"})]}),s.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[s.jsx("button",{type:"button",onClick:()=>e("register"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="register"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Register Business"}),s.jsx("button",{type:"button",onClick:()=>e("join"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="join"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Join Business"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-8 shadow-lg",children:t==="register"?s.jsxs("form",{className:"space-y-6",onSubmit:v,children:[i&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:i}),o&&s.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ve,{className:"h-5 w-5 mr-2"}),o]})}),s.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Business Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"businessName",className:"block text-sm font-medium text-gray-700",children:"Business Name *"}),s.jsx("input",{id:"businessName",name:"businessName",type:"text",required:!0,value:j.businessName,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter business name"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"businessType",className:"block text-sm font-medium text-gray-700",children:"Business Type *"}),s.jsxs("select",{id:"businessType",name:"businessType",required:!0,value:j.businessType,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[s.jsx("option",{value:"",children:"Select business type"}),s.jsx("option",{value:"retail",children:"Retail"}),s.jsx("option",{value:"wholesale",children:"Wholesale"}),s.jsx("option",{value:"manufacturing",children:"Manufacturing"}),s.jsx("option",{value:"distribution",children:"Distribution"}),s.jsx("option",{value:"service",children:"Service"}),s.jsx("option",{value:"other",children:"Other"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Business Email *"}),s.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:j.email,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter business email"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Business Phone *"}),s.jsx("input",{id:"phone",name:"phone",type:"tel",required:!0,value:j.phone,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter phone number"})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Business Address *"}),s.jsx("textarea",{id:"address",name:"address",rows:3,required:!0,value:j.address,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter complete business address"})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Business Settings"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"mainStoreLocation",className:"block text-sm font-medium text-gray-700",children:"Main Store Location *"}),s.jsx("input",{id:"mainStoreLocation",name:"mainStoreLocation",type:"text",required:!0,value:j.mainStoreLocation,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter location"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700",children:"Currency"}),s.jsxs("select",{id:"currency",name:"currency",value:j.currency,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[s.jsx("option",{value:"USD",children:"USD ($)"}),s.jsx("option",{value:"EUR",children:"EUR ()"}),s.jsx("option",{value:"GBP",children:"GBP ()"}),s.jsx("option",{value:"KES",children:"KES (KSh)"}),s.jsx("option",{value:"TZS",children:"TZS (TSh)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"timezone",className:"block text-sm font-medium text-gray-700",children:"Timezone"}),s.jsxs("select",{id:"timezone",name:"timezone",value:j.timezone,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[s.jsx("option",{value:"UTC",children:"UTC"}),s.jsx("option",{value:"America/New_York",children:"Eastern Time"}),s.jsx("option",{value:"America/Chicago",children:"Central Time"}),s.jsx("option",{value:"America/Denver",children:"Mountain Time"}),s.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),s.jsx("option",{value:"Europe/London",children:"London"}),s.jsx("option",{value:"Africa/Nairobi",children:"Nairobi"}),s.jsx("option",{value:"Africa/Dar_es_Salaam",children:"Dar es Salaam"})]})]})]})]}),u?s.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Authorization Codes"}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[s.jsxs("p",{className:"text-sm text-yellow-800 mb-3",children:[s.jsx("strong",{children:"Important:"})," Save these codes securely. You'll need them to invite team members and grant admin access."]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Sync Code (for team members)"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"text",value:u.businessCode,readOnly:!0,className:"flex-1 px-3 py-2 bg-white border border-gray-300 rounded-lg text-center text-lg font-mono tracking-wider"}),s.jsx("button",{type:"button",onClick:()=>navigator.clipboard.writeText(u.businessCode),className:"px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Copy"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"System Authorization Code (for admin only)"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"text",value:u.systemCode,readOnly:!0,className:"flex-1 px-3 py-2 bg-white border border-gray-300 rounded-lg text-center text-lg font-mono tracking-wider"}),s.jsx("button",{type:"button",onClick:()=>navigator.clipboard.writeText(u.systemCode),className:"px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Copy"})]})]})]})]}),s.jsx("button",{type:"button",onClick:()=>x("/app/dashboard"),className:"w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:"Continue to Dashboard"})]}):s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r?s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Register Business"})})]}):s.jsxs("form",{className:"space-y-6",onSubmit:y,children:[i&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:i}),o&&s.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ve,{className:"h-5 w-5 mr-2"}),o]})}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(sP,{className:"mx-auto h-12 w-12 text-blue-500 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Join Existing Business"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Enter the business authorization code and select your role."})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700",children:"Your Role *"}),s.jsxs("select",{id:"role",name:"role",required:!0,value:b.role,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[s.jsx("option",{value:"sales_rep",children:"Sales Representative"}),s.jsx("option",{value:"inventory_manager",children:"Inventory Manager"}),s.jsx("option",{value:"packer",children:"Packer"}),s.jsx("option",{value:"accountant",children:"Accountant"}),s.jsx("option",{value:"customer",children:"Customer"}),s.jsx("option",{value:"business_owner",children:"Business Owner"}),s.jsx("option",{value:"admin",children:"Admin"})]}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Admin role requires system authorization code"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"authorizationCode",className:"block text-sm font-medium text-gray-700",children:"Business Authorization Code *"}),s.jsx("input",{id:"authorizationCode",name:"authorizationCode",type:"text",required:!0,value:b.authorizationCode,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm text-center text-lg font-mono tracking-wider",placeholder:"Enter 6-character code",maxLength:6})]}),b.role==="admin"&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"systemAuthCode",className:"block text-sm font-medium text-gray-700",children:"System Authorization Code *"}),s.jsx("input",{id:"systemAuthCode",name:"systemAuthCode",type:"text",required:!0,value:b.systemAuthCode,onChange:f,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm text-center text-lg font-mono tracking-wider",placeholder:"Enter system code",maxLength:6}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Required for admin access. Get this from the business owner."})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r?s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Join Business"})})]})})]})})},wP=()=>{const t=[{name:"Total Orders",value:"1,247",change:"+12%",changeType:"positive",icon:ir,color:"blue"},{name:"Pending Orders",value:"23",change:"-5%",changeType:"negative",icon:at,color:"yellow"},{name:"Products in Stock",value:"1,892",change:"+8%",changeType:"positive",icon:Ie,color:"green"},{name:"Low Stock Items",value:"15",change:"+3",changeType:"warning",icon:Rt,color:"red"},{name:"Active Customers",value:"456",change:"+18%",changeType:"positive",icon:Sr,color:"purple"},{name:"Monthly Revenue",value:"$24,567",change:"+15%",changeType:"positive",icon:rp,color:"emerald"}],e=[{id:"ORD-001",customer:"John Doe",amount:"$1,250",status:"Pending",date:"2024-01-15"},{id:"ORD-002",customer:"Jane Smith",amount:"$890",status:"Approved",date:"2024-01-15"},{id:"ORD-003",customer:"Mike Johnson",amount:"$2,100",status:"Shipped",date:"2024-01-14"},{id:"ORD-004",customer:"Sarah Wilson",amount:"$750",status:"Delivered",date:"2024-01-14"},{id:"ORD-005",customer:"David Brown",amount:"$1,800",status:"Pending",date:"2024-01-13"}],r=a=>{switch(a){case"Pending":return"bg-yellow-100 text-yellow-800";case"Approved":return"bg-blue-100 text-blue-800";case"Shipped":return"bg-purple-100 text-purple-800";case"Delivered":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},n=a=>{switch(a){case"positive":return"text-green-600";case"negative":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-gray-600"}},i=a=>{switch(a){case"blue":return"from-blue-50 to-blue-100";case"yellow":return"from-yellow-50 to-yellow-100";case"green":return"from-green-50 to-green-100";case"red":return"from-red-50 to-red-100";case"purple":return"from-purple-50 to-purple-100";case"emerald":return"from-emerald-50 to-emerald-100";default:return"from-gray-50 to-gray-100"}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),s.jsx("p",{className:"text-gray-600",children:"Welcome to your business management system"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(a=>{const o=a.icon;return s.jsx("div",{className:`gradient-card rounded-xl p-6 border-l-4 ${a.color==="blue"?"border-l-blue-500":a.color==="yellow"?"border-l-yellow-500":a.color==="green"?"border-l-green-500":a.color==="red"?"border-l-red-500":a.color==="purple"?"border-l-purple-500":"border-l-emerald-500"}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:a.name}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.value}),s.jsxs("p",{className:`text-sm ${n(a.changeType)}`,children:[a.change," from last month"]})]}),s.jsx("div",{className:`p-3 rounded-lg bg-gradient-to-br ${i(a.color)}`,children:s.jsx(o,{className:`w-6 h-6 ${a.color==="blue"?"text-blue-600":a.color==="yellow"?"text-yellow-600":a.color==="green"?"text-green-600":a.color==="red"?"text-red-600":a.color==="purple"?"text-purple-600":"text-emerald-600"}`})})]})},a.name)})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"gradient-card rounded-xl p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Orders"}),s.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"View all"})]}),s.jsx("div",{className:"space-y-3",children:e.map(a=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-100",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:a.id}),s.jsx("p",{className:"text-sm text-gray-600",children:a.customer})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-medium text-gray-900",children:a.amount}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${r(a.status)}`,children:a.status})]})]},a.id))})]}),s.jsxs("div",{className:"gradient-card rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("button",{className:"p-4 bg-white rounded-lg border border-gray-100 hover:border-blue-300 hover:bg-blue-50 transition-colors text-left",children:[s.jsx(ir,{className:"w-8 h-8 text-blue-600 mb-2"}),s.jsx("p",{className:"font-medium text-gray-900",children:"Create Order"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Start a new order"})]}),s.jsxs("button",{className:"p-4 bg-white rounded-lg border border-gray-100 hover:border-green-300 hover:bg-green-50 transition-colors text-left",children:[s.jsx(Ie,{className:"w-8 h-8 text-green-600 mb-2"}),s.jsx("p",{className:"font-medium text-gray-900",children:"Add Product"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Add new inventory"})]}),s.jsxs("button",{className:"p-4 bg-white rounded-lg border border-gray-100 hover:border-purple-300 hover:bg-purple-50 transition-colors text-left",children:[s.jsx(Sr,{className:"w-8 h-8 text-purple-600 mb-2"}),s.jsx("p",{className:"font-medium text-gray-900",children:"New Customer"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Register customer"})]}),s.jsxs("button",{className:"p-4 bg-white rounded-lg border border-gray-100 hover:border-yellow-300 hover:bg-yellow-50 transition-colors text-left",children:[s.jsx(oa,{className:"w-8 h-8 text-yellow-600 mb-2"}),s.jsx("p",{className:"font-medium text-gray-900",children:"View Reports"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Business analytics"})]})]})]})]})]})},cr=()=>{var i;const{currentBusiness:t}=$t(),e=((i=t==null?void 0:t.settings)==null?void 0:i.currency)||"TZS",r=e==="TZS"?"sw-TZ":"en-US",n=_.useMemo(()=>new Intl.NumberFormat(r,{style:"currency",currency:e}),[r,e]);return a=>n.format(a||0)},O0=()=>{const{orders:t,ordersLoading:e,fetchOrders:r,deleteOrder:n}=Hn(),i=cr(),[a,o]=_.useState(""),[c,u]=_.useState("all"),[d,m]=_.useState("all"),[p,x]=_.useState("date"),[j,I]=_.useState(!1),[b,R]=_.useState(null),[v,y]=_.useState(!1),f=C=>{R(C),I(!0)},E=async()=>{if(b){y(!0);try{await n(b.id),I(!1),R(null),await r()}catch(C){console.error("Error deleting order:",C)}finally{y(!1)}}},P=()=>{I(!1),R(null)},F=_.useMemo(()=>t.filter(C=>{const S=C.orderNumber.toLowerCase().includes(a.toLowerCase())||C.customerName.toLowerCase().includes(a.toLowerCase())||C.customerEmail.toLowerCase().includes(a.toLowerCase()),H=c==="all"||C.status===c,W=d==="all"||C.paymentStatus===d;return S&&H&&W}),[t,a,c,d]),N=_.useMemo(()=>[...F].sort((C,S)=>{switch(p){case"date":return new Date(S.orderDate).getTime()-new Date(C.orderDate).getTime();case"amount":return S.totalAmount-C.totalAmount;case"customer":return C.customerName.localeCompare(S.customerName);case"status":return C.status.localeCompare(S.status);default:return 0}}),[F,p]),w=C=>{switch(C){case"pending":return s.jsx(at,{className:"h-4 w-4 text-yellow-600"});case"approved":return s.jsx(ve,{className:"h-4 w-4 text-green-600"});case"processing":return s.jsx(Rt,{className:"h-4 w-4 text-blue-600"});case"shipped":return s.jsx(ve,{className:"h-4 w-4 text-indigo-600"});case"delivered":return s.jsx(ve,{className:"h-4 w-4 text-green-600"});case"cancelled":return s.jsx(rl,{className:"h-4 w-4 text-red-600"});default:return s.jsx(at,{className:"h-4 w-4 text-gray-600"})}},T=C=>{switch(C){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"processing":return"bg-blue-100 text-blue-800";case"shipped":return"bg-indigo-100 text-indigo-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},A=C=>{switch(C){case"pending":return"bg-yellow-100 text-yellow-800";case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-blue-100 text-blue-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},D=C=>{switch(C){case"cash":return"Cash";case"credit":return"Credit";case"bank_transfer":return"Bank Transfer";case"mobile_money":return"Mobile Money";default:return C}};return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Orders"}),s.jsx("p",{className:"text-gray-600",children:"Manage customer orders and fulfillment"})]}),s.jsxs(xe,{to:"/orders/create",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Create Order"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ir,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Orders"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(at,{className:"h-6 w-6 text-yellow-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(C=>C.status==="pending").length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ve,{className:"h-6 w-6 text-green-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Completed"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(C=>C.status==="delivered").length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Rt,{className:"h-6 w-6 text-red-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Overdue"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(C=>C.paymentStatus==="overdue").length})]})})]})})})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search orders...",value:a,onChange:C=>o(C.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{value:c,onChange:C=>u(C.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"processing",children:"Processing"}),s.jsx("option",{value:"shipped",children:"Shipped"}),s.jsx("option",{value:"delivered",children:"Delivered"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]}),s.jsxs("select",{value:d,onChange:C=>m(C.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Payment"}),s.jsx("option",{value:"pending",children:"Pending Payment"}),s.jsx("option",{value:"paid",children:"Paid"}),s.jsx("option",{value:"partial",children:"Partial Payment"}),s.jsx("option",{value:"overdue",children:"Overdue"})]}),s.jsxs("select",{value:p,onChange:C=>x(C.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"date",children:"Sort by Date"}),s.jsx("option",{value:"amount",children:"Sort by Amount"}),s.jsx("option",{value:"customer",children:"Sort by Customer"}),s.jsx("option",{value:"status",children:"Sort by Status"})]})]})]})}),s.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(C=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:w(C.status)}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:C.orderNumber}),s.jsxs("div",{className:"text-sm text-gray-500",children:[C.itemsCount," items"]})]})]})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:C.customerName}),s.jsx("div",{className:"text-sm text-gray-500",children:C.customerEmail})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(C.orderDate).toLocaleDateString()}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:i(C.totalAmount)}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm text-gray-900",children:D(C.paymentType)}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${A(C.paymentStatus)}`,children:C.paymentStatus})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${T(C.status)}`,children:C.status})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx($a,{permission:"view_orders",children:s.jsx(xe,{to:`/orders/${C.id}`,className:"text-blue-600 hover:text-blue-900",children:s.jsx(rn,{className:"h-4 w-4"})})}),s.jsx($a,{permission:"edit_orders",children:s.jsx(xe,{to:`/orders/edit/${C.id}`,className:"text-indigo-600 hover:text-indigo-900",children:s.jsx(Pr,{className:"h-4 w-4"})})}),s.jsx($a,{permission:"delete_orders",children:s.jsx("button",{onClick:()=>f(C),className:"text-red-600 hover:text-red-900 ml-3",title:"Delete order",children:s.jsx(Tt,{className:"h-4 w-4"})})})]})})]},C.id))})]})}),N.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ir,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No orders found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:a||c!=="all"||d!=="all"?"Try adjusting your search or filter criteria.":"Get started by creating your first order."}),!a&&c==="all"&&d==="all"&&s.jsx("div",{className:"mt-6",children:s.jsx($a,{permission:"create_orders",children:s.jsxs(xe,{to:"/orders/create",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Create Order"]})})})]})]}),j&&b&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Order"})}),s.jsxs("div",{className:"px-6 py-4",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mr-4",children:s.jsx(Tt,{className:"w-6 h-6 text-red-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Are you sure?"}),s.jsx("p",{className:"text-sm text-gray-600",children:"This action cannot be undone."})]})]}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Order:"})," #",b.orderNumber]}),s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Customer:"})," ",b.customerName]}),s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Amount:"})," ",i(b.totalAmount)]}),s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Status:"})," ",b.status]})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"This will permanently delete the order and all its associated data."})]}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-3",children:[s.jsx("button",{onClick:P,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",disabled:v,children:"Cancel"}),s.jsx("button",{onClick:E,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center space-x-2",disabled:v,children:v?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Deleting..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Tt,{className:"w-4 h-4"}),s.jsx("span",{children:"Delete Order"})]})})]})]})})]})},bP=()=>{const t=Zt(),{createOrder:e}=Hn(),{customers:r}=ia(),{products:n,stores:i,stockItems:a}=zt(),{businessUsers:o,fetchBusinessUsers:c}=na(),u=cr(),[d,m]=_.useState(!1),[p,x]=_.useState(""),[j,I]=_.useState(null),[b,R]=_.useState("cash"),[v,y]=_.useState(""),[f,E]=_.useState([]),[P,F]=_.useState(null),[N,w]=_.useState({}),[T,A]=_.useState(""),[D,C]=_.useState(""),[S,H]=_.useState({street:"",city:"",state:"",zipCode:"",country:""}),[W,re]=_.useState(""),[ce,O]=_.useState(""),[L,U]=_.useState(""),[M,V]=_.useState(!1),[z,K]=_.useState(!1);_.useEffect(()=>{c()},[c]);const X=o.filter($=>$.role==="packer"),Q=(r||[]).filter($=>$&&$.firstName&&$.lastName&&$.email&&$.phone&&(`${$.firstName} ${$.lastName}`.toLowerCase().includes(W.toLowerCase())||$.email.toLowerCase().includes(W.toLowerCase())||$.phone.includes(W))),ie=(n||[]).map($=>{const se=(a||[]).find(ue=>ue.productId===$.id),ge=(i||[]).find(ue=>ue.id===(se==null?void 0:se.storeId));return{id:$.id,name:$.name,sku:$.sku,description:$.description,unitPrice:$.unitPrice,unit:$.unit,category:$.category,availableStock:(se==null?void 0:se.availableStock)||0,storeId:(se==null?void 0:se.storeId)||"",storeName:(ge==null?void 0:ge.name)||"Unknown Store"}}),ye=ie.filter($=>{const se=$.name.toLowerCase().includes(ce.toLowerCase())||$.sku.toLowerCase().includes(ce.toLowerCase())||$.description.toLowerCase().includes(ce.toLowerCase())||$.category.toLowerCase().includes(ce.toLowerCase()),ge=!L||$.storeId===L;return se&&ge}),_e=$=>{I($),re(`${$.firstName} ${$.lastName}`),V(!1),F(null)},Ue=()=>{if(!j||b!=="credit"){F(null);return}const $=f.reduce((Oe,qt)=>Oe+qt.totalPrice,0),se=j.creditLimit-j.creditUsed,ge=se>=$&&$>0;let ue="";$===0?ue="Please add items to the order first":j.isActive?se<$?ue=`Insufficient credit. Available: ${u(se)}, Required: ${u($)}`:ue=`Credit approved. Available: ${u(se)}`:ue="Customer account is inactive",F({isEligible:ge,availableCredit:se,orderTotal:$,message:ue})};_.useEffect(()=>{Ue()},[b,f,j]);const ur=$=>{if($.availableStock===0){x(`${$.name} is out of stock and cannot be added to the order.`);return}const se=f.find(ge=>ge.productId===$.id);if(se){if(se.quantity+1>$.availableStock){x(`Cannot add more ${$.name}. Only ${$.availableStock} units available.`);return}E(ge=>ge.map(ue=>ue.productId===$.id?{...ue,quantity:ue.quantity+1,totalPrice:(ue.quantity+1)*ue.unitPrice}:ue))}else{const ge={productId:$.id,productName:$.name,sku:$.sku,description:$.description,unitPrice:$.unitPrice,quantity:1,totalPrice:$.unitPrice,unit:$.unit,storeId:$.storeId,storeName:$.storeName};E(ue=>[...ue,ge])}O(""),K(!1)},vs=($,se)=>{if(se<=0)E(ge=>ge.filter(ue=>ue.productId!==$));else{const ge=ie.find(ue=>ue.id===$);if(ge&&se>ge.availableStock){x(`Cannot order ${se} units. Only ${ge.availableStock} units available for ${ge.name}`);return}E(ue=>ue.map(Oe=>Oe.productId===$?{...Oe,quantity:se,totalPrice:se*Oe.unitPrice}:Oe))}},la=$=>{E(se=>se.filter(ge=>ge.productId!==$))},Kn=()=>f.reduce(($,se)=>$+se.totalPrice,0),ca=async $=>{var se,ge;if($.preventDefault(),!j){x("Please select a customer");return}if(f.length===0){x("Please add at least one product to the order");return}for(const ue of f){const Oe=ie.find(qt=>qt.id===ue.productId);if(Oe&&ue.quantity>Oe.availableStock){x(`Cannot order ${ue.quantity} units of ${Oe.name}. Only ${Oe.availableStock} units available.`);return}}if(!T){x("Please assign a packer to the order");return}if(!D){x("Please select a delivery method");return}if(D!=="customer_pickup"&&(!S.street||!S.city||!S.state||!S.zipCode||!S.country)){x("Please provide complete delivery address");return}if(b==="credit"&&P&&!P.isEligible){x("Order amount exceeds available credit limit");return}m(!0),x("");try{const ue={orderNumber:"",customerId:j.id,customerName:`${j.firstName} ${j.lastName}`,customerEmail:j.email,customerPhone:j.phone,orderDate:new Date().toISOString(),status:"pending",paymentType:b,paymentStatus:b==="cash"?"paid":"pending",totalAmount:Kn(),items:f,itemsCount:f.length,notes:v,assignedPacker:T,deliveryMethod:D,deliveryAddress:D!=="customer_pickup"?S:void 0,createdBy:"",createdAt:"",updatedAt:""};await e(ue),t("/orders/list",{state:{message:"Order created successfully!"}})}catch(ue){console.error("Error creating order:",ue),(se=ue.message)!=null&&se.includes("No business or user selected")?x("Authentication error. Please refresh the page and try again."):(ge=ue.message)!=null&&ge.includes("BLOCKED_BY_CLIENT")?(console.log("Firebase blocked, using mock order creation"),x(""),t("/orders/list",{state:{message:"Order created successfully! (Mock mode)"}})):x("Failed to create order. Please try again.")}finally{m(!1)}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>t(-1),className:"p-2 text-gray-400 hover:text-gray-600",children:s.jsx(Jt,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create New Order"}),s.jsx("p",{className:"text-gray-600",children:"Add products and create a new customer order"})]})]})}),s.jsxs("form",{onSubmit:ca,className:"space-y-6",children:[s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(Xt,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Customer Selection"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Customer *"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:W,onChange:$=>{re($.target.value),V(!0)},onFocus:()=>V(!0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"}),M&&W&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:Q.map($=>s.jsxs("div",{onClick:()=>_e($),className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[s.jsxs("div",{className:"font-medium text-gray-900",children:[$.firstName," ",$.lastName]}),s.jsx("div",{className:"text-sm text-gray-500",children:$.email}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Available Credit: ",u($.creditLimit-$.creditUsed)]})]},$.id))})]})]}),j&&s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900",children:j.name}),s.jsx("p",{className:"text-sm text-gray-600",children:j.email}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Available Credit: ",u(j.creditLimit-j.creditUsed)]})]}),s.jsx("button",{type:"button",onClick:()=>{I(null),re("")},className:"text-gray-400 hover:text-gray-600",children:s.jsx(Hi,{className:"h-4 w-4"})})]}),j.isEligibleForCredit&&s.jsxs("div",{className:"mt-2 text-sm text-green-600",children:["Credit Available: ",u(j.creditLimit-j.creditUsed)]})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(Ie,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Add Products"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Products"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search by name, description, SKU, or category...",value:ce,onChange:$=>{O($.target.value),K(!0)},onFocus:()=>K(!0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"}),z&&ce&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:ye.map($=>s.jsx("div",{onClick:()=>ur($),className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:$.name}),s.jsx("div",{className:"text-sm text-gray-500",children:$.description}),s.jsxs("div",{className:"text-sm text-gray-500",children:[$.category,"  ",$.storeName]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"font-medium text-gray-900",children:u($.unitPrice)}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Stock: ",$.availableStock," ",$.unit]})]})]})},$.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Store"}),s.jsxs("select",{value:L,onChange:$=>U($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"All Stores"}),i.map($=>s.jsx("option",{value:$.id,children:$.name},$.id))]})]})]}),f.length>0&&s.jsxs("div",{className:"mt-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Order Items"}),s.jsx("div",{className:"space-y-3",children:f.map($=>s.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-900",children:$.productName}),s.jsxs("div",{className:"text-sm text-gray-500",children:["SKU: ",$.sku,"  ",$.storeName]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[u($.unitPrice)," per ",$.unit]}),(()=>{const se=ie.find(qt=>qt.id===$.productId),ge=(se==null?void 0:se.availableStock)||0,ue=ge<=5,Oe=ge===0;return s.jsx("div",{className:`text-xs mt-1 ${Oe?"text-red-600":ue?"text-orange-600":"text-green-600"}`,children:Oe?"Out of Stock":ue?`Low Stock: ${ge} available`:`${ge} in stock`})})()]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>{const se=$.quantity-1;vs($.productId,se),w(ge=>({...ge,[$.productId]:se.toString()}))},className:"p-1 text-gray-400 hover:text-gray-600",children:s.jsx(aP,{className:"h-4 w-4"})}),s.jsx("input",{type:"number",min:"1",value:N[$.productId]!==void 0?N[$.productId]:$.quantity.toString(),onChange:se=>{const ge=se.target.value;w(ue=>({...ue,[$.productId]:ge}))},onBlur:se=>{const ge=se.target.value,ue=parseInt(ge);if(isNaN(ue)||ue<1)w(Oe=>({...Oe,[$.productId]:$.quantity.toString()})),vs($.productId,1);else{const Oe=ie.find(qt=>qt.id===$.productId);Oe&&ue>Oe.availableStock?(x(`Cannot order ${ue} units. Only ${Oe.availableStock} units available for ${Oe.name}`),w(qt=>({...qt,[$.productId]:$.quantity.toString()}))):(vs($.productId,ue),w(qt=>({...qt,[$.productId]:ue.toString()})))}},onKeyDown:se=>{se.key==="Enter"&&se.currentTarget.blur()},className:"w-16 px-2 py-1 text-center border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),s.jsx("button",{type:"button",onClick:()=>{const se=$.quantity+1,ge=ie.find(ue=>ue.id===$.productId);if(ge&&se>ge.availableStock){x(`Cannot order ${se} units. Only ${ge.availableStock} units available for ${ge.name}`);return}vs($.productId,se),w(ue=>({...ue,[$.productId]:se.toString()}))},className:"p-1 text-gray-400 hover:text-gray-600",children:s.jsx(ut,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:"font-medium text-gray-900",children:u($.totalPrice)})}),s.jsx("button",{type:"button",onClick:()=>la($.productId),className:"p-1 text-red-400 hover:text-red-600",children:s.jsx(Hi,{className:"h-4 w-4"})})]})]},$.productId))}),s.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[s.jsx("span",{children:"Total Amount:"}),s.jsx("span",{children:u(Kn())})]})})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(ps,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Payment Information"})]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{value:"cash",label:"Cash",icon:""},{value:"credit",label:"Credit",icon:""}].map($=>s.jsxs("label",{className:"relative",children:[s.jsx("input",{type:"radio",name:"paymentType",value:$.value,checked:b===$.value,onChange:se=>R(se.target.value),className:"sr-only"}),s.jsx("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-colors ${b===$.value?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl mb-2",children:$.icon}),s.jsx("div",{className:"text-sm font-medium text-gray-900",children:$.label})]})})]},$.value))}),b==="credit"&&j&&s.jsxs("div",{className:"mt-4 p-4 rounded-lg border",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(ps,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-900",children:"Credit Eligibility Check"})]}),P?s.jsxs("div",{className:`p-3 rounded-lg ${P.isEligible?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${P.isEligible?"bg-green-500":"bg-red-500"}`}),s.jsx("span",{className:`text-sm font-medium ${P.isEligible?"text-green-800":"text-red-800"}`,children:P.isEligible?"Credit Approved":"Credit Denied"})]}),s.jsx("p",{className:`text-sm mt-1 ${P.isEligible?"text-green-700":"text-red-700"}`,children:P.message}),s.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[s.jsxs("div",{children:["Customer: ",j.firstName," ",j.lastName]}),s.jsxs("div",{children:["Credit Limit: ",u(j.creditLimit)]}),s.jsxs("div",{children:["Credit Used: ",u(j.creditUsed)]}),s.jsxs("div",{children:["Available Credit: ",u(P.availableCredit)]}),s.jsxs("div",{children:["Order Total: ",u(P.orderTotal)]})]})]}):s.jsx("div",{className:"p-3 rounded-lg bg-yellow-50 border border-yellow-200",children:s.jsx("p",{className:"text-sm text-yellow-800",children:f.length===0?"Please add items to the order to check credit eligibility":"Checking credit eligibility..."})})]})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Order Notes (Optional)"}),s.jsx("textarea",{id:"notes",name:"notes",rows:3,value:v,onChange:$=>y($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Add any special instructions or notes for this order..."})]})})}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(Ie,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Packer Assignment & Delivery"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign Packer *"}),s.jsxs("select",{value:T,onChange:$=>A($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Select a packer"}),X.map($=>s.jsxs("option",{value:$.id,children:[$.userName||$.userEmail," (Packer)"]},$.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Method *"}),s.jsxs("select",{value:D,onChange:$=>C($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Select delivery method"}),s.jsx("option",{value:"customer_pickup",children:"Customer Pickup"}),s.jsx("option",{value:"local",children:"Local Delivery"}),s.jsx("option",{value:"cargo",children:"Cargo Delivery"})]})]})]}),D&&D!=="customer_pickup"&&s.jsxs("div",{className:"mt-6",children:[s.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Delivery Address"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address *"}),s.jsx("input",{type:"text",value:S.street,onChange:$=>H(se=>({...se,street:$.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter street address",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),s.jsx("input",{type:"text",value:S.city,onChange:$=>H(se=>({...se,city:$.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter city",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State/Province *"}),s.jsx("input",{type:"text",value:S.state,onChange:$=>H(se=>({...se,state:$.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter state/province",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ZIP/Postal Code *"}),s.jsx("input",{type:"text",value:S.zipCode,onChange:$=>H(se=>({...se,zipCode:$.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter ZIP/postal code",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country *"}),s.jsx("input",{type:"text",value:S.country,onChange:$=>H(se=>({...se,country:$.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter country",required:!0})]})]})]})]}),p&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-red-600",children:p})}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>t(-1),className:"px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:d||!j||f.length===0||b==="credit"&&P&&!P.isEligible||!1,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:d?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating Order..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Hr,{className:"w-4 h-4 mr-2"}),"Create Order"]})})]})]})]})},NP=()=>{const{orderId:t}=Bn(),e=Zt(),{getOrderById:r,approveOrder:n}=Hn(),{userPermissions:i}=aa(),{currentUser:a}=Ar(),o=cr(),[c,u]=_.useState(!0),[d,m]=_.useState(null),[p,x]=_.useState(!1);_.useEffect(()=>{(()=>{if(t){u(!0);try{const E=r(t);m(E||null)}catch(E){console.error("Error loading order:",E),m(null)}finally{u(!1)}}})()},[t,r]);const j=f=>{switch(f){case"pending":return s.jsx(at,{className:"h-5 w-5 text-yellow-600"});case"approved":return s.jsx(ve,{className:"h-5 w-5 text-green-600"});case"processing":return s.jsx(Rt,{className:"h-5 w-5 text-blue-600"});case"shipped":return s.jsx(ve,{className:"h-5 w-5 text-indigo-600"});case"delivered":return s.jsx(ve,{className:"h-5 w-5 text-green-600"});case"cancelled":return s.jsx(rl,{className:"h-5 w-5 text-red-600"});default:return s.jsx(at,{className:"h-5 w-5 text-gray-600"})}},I=f=>{switch(f){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"processing":return"bg-blue-100 text-blue-800";case"shipped":return"bg-indigo-100 text-indigo-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=f=>{switch(f){case"pending":return"bg-yellow-100 text-yellow-800";case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-blue-100 text-blue-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},R=f=>{switch(f){case"cash":return"Cash";case"credit":return"Credit";case"bank_transfer":return"Bank Transfer";case"mobile_money":return"Mobile Money";default:return f}},v=!!i&&i.permissions.includes("approve_orders"),y=async()=>{if(!(!d||!d.id)){x(!0);try{await n(d.id,(a==null?void 0:a.uid)||""),m(f=>f&&{...f,status:"approved"})}catch(f){console.error("Failed to approve order",f)}finally{x(!1)}}};return c?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):d?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>e(-1),className:"p-2 text-gray-400 hover:text-gray-600",children:s.jsx(Jt,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Order Details"}),s.jsxs("p",{className:"text-gray-600",children:["Order #",d.orderNumber]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[d.status==="pending"&&v&&s.jsxs("button",{onClick:y,disabled:p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:[p?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):s.jsx(ve,{className:"w-4 h-4 mr-2"}),"Approve"]}),s.jsxs("button",{onClick:()=>e(`/orders/edit/${d.id}`),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(Pr,{className:"w-4 h-4 mr-2"}),"Edit Order"]})]})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[j(d.status),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Order Status"}),s.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${I(d.status)}`,children:d.status.charAt(0).toUpperCase()+d.status.slice(1)})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Order Date"}),s.jsx("div",{className:"text-lg font-medium text-gray-900",children:new Date(d.orderDate).toLocaleDateString()})]})]})}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(Xt,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Customer Information"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Customer Name"}),s.jsx("p",{className:"text-sm text-gray-900",children:d.customerName})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Email"}),s.jsx("p",{className:"text-sm text-gray-900",children:d.customerEmail})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Phone"}),s.jsx("p",{className:"text-sm text-gray-900",children:d.customerPhone})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(ps,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Payment Information"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Payment Type"}),s.jsx("p",{className:"text-sm text-gray-900",children:R(d.paymentType)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Payment Status"}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${b(d.paymentStatus)}`,children:d.paymentStatus.charAt(0).toUpperCase()+d.paymentStatus.slice(1)})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(Ie,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Order Items"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Store"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.items.map((f,E)=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.productName}),s.jsxs("div",{className:"text-sm text-gray-500",children:["SKU: ",f.sku]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:f.storeName}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[f.quantity," ",f.unit]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:o(f.unitPrice)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o(f.totalPrice)})]},E))})]})}),s.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[s.jsx("span",{children:"Total Amount:"}),s.jsx("span",{children:o(d.totalAmount)})]})})]}),d.notes&&s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Order Notes"}),s.jsx("p",{className:"text-gray-600",children:d.notes})]})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ir,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Order not found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"The order you're looking for doesn't exist or has been deleted."}),s.jsx("div",{className:"mt-6",children:s.jsxs("button",{onClick:()=>e("/orders/list"),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(Jt,{className:"w-4 h-4 mr-2"}),"Back to Orders"]})})]})},jP=()=>{const{orderId:t}=Bn(),e=Zt(),{getOrderById:r,updateOrder:n}=Hn(),{customers:i}=GA(),{products:a,stores:o}=zt(),c=cr(),[u,d]=_.useState(!1),[m,p]=_.useState(!1),[x,j]=_.useState(null),[I,b]=_.useState(""),[R,v]=_.useState(""),[y,f]=_.useState({customerId:"",customerName:"",customerEmail:"",customerPhone:"",status:"pending",paymentType:"cash",paymentStatus:"pending",notes:"",items:[]});_.useEffect(()=>{(()=>{if(t){d(!0);try{const H=r(t);H?(j(H),f({customerId:H.customerId,customerName:H.customerName,customerEmail:H.customerEmail,customerPhone:H.customerPhone||"",status:H.status,paymentType:H.paymentType,paymentStatus:H.paymentStatus,notes:H.notes||"",items:H.items||[]})):j(null)}catch(H){console.error("Error loading order:",H),j(null)}finally{d(!1)}}})()},[t,r]);const E=S=>{const{name:H,value:W}=S.target;f(re=>({...re,[H]:W}))},P=S=>{const H=i.find(W=>W.id===S);H&&f(W=>({...W,customerId:H.id,customerName:H.firstName+" "+H.lastName,customerEmail:H.email,customerPhone:H.phone||""}))},F=()=>{f(S=>({...S,items:[...S.items,{productId:"",productName:"",sku:"",unitPrice:0,quantity:1,totalPrice:0,unit:"pcs",storeId:"",storeName:""}]}))},N=(S,H,W)=>{f(re=>{const ce=[...re.items];return ce[S]={...ce[S],[H]:W},(H==="unitPrice"||H==="quantity")&&(ce[S].totalPrice=ce[S].unitPrice*ce[S].quantity),{...re,items:ce}})},w=S=>{f(H=>({...H,items:H.items.filter((W,re)=>re!==S)}))},T=(S,H)=>{const W=a.find(re=>re.id===H);W&&(N(S,"productId",W.id),N(S,"productName",W.name),N(S,"sku",W.sku),N(S,"unitPrice",W.unitPrice),N(S,"unit",W.unit))},A=(S,H)=>{const W=o.find(re=>re.id===H);W&&(N(S,"storeId",W.id),N(S,"storeName",W.name))},D=()=>y.items.reduce((S,H)=>S+H.totalPrice,0),C=async S=>{if(S.preventDefault(),!!t){p(!0),b(""),v("");try{const H=D();await n(t,{customerId:y.customerId,customerName:y.customerName,customerEmail:y.customerEmail,customerPhone:y.customerPhone,status:y.status,paymentType:y.paymentType,paymentStatus:y.paymentStatus,totalAmount:H,items:y.items,itemsCount:y.items.length,notes:y.notes,updatedAt:new Date().toISOString()}),v("Order updated successfully!"),setTimeout(()=>{e("/orders/list",{state:{message:"Order updated successfully!"}})},1500)}catch(H){console.error("Error updating order:",H),b(H.message||"Failed to update order")}finally{p(!1)}}};return u?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):x?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>e(-1),className:"p-2 text-gray-400 hover:text-gray-600",children:s.jsx(Jt,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Order"}),s.jsx("p",{className:"text-gray-600",children:"Modify order details and status"})]})]}),s.jsx("div",{className:"flex items-center space-x-3",children:s.jsxs("span",{className:"text-sm text-gray-500",children:["Order #",x.orderNumber]})})]}),R&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:s.jsx("div",{className:"flex",children:s.jsx("div",{className:"ml-3",children:s.jsx("p",{className:"text-sm text-green-800",children:R})})})}),I&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:s.jsx("div",{className:"flex",children:s.jsx("div",{className:"ml-3",children:s.jsx("p",{className:"text-sm text-red-800",children:I})})})}),s.jsxs("form",{onSubmit:C,className:"space-y-6",children:[s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(Xt,{className:"h-5 w-5 text-gray-400"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Customer Information"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),s.jsxs("select",{name:"customerId",value:y.customerId,onChange:S=>P(S.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Select Customer"}),i.map(S=>s.jsxs("option",{value:S.id,children:[S.firstName+" "+S.lastName," (",S.email,")"]},S.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name"}),s.jsx("input",{type:"text",name:"customerName",value:y.customerName,onChange:E,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),s.jsx("input",{type:"email",name:"customerEmail",value:y.customerEmail,onChange:E,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),s.jsx("input",{type:"text",name:"customerPhone",value:y.customerPhone,onChange:E,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(Ie,{className:"h-5 w-5 text-gray-400"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Order Status"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Status"}),s.jsxs("select",{name:"status",value:y.status,onChange:E,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"processing",children:"Processing"}),s.jsx("option",{value:"shipped",children:"Shipped"}),s.jsx("option",{value:"delivered",children:"Delivered"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Type"}),s.jsxs("select",{name:"paymentType",value:y.paymentType,onChange:E,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"cash",children:"Cash"}),s.jsx("option",{value:"credit",children:"Credit"}),s.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),s.jsx("option",{value:"mobile_money",children:"Mobile Money"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Status"}),s.jsxs("select",{name:"paymentStatus",value:y.paymentStatus,onChange:E,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"paid",children:"Paid"}),s.jsx("option",{value:"partial",children:"Partial"}),s.jsx("option",{value:"overdue",children:"Overdue"})]})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ir,{className:"h-5 w-5 text-gray-400"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Order Items"})]}),s.jsxs("button",{type:"button",onClick:F,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Item"]})]}),s.jsx("div",{className:"space-y-4",children:y.items.map((S,H)=>s.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product"}),s.jsxs("select",{value:S.productId,onChange:W=>T(H,W.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Select Product"}),a.map(W=>s.jsxs("option",{value:W.id,children:[W.name," (",W.sku,")"]},W.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Store"}),s.jsxs("select",{value:S.storeId,onChange:W=>A(H,W.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Select Store"}),o.map(W=>s.jsx("option",{value:W.id,children:W.name},W.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Price"}),s.jsx("input",{type:"number",step:"0.01",value:S.unitPrice,onChange:W=>N(H,"unitPrice",parseFloat(W.target.value)||0),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),s.jsx("input",{type:"number",min:"1",value:S.quantity,onChange:W=>N(H,"quantity",parseInt(W.target.value)||1),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Price"}),s.jsx("input",{type:"text",value:c(S.totalPrice),readOnly:!0,className:"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50"})]}),s.jsx("div",{className:"flex items-end",children:s.jsx("button",{type:"button",onClick:()=>w(H),className:"w-full inline-flex items-center justify-center px-3 py-2 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-red-50 hover:bg-red-100",children:s.jsx(Tt,{className:"w-4 h-4"})})})]})},H))}),y.items.length===0&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ir,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No items"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Add items to this order."})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(oP,{className:"h-5 w-5 text-gray-400"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Order Notes"})]}),s.jsx("textarea",{name:"notes",value:y.notes,onChange:E,rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this order..."})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(ps,{className:"h-5 w-5 text-gray-400"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Order Summary"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-gray-600",children:["Total Items: ",y.items.length]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Order Date: ",new Date(x.orderDate).toLocaleDateString()]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c(D())}),s.jsx("p",{className:"text-sm text-gray-600",children:"Total Amount"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>e(-1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:m||y.items.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:m?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Hr,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ir,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Order not found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"The order you're looking for doesn't exist."}),s.jsx("div",{className:"mt-6",children:s.jsxs("button",{onClick:()=>e("/orders/list"),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(Jt,{className:"w-4 h-4 mr-2"}),"Back to Orders"]})})]})},_P=()=>{const{orders:t,ordersLoading:e,approveOrder:r}=Hn(),n=cr(),[i,a]=_.useState(""),[o,c]=_.useState("date"),[u,d]=_.useState(!1),m=_.useMemo(()=>t.filter(v=>v.status==="pending"),[t]),p=_.useMemo(()=>m.filter(v=>v.orderNumber.toLowerCase().includes(i.toLowerCase())||v.customerName.toLowerCase().includes(i.toLowerCase())||v.customerEmail.toLowerCase().includes(i.toLowerCase())),[m,i]),x=_.useMemo(()=>[...p].sort((v,y)=>{switch(o){case"date":return new Date(y.orderDate).getTime()-new Date(v.orderDate).getTime();case"amount":return y.totalAmount-v.totalAmount;case"customer":return v.customerName.localeCompare(y.customerName);case"status":return v.status.localeCompare(y.status);default:return 0}}),[p,o]),j=async v=>{if(v){d(!0);try{await r(v,"current-user-id")}catch(y){console.error("Error approving order:",y)}finally{d(!1)}}},I=v=>{switch(v){case"pending":return s.jsx(at,{className:"h-5 w-5 text-yellow-600"});case"approved":return s.jsx(ve,{className:"h-5 w-5 text-green-600"});case"processing":return s.jsx(Rt,{className:"h-5 w-5 text-blue-600"});case"shipped":return s.jsx(ve,{className:"h-5 w-5 text-purple-600"});case"delivered":return s.jsx(ve,{className:"h-5 w-5 text-green-600"});case"cancelled":return s.jsx(rl,{className:"h-5 w-5 text-red-600"});default:return s.jsx(at,{className:"h-5 w-5 text-gray-600"})}},b=v=>{switch(v){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"processing":return"bg-blue-100 text-blue-800";case"shipped":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},R=v=>{switch(v){case"cash":return"Cash";case"credit":return"Credit";case"bank_transfer":return"Bank Transfer";case"mobile_money":return"Mobile Money";default:return v}};return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pending Approvals"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Orders awaiting approval"})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:s.jsx(at,{className:"h-6 w-6 text-yellow-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.length})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(ve,{className:"h-6 w-6 text-green-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Approved Today"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"0"})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(ir,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Value"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n(m.reduce((v,y)=>v+y.totalAmount,0))})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(Xt,{className:"h-6 w-6 text-purple-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Customers"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:new Set(m.map(v=>v.customerId)).size})]})]})})]}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search orders, customers...",value:i,onChange:v=>a(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),s.jsx("div",{className:"flex gap-4",children:s.jsxs("select",{value:o,onChange:v=>c(v.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"date",children:"Sort by Date"}),s.jsx("option",{value:"amount",children:"Sort by Amount"}),s.jsx("option",{value:"customer",children:"Sort by Customer"}),s.jsx("option",{value:"status",children:"Sort by Status"})]})})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(v=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:I(v.status)}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.orderNumber}),s.jsxs("div",{className:"text-sm text-gray-500",children:[v.itemsCount," items"]})]})]})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.customerName}),s.jsx("div",{className:"text-sm text-gray-500",children:v.customerEmail})]}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm text-gray-900",children:new Date(v.orderDate).toLocaleDateString()}),s.jsx("div",{className:"text-sm text-gray-500",children:new Date(v.orderDate).toLocaleTimeString()})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm font-medium text-gray-900",children:n(v.totalAmount)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:R(v.paymentType)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${b(v.status)}`,children:v.status.charAt(0).toUpperCase()+v.status.slice(1)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(xe,{to:`/orders/${v.id}`,className:"text-blue-600 hover:text-blue-900",children:s.jsx(rn,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>j(v.id),disabled:u,className:"text-green-600 hover:text-green-900 disabled:opacity-50",title:"Approve Order",children:s.jsx(ve,{className:"h-4 w-4"})})]})})]},v.id))})]})}),x.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ir,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No pending orders"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:i?"No orders match your search criteria.":"All orders have been processed."})]})]})]})},SP=()=>{const{orders:t,ordersLoading:e}=Hn(),r=cr(),[n,i]=_.useState(""),[a,o]=_.useState("all"),[c,u]=_.useState("all"),[d,m]=_.useState("all"),[p,x]=_.useState("date"),j=_.useMemo(()=>t.filter(N=>{const w=N.orderNumber.toLowerCase().includes(n.toLowerCase())||N.customerName.toLowerCase().includes(n.toLowerCase())||N.customerEmail.toLowerCase().includes(n.toLowerCase()),T=a==="all"||N.status===a,A=c==="all"||N.paymentStatus===c,D=new Date(N.orderDate),C=new Date,S=new Date(C.getFullYear(),C.getMonth(),C.getDate()),H=new Date(S.getTime()-7*24*60*60*1e3),W=new Date(S.getTime()-30*24*60*60*1e3);let re=!0;switch(d){case"today":re=D>=S;break;case"week":re=D>=H;break;case"month":re=D>=W;break;case"custom":re=!0;break}return w&&T&&A&&re}),[t,n,a,c,d]),I=_.useMemo(()=>[...j].sort((N,w)=>{switch(p){case"date":return new Date(w.orderDate).getTime()-new Date(N.orderDate).getTime();case"amount":return w.totalAmount-N.totalAmount;case"customer":return N.customerName.localeCompare(w.customerName);case"status":return N.status.localeCompare(w.status);default:return 0}}),[j,p]),b=N=>{switch(N){case"pending":return s.jsx(at,{className:"h-5 w-5 text-yellow-600"});case"approved":return s.jsx(ve,{className:"h-5 w-5 text-green-600"});case"processing":return s.jsx(Rt,{className:"h-5 w-5 text-blue-600"});case"shipped":return s.jsx(ve,{className:"h-5 w-5 text-purple-600"});case"delivered":return s.jsx(ve,{className:"h-5 w-5 text-green-600"});case"cancelled":return s.jsx(rl,{className:"h-5 w-5 text-red-600"});default:return s.jsx(at,{className:"h-5 w-5 text-gray-600"})}},R=N=>{switch(N){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"processing":return"bg-blue-100 text-blue-800";case"shipped":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},v=N=>{switch(N){case"pending":return"bg-yellow-100 text-yellow-800";case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-blue-100 text-blue-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},y=N=>{switch(N){case"cash":return"Cash";case"credit":return"Credit";case"bank_transfer":return"Bank Transfer";case"mobile_money":return"Mobile Money";default:return N}},f=t.length,E=t.reduce((N,w)=>N+w.totalAmount,0),P=t.filter(N=>N.status==="delivered").length,F=t.filter(N=>N.status==="pending").length;return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Order History"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Complete order history and analytics"})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(ir,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(ve,{className:"h-6 w-6 text-green-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:P})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:s.jsx(at,{className:"h-6 w-6 text-yellow-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(oa,{className:"h-6 w-6 text-purple-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Value"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r(E)})]})]})})]}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search orders, customers...",value:n,onChange:N=>i(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("select",{value:a,onChange:N=>o(N.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"processing",children:"Processing"}),s.jsx("option",{value:"shipped",children:"Shipped"}),s.jsx("option",{value:"delivered",children:"Delivered"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]}),s.jsxs("select",{value:c,onChange:N=>u(N.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"all",children:"All Payment"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"paid",children:"Paid"}),s.jsx("option",{value:"partial",children:"Partial"}),s.jsx("option",{value:"overdue",children:"Overdue"})]}),s.jsxs("select",{value:d,onChange:N=>m(N.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"all",children:"All Time"}),s.jsx("option",{value:"today",children:"Today"}),s.jsx("option",{value:"week",children:"This Week"}),s.jsx("option",{value:"month",children:"This Month"}),s.jsx("option",{value:"custom",children:"Custom Range"})]}),s.jsxs("select",{value:p,onChange:N=>x(N.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"date",children:"Sort by Date"}),s.jsx("option",{value:"amount",children:"Sort by Amount"}),s.jsx("option",{value:"customer",children:"Sort by Customer"}),s.jsx("option",{value:"status",children:"Sort by Status"})]})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I.map(N=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:b(N.status)}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:N.orderNumber}),s.jsxs("div",{className:"text-sm text-gray-500",children:[N.itemsCount," items"]})]})]})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:N.customerName}),s.jsx("div",{className:"text-sm text-gray-500",children:N.customerEmail})]}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm text-gray-900",children:new Date(N.orderDate).toLocaleDateString()}),s.jsx("div",{className:"text-sm text-gray-500",children:new Date(N.orderDate).toLocaleTimeString()})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm font-medium text-gray-900",children:r(N.totalAmount)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-sm text-gray-900",children:y(N.paymentType)}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${v(N.paymentStatus)}`,children:N.paymentStatus.charAt(0).toUpperCase()+N.paymentStatus.slice(1)})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${R(N.status)}`,children:N.status.charAt(0).toUpperCase()+N.status.slice(1)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(xe,{to:`/app/orders/${N.id}`,className:"text-blue-600 hover:text-blue-900",title:"View Order",children:s.jsx(rn,{className:"h-4 w-4"})}),N.status==="pending"&&s.jsx(xe,{to:`/app/orders/edit/${N.id}`,className:"text-green-600 hover:text-green-900",title:"Edit Order",children:s.jsx(Pr,{className:"h-4 w-4"})})]})})]},N.id))})]})}),I.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ir,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No orders found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n?"No orders match your search criteria.":"No orders have been created yet."})]})]})]})},EP=()=>s.jsxs(Wr,{children:[s.jsx(ee,{index:!0,element:s.jsx(O0,{})}),s.jsx(ee,{path:"list",element:s.jsx(O0,{})}),s.jsx(ee,{path:"create",element:s.jsx(bP,{})}),s.jsx(ee,{path:"approvals",element:s.jsx(_P,{})}),s.jsx(ee,{path:"history",element:s.jsx(SP,{})}),s.jsx(ee,{path:":orderId",element:s.jsx(NP,{})}),s.jsx(ee,{path:"edit/:orderId",element:s.jsx(jP,{})}),s.jsx(ee,{path:"*",element:s.jsx(Xs,{to:"/orders",replace:!0})})]}),CP=()=>{var L,U;const{userPermissions:t}=aa(),{currentBusiness:e}=$t(),{orders:r,ordersLoading:n,fetchOrders:i,updatePackerStatus:a,updateTransporterDetails:o,updateCargoReceipt:c}=Hn(),{getProductById:u}=zt(),{businessUsers:d,fetchBusinessUsers:m}=na(),[p,x]=_.useState(null),[j,I]=_.useState(!1),[b,R]=_.useState(""),[v,y]=_.useState(!1),[f,E]=_.useState(!1),[P,F]=_.useState({name:"",phone:"",vehicleNumber:"",company:""}),[N,w]=_.useState({receiptNumber:"",transporterName:"",transporterPhone:"",imageFile:null});if(!((L=t==null?void 0:t.permissions)!=null&&L.includes("prepare_orders")))return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ie,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600",children:"You don't have permission to access the preparation queue."})]})});_.useEffect(()=>{e&&(i(),m())},[e,i,m]);const T=M=>{const V=d.find(z=>z.id===M);return V?V.userName||V.userEmail:"Unknown Packer"},A=r.filter(M=>M.status==="approved"&&M.assignedPacker&&M.deliveryMethod),D=r.filter(M=>["accepted","packing","done_packing","handed_to_delivery"].includes(M.status)),C=async M=>{try{console.log(`PreparationQueue: Starting preparation for order ${M.id} (current status: ${M.status})`),await a(M.id,"accepted"),console.log(`PreparationQueue: Successfully accepted order ${M.id}`),await i()}catch(V){console.error("Failed to accept order:",V),alert(`Failed to accept order: ${V.message||"Unknown error"}`)}},S=async(M,V)=>{try{console.log(`Updating order ${M} to status: ${V}`),await a(M,V),console.log(`Successfully updated order ${M} to ${V}`),await i()}catch(z){console.error("Failed to update packer status:",z),alert(`Failed to update status: ${z.message||"Unknown error"}`)}},H=async M=>{try{await o(M,P),await a(M,"handed_to_delivery"),y(!1),F({name:"",phone:"",vehicleNumber:"",company:""}),await i()}catch(V){console.error("Failed to update transporter details:",V),alert(`Failed to update transporter details: ${V.message||"Unknown error"}`)}},W=async M=>{try{const V={...N,imageUrl:N.imageFile?URL.createObjectURL(N.imageFile):"",uploadedAt:new Date().toISOString()};await c(M,V),E(!1),w({receiptNumber:"",transporterName:"",transporterPhone:"",imageFile:null}),await i()}catch(V){console.error("Failed to update cargo receipt:",V),alert(`Failed to update cargo receipt: ${V.message||"Unknown error"}`)}},re=async()=>{if(p)try{console.log("Completing preparation for order:",p.id),I(!1),x(null),await i()}catch(M){console.error("Error completing preparation:",M)}},ce=M=>({pending:"bg-yellow-100 text-yellow-800",preparing:"bg-blue-100 text-blue-800",prepared:"bg-green-100 text-green-800",delivered:"bg-gray-100 text-gray-800"})[M]||"bg-gray-100 text-gray-800",O=M=>{switch(M){case"pending":return s.jsx(at,{className:"w-4 h-4"});case"preparing":return s.jsx(Ie,{className:"w-4 h-4"});case"prepared":return s.jsx(ve,{className:"w-4 h-4"});default:return s.jsx(Ci,{className:"w-4 h-4"})}};return n?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Preparation Queue"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Orders ready for preparation"})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[A.length," orders ready for preparation",D.length>0&&s.jsxs("span",{className:"ml-4 text-blue-600",children:[D.length," orders in packer workflow"]})]})]}),s.jsx("div",{className:"grid gap-6",children:A.length===0?s.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[s.jsx(Ie,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Orders to Prepare"}),s.jsx("p",{className:"text-gray-600",children:"All orders are prepared or no orders are assigned to you."})]}):A.map(M=>{var V,z;return s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Order #",M.orderNumber]}),s.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${ce(M.status)}`,children:[O(M.status),s.jsx("span",{className:"ml-1",children:M.status.toUpperCase()})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Xt,{className:"w-4 h-4 mr-2"}),s.jsxs("span",{children:["Customer: ",M.customerName]})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Ie,{className:"w-4 h-4 mr-2"}),s.jsxs("span",{children:["Packer: ",T(M.assignedPacker)]})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Wi,{className:"w-4 h-4 mr-2"}),s.jsxs("span",{children:["Delivery: ",M.deliveryMethod]})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Mn,{className:"w-4 h-4 mr-2"}),s.jsxs("span",{children:["Address: ",((V=M.deliveryAddress)==null?void 0:V.city)||"N/A"]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Order Items:"}),s.jsx("div",{className:"space-y-2",children:(z=M.items)==null?void 0:z.map((K,X)=>{const Q=u?u(K.productId):null,ie=Q&&Q.description||K.description;return s.jsxs("div",{className:"flex justify-between items-center text-sm bg-gray-50 px-3 py-2 rounded",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"truncate",children:K.productName||K.name}),ie&&s.jsx("div",{className:"text-xs text-gray-500 truncate",children:ie})]}),s.jsxs("span",{className:"font-medium whitespace-nowrap",children:["Qty: ",K.quantity]})]},X)})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-500",children:["Created: ",new Date(M.createdAt).toLocaleDateString()]}),s.jsx("div",{className:"flex space-x-2",children:s.jsx("button",{onClick:()=>C(M),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"Accept Order"})})]})]})})},M.id)})}),D.length>0&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Orders in Progress"}),D.map(M=>{var V,z;return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsx("div",{className:"flex items-start justify-between mb-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Order #",M.orderNumber]}),s.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${ce(M.status)}`,children:[O(M.status),s.jsx("span",{className:"ml-1",children:M.status.replace("_"," ").toUpperCase()})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Xt,{className:"w-4 h-4 mr-2"}),s.jsx("span",{children:M.customerName})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Ie,{className:"w-4 h-4 mr-2"}),s.jsx("span",{children:T(M.assignedPacker)})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Wi,{className:"w-4 h-4 mr-2"}),s.jsx("span",{children:(V=M.deliveryMethod)==null?void 0:V.replace("_"," ")})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Mn,{className:"w-4 h-4 mr-2"}),s.jsx("span",{children:M.deliveryAddress?"Address provided":"N/A"})]})]})]})}),s.jsx("div",{className:"mb-6",children:s.jsx("div",{className:"flex items-center justify-between",children:[{key:"accepted",label:"Accept",icon:""},{key:"packing",label:"Packing",icon:""},{key:"done_packing",label:"Done Packing",icon:""},{key:M.deliveryMethod==="cargo_delivery"?"transported":"handed_to_delivery",label:M.deliveryMethod==="cargo_delivery"?"Transport":M.deliveryMethod==="customer_pickup"?"Handed to Customer":"Handed to Delivery",icon:M.deliveryMethod==="cargo_delivery"?"":M.deliveryMethod==="customer_pickup"?"":""}].map(K=>{const X=M.status===K.key,Q=["approved","accepted","packing","done_packing","handed_to_delivery","transported"],ie=Q.indexOf(M.status),ye=Q.indexOf(K.key),_e=ie>ye,Ue=ie>=0&&ye<=ie+1&&M.status!=="transported"&&!(M.status==="handed_to_delivery"&&K.key!=="transported");return console.log(`Step ${K.key}: isActive=${X}, isCompleted=${_e}, canActivate=${Ue}, currentStatus=${M.status}`),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("button",{onClick:()=>{Ue?K.key==="done_packing"&&M.deliveryMethod==="local_delivery"?(x(M),y(!0)):K.key==="done_packing"&&M.deliveryMethod==="customer_pickup"?S(M.id,"handed_to_delivery"):K.key==="transported"&&M.deliveryMethod==="cargo_delivery"?(x(M),E(!0)):S(M.id,K.key):(console.log(`Cannot activate ${K.key} from current status ${M.status}`),alert(`Cannot transition to ${K.label} from current status ${M.status}`))},disabled:!Ue,className:`w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold transition-all duration-200 ${X?"bg-blue-600 text-white shadow-lg":_e?"bg-green-600 text-white":Ue?"bg-gray-200 text-gray-600 hover:bg-gray-300 cursor-pointer":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:K.icon}),s.jsx("span",{className:`text-xs mt-2 text-center ${X?"text-blue-600 font-semibold":_e?"text-green-600":Ue?"text-gray-600":"text-gray-400"}`,children:K.label})]},K.key)})})}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Order Items:"}),s.jsx("div",{className:"space-y-2",children:(z=M.items)==null?void 0:z.map((K,X)=>{const Q=u?u(K.productId):null,ie=Q&&Q.description||K.description;return s.jsxs("div",{className:"flex justify-between items-center text-sm bg-gray-50 px-3 py-2 rounded",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"truncate",children:K.productName||K.name}),ie&&s.jsx("div",{className:"text-xs text-gray-500 truncate",children:ie})]}),s.jsxs("span",{className:"font-medium whitespace-nowrap",children:["Qty: ",K.quantity]})]},X)})})]}),s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"text-sm text-gray-500",children:["Created: ",new Date(M.createdAt).toLocaleDateString()]})})]},M.id)})]}),j&&p&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Prepare Order #",p.orderNumber]})}),s.jsx("div",{className:"px-6 py-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preparation Status"}),s.jsxs("select",{value:b,onChange:M=>R(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"preparing",children:"Preparing"}),s.jsx("option",{value:"prepared",children:"Prepared"}),s.jsx("option",{value:"ready_for_delivery",children:"Ready for Delivery"})]})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Customer:"})," ",p.customerName]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Items:"})," ",((U=p.items)==null?void 0:U.length)||0," items"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Delivery:"})," ",p.deliveryMethod]})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:re,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Complete Preparation"})]})]})}),v&&p&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center p-4",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:(p==null?void 0:p.deliveryMethod)==="customer_pickup"?"Customer Pickup Details":"Transporter Details"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:(p==null?void 0:p.deliveryMethod)==="customer_pickup"?"Customer Name *":"Transporter Name *"}),s.jsx("input",{type:"text",value:P.name,onChange:M=>F(V=>({...V,name:M.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:(p==null?void 0:p.deliveryMethod)==="customer_pickup"?"Enter customer name":"Enter transporter name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),s.jsx("input",{type:"tel",value:P.phone,onChange:M=>F(V=>({...V,phone:M.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter phone number"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:(p==null?void 0:p.deliveryMethod)==="customer_pickup"?"Vehicle Number (Optional)":"Vehicle Number *"}),s.jsx("input",{type:"text",value:P.vehicleNumber,onChange:M=>F(V=>({...V,vehicleNumber:M.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:(p==null?void 0:p.deliveryMethod)==="customer_pickup"?"Enter vehicle number (if applicable)":"Enter vehicle number"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company (Optional)"}),s.jsx("input",{type:"text",value:P.company,onChange:M=>F(V=>({...V,company:M.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter company name"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[s.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),s.jsx("button",{onClick:()=>H(p.id),disabled:!P.name||!P.phone||(p==null?void 0:p.deliveryMethod)!=="customer_pickup"&&!P.vehicleNumber,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:(p==null?void 0:p.deliveryMethod)==="customer_pickup"?"Hand to Customer":"Hand to Delivery"})]})]})})}),f&&p&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center p-4",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cargo Receipt Details"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt Number *"}),s.jsx("input",{type:"text",value:N.receiptNumber,onChange:M=>w(V=>({...V,receiptNumber:M.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter receipt number"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transporter Name *"}),s.jsx("input",{type:"text",value:N.transporterName,onChange:M=>w(V=>({...V,transporterName:M.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter transporter name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transporter Phone *"}),s.jsx("input",{type:"tel",value:N.transporterPhone,onChange:M=>w(V=>({...V,transporterPhone:M.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter phone number"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt Image *"}),s.jsx("input",{type:"file",accept:"image/*",onChange:M=>w(V=>{var z;return{...V,imageFile:((z=M.target.files)==null?void 0:z[0])||null}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload a photo of the cargo receipt"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[s.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),s.jsx("button",{onClick:()=>W(p.id),disabled:!N.receiptNumber||!N.transporterName||!N.transporterPhone||!N.imageFile,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:"Complete Transport"})]})]})})})]})},kP=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Preparation Management"}),s.jsx("p",{className:"text-gray-600",children:"Manage order preparation and packing"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ie,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Preparation Dashboard"}),s.jsx("p",{className:"text-gray-600",children:"Order preparation and packing management will be implemented here"})]})})]}),IP=()=>s.jsxs(Wr,{children:[s.jsx(ee,{index:!0,element:s.jsx(kP,{})}),s.jsx(ee,{path:"queue",element:s.jsx(CP,{})}),s.jsx(ee,{path:"assignments",element:s.jsx("div",{children:"My Assignments"})}),s.jsx(ee,{path:"history",element:s.jsx("div",{children:"Preparation History"})})]}),TP=()=>{const{products:t,productsLoading:e,deleteProduct:r}=zt(),n=cr(),[i,a]=_.useState(""),[o,c]=_.useState("all"),[u,d]=_.useState("all"),[m,p]=_.useState("name"),[x,j]=_.useState(null),I=_.useMemo(()=>Array.from(new Set(t.map(f=>f.category))).filter(Boolean),[t]),b=_.useMemo(()=>t.filter(f=>{const E=f.name.toLowerCase().includes(i.toLowerCase())||f.sku.toLowerCase().includes(i.toLowerCase())||f.description.toLowerCase().includes(i.toLowerCase())||f.barcode&&f.barcode.includes(i),P=o==="all"||f.category===o,F=u==="all"||u==="active"&&f.isActive||u==="inactive"&&!f.isActive;return E&&P&&F}),[t,i,o,u]),R=_.useMemo(()=>[...b].sort((f,E)=>{var P,F,N,w;switch(m){case"name":return f.name.localeCompare(E.name);case"sku":return f.sku.localeCompare(E.sku);case"price":return E.unitPrice-f.unitPrice;case"date":return new Date(((F=(P=E.createdAt)==null?void 0:P.toDate)==null?void 0:F.call(P))||E.createdAt).getTime()-new Date(((w=(N=f.createdAt)==null?void 0:N.toDate)==null?void 0:w.call(N))||f.createdAt).getTime();default:return 0}}),[b,m]),v=async f=>{try{await r(f),j(null)}catch(E){console.error("Error deleting product:",E)}},y=f=>n(f);return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Product Catalog"}),s.jsx("p",{className:"text-gray-600",children:"Manage your product inventory"})]}),s.jsxs(xe,{to:"/inventory/products/add",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Product"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Ie,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Products"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ve,{className:"h-6 w-6 text-green-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Products"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(f=>f.isActive).length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Ie,{className:"h-6 w-6 text-purple-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Categories"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:I.length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Rt,{className:"h-6 w-6 text-yellow-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Inactive Products"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(f=>!f.isActive).length})]})})]})})})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search products...",value:i,onChange:f=>a(f.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{value:o,onChange:f=>c(f.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Categories"}),I.map(f=>s.jsx("option",{value:f,children:f},f))]}),s.jsxs("select",{value:u,onChange:f=>d(f.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"inactive",children:"Inactive"})]}),s.jsxs("select",{value:m,onChange:f=>p(f.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"name",children:"Sort by Name"}),s.jsx("option",{value:"sku",children:"Sort by SKU"}),s.jsx("option",{value:"price",children:"Sort by Price"}),s.jsx("option",{value:"date",children:"Sort by Date"})]})]})]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:R.map(f=>s.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:f.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["SKU: ",f.sku]}),f.barcode&&s.jsxs("p",{className:"text-sm text-gray-500",children:["Barcode: ",f.barcode]})]}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:f.isActive?"Active":"Inactive"})]}),s.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:f.description}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"Category:"}),s.jsx("span",{className:"text-gray-900",children:f.category})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"Unit Price:"}),s.jsx("span",{className:"text-gray-900 font-medium",children:y(f.unitPrice)})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"Cost Price:"}),s.jsx("span",{className:"text-gray-900",children:y(f.costPrice)})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"Unit:"}),s.jsx("span",{className:"text-gray-900",children:f.unit})]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(xe,{to:`/inventory/products/${f.id}`,className:"text-blue-600 hover:text-blue-900",children:s.jsx(rn,{className:"h-4 w-4"})}),s.jsx(xe,{to:`/inventory/products/edit/${f.id}`,className:"text-indigo-600 hover:text-indigo-900",children:s.jsx(Pr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>j(f.id||""),className:"text-red-600 hover:text-red-900",children:s.jsx(Tt,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Min Stock"}),s.jsx("div",{className:"text-sm font-medium",children:f.minStockLevel})]})]})]})},f.id))}),R.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ie,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No products found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:i||o!=="all"||u!=="all"?"Try adjusting your search or filter criteria.":"Get started by adding your first product."}),!i&&o==="all"&&u==="all"&&s.jsx("div",{className:"mt-6",children:s.jsxs(xe,{to:"/inventory/products/add",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Product"]})})]}),x&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:s.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:s.jsxs("div",{className:"mt-3 text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:s.jsx(Tt,{className:"h-6 w-6 text-red-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mt-4",children:"Delete Product"}),s.jsx("div",{className:"mt-2 px-7 py-3",children:s.jsx("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this product? This action cannot be undone and will remove all associated stock data."})}),s.jsxs("div",{className:"items-center px-4 py-3",children:[s.jsx("button",{onClick:()=>j(null),className:"px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md shadow-sm hover:bg-gray-400 mr-2",children:"Cancel"}),s.jsx("button",{onClick:()=>v(x),className:"px-4 py-2 bg-red-600 text-white text-base font-medium rounded-md shadow-sm hover:bg-red-700",children:"Delete"})]})]})})})]})},AP=()=>{const{productId:t}=Bn(),e=Zt(),{getProductById:r,stockItems:n,stores:i}=zt(),a=cr(),[o,c]=_.useState(null),[u,d]=_.useState({}),[m,p]=_.useState(!0);if(_.useEffect(()=>{(async()=>{if(!t){p(!1);return}p(!0);try{const b=r(t);c(b||null)}catch(b){console.error("Error loading product:",b),c(null)}finally{p(!1)}})()},[t,r]),_.useEffect(()=>{if(t&&n.length>0){const I={};n.forEach(b=>{b.productId===t&&(I[b.storeId]=b)}),d(I)}},[t,n]),m)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!o)return s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ie,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Product not found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"The product you're looking for doesn't exist or has been deleted."}),s.jsx("div",{className:"mt-6",children:s.jsxs(xe,{to:"/app/inventory/products",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(Jt,{className:"w-4 h-4 mr-2"}),"Back to Products"]})})]});const x=Object.values(u).reduce((I,b)=>I+((b==null?void 0:b.currentStock)||0),0),j=Object.values(u).filter(I=>I&&I.currentStock<=o.minStockLevel);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>e(-1),className:"p-2 text-gray-400 hover:text-gray-600",children:s.jsx(Jt,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:o.name}),s.jsx("p",{className:"text-gray-600",children:"Product Details"})]})]}),s.jsxs(xe,{to:`/app/inventory/products/edit/${o.id}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(Pr,{className:"w-4 h-4 mr-2"}),"Edit Product"]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Product Information"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"SKU:"}),s.jsx("span",{className:"font-medium",children:o.sku})]}),o.barcode&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Barcode:"}),s.jsx("span",{className:"font-medium",children:o.barcode})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Category:"}),s.jsx("span",{className:"font-medium",children:o.category})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Unit:"}),s.jsx("span",{className:"font-medium",children:o.unit})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Status:"}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${o.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:o.isActive?"Active":"Inactive"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pricing"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Unit Price:"}),s.jsx("span",{className:"font-medium text-lg",children:a(o.unitPrice)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Cost Price:"}),s.jsx("span",{className:"font-medium",children:a(o.costPrice)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Profit Margin:"}),s.jsx("span",{className:"font-medium text-green-600",children:a(o.unitPrice-o.costPrice)})]})]})]})]}),o.description&&s.jsxs("div",{className:"mt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Description"}),s.jsx("p",{className:"text-gray-600",children:o.description})]}),o.tags&&o.tags.length>0&&s.jsxs("div",{className:"mt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tags"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:o.tags.map((I,b)=>s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:I},b))})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(pt,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Stock Information"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Ie,{className:"h-8 w-8 text-blue-600"}),s.jsxs("div",{className:"ml-3",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Total Stock"}),s.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[x," ",o.unit]})]})]})}),s.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ve,{className:"h-8 w-8 text-green-600"}),s.jsxs("div",{className:"ml-3",children:[s.jsx("p",{className:"text-sm font-medium text-green-900",children:"In Stock Stores"}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:Object.values(u).filter(I=>I&&I.currentStock>0).length})]})]})}),s.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Rt,{className:"h-8 w-8 text-yellow-600"}),s.jsxs("div",{className:"ml-3",children:[s.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Low Stock Stores"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:j.length})]})]})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Stock by Store"}),i.length===0?s.jsx("p",{className:"text-gray-500 text-sm",children:"No stores available."}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(I=>{const b=u[I.id],R=(b==null?void 0:b.currentStock)||0,v=R<=o.minStockLevel;return s.jsxs("div",{className:`border rounded-lg p-4 ${v?"border-yellow-200 bg-yellow-50":"border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:I.name}),s.jsx("p",{className:"text-sm text-gray-500",children:I.type==="main"?"Main Store":"Sub-Store"})]}),s.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${I.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:I.isActive?"Active":"Inactive"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Current Stock:"}),s.jsxs("span",{className:`font-medium ${v?"text-yellow-600":"text-gray-900"}`,children:[R," ",o.unit]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Min Level:"}),s.jsxs("span",{className:"text-sm text-gray-900",children:[o.minStockLevel," ",o.unit]})]}),v&&s.jsxs("div",{className:"flex items-center text-yellow-600 text-sm",children:[s.jsx(Rt,{className:"h-4 w-4 mr-1"}),"Low Stock Alert"]})]})]},I.id)})})]})]})]})},L0=()=>{const{productId:t}=Bn(),e=Zt(),{products:r,stores:n,stockItems:i,addProduct:a,updateProduct:o,getProductById:c,updateStock:u}=zt(),[d,m]=_.useState(!1),[p,x]=_.useState(""),[j,I]=_.useState(!1),[b,R]=_.useState({}),[v,y]=_.useState(!1),[f,E]=_.useState({storeId:"",quantity:0}),[P,F]=_.useState({name:"",description:"",category:"",sku:"",barcode:"",unitPrice:0,costPrice:0,unit:"pcs",minStockLevel:0,maxStockLevel:0,isActive:!0,tags:"",initialStock:[]}),N=["Electronics","Clothing","Food & Beverages","Books","Home & Garden","Sports & Outdoors","Health & Beauty","Automotive","Office Supplies","Toys & Games","Other"],w=["pcs","kg","lbs","g","oz","L","ml","m","ft","box","pack","dozen"];_.useEffect(()=>{var O;if(t){I(!0);const L=c(t);L&&(F({name:L.name,description:L.description,category:L.category,sku:L.sku,barcode:L.barcode||"",unitPrice:L.unitPrice,costPrice:L.costPrice,unit:L.unit,minStockLevel:L.minStockLevel,maxStockLevel:L.maxStockLevel,isActive:L.isActive,tags:((O=L.tags)==null?void 0:O.join(", "))||"",initialStock:[]}),T(t))}},[t,c]);const T=O=>{const L={};i.forEach(U=>{U.productId===O&&(L[U.storeId]=U.currentStock)}),R(L)},A=async(O,L)=>{if(t){R(U=>({...U,[O]:L})),y(!0);try{const U=i.find(M=>M.productId===t&&M.storeId===O);U!=null&&U.id&&await u(U.id,{currentStock:L,availableStock:L})}catch(U){console.error("Error updating stock:",U),x("Failed to update stock"),R(M=>{var V;return{...M,[O]:((V=i.find(z=>z.productId===t&&z.storeId===O))==null?void 0:V.currentStock)||0}})}finally{y(!1)}}},D=O=>{const{name:L,value:U,type:M}=O.target;F(V=>({...V,[L]:M==="checkbox"?O.target.checked:M==="number"?parseFloat(U)||0:U}))},C=()=>{const O=P.category.substring(0,3).toUpperCase(),L=Math.floor(Math.random()*1e4).toString().padStart(4,"0"),U=`${O}-${L}`;F(M=>({...M,sku:U}))},S=()=>{const O=Math.floor(Math.random()*9e12)+1e12;F(L=>({...L,barcode:O.toString()}))},H=()=>{f.storeId&&f.quantity>0&&(F(O=>({...O,initialStock:[...O.initialStock,{...f}]})),E({storeId:"",quantity:0}))},W=O=>{F(L=>({...L,initialStock:L.initialStock.filter((U,M)=>M!==O)}))},re=()=>P.name.trim()?P.category?P.sku.trim()?P.unitPrice<=0?(x("Unit price must be greater than 0"),!1):P.costPrice<0?(x("Cost price cannot be negative"),!1):P.minStockLevel<0?(x("Minimum stock level cannot be negative"),!1):P.maxStockLevel<P.minStockLevel?(x("Maximum stock level must be greater than minimum stock level"),!1):!j&&r.some(O=>O.sku===P.sku)?(x("SKU already exists"),!1):!0:(x("SKU is required"),!1):(x("Category is required"),!1):(x("Product name is required"),!1),ce=async O=>{if(O.preventDefault(),!!re()){m(!0),x("");try{const L={...P,tags:P.tags?P.tags.split(",").map(U=>U.trim()).filter(Boolean):[]};P.barcode||delete L.barcode,j&&t?(await o(t,L),e("/app/inventory/products",{state:{message:"Product updated successfully!"}})):(await a(L),e("/app/inventory/products",{state:{message:"Product added successfully!"}}))}catch(L){console.error("Error saving product:",L),x(L.message||"Failed to save product")}finally{m(!1)}}};return s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>e("/app/inventory/products"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Jt,{className:"h-5 w-5 text-gray-600"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:j?"Edit Product":"Add New Product"}),s.jsx("p",{className:"text-gray-600",children:j?"Update product information":"Create a new product in your catalog"})]})]}),p&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:p}),s.jsxs("form",{onSubmit:ce,className:"space-y-6",children:[s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(Ie,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Basic Information"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name *"}),s.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:P.name,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter product name"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{id:"description",name:"description",rows:3,value:P.description,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter product description"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),s.jsxs("select",{id:"category",name:"category",required:!0,value:P.category,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Select category"}),N.map(O=>s.jsx("option",{value:O,children:O},O))]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"unit",className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit *"}),s.jsx("select",{id:"unit",name:"unit",required:!0,value:P.unit,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:w.map(O=>s.jsx("option",{value:O,children:O},O))})]})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(Ie,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Product Codes"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"sku",className:"block text-sm font-medium text-gray-700 mb-2",children:"SKU (Stock Keeping Unit) *"}),s.jsx("input",{type:"text",id:"sku",name:"sku",required:!0,value:P.sku,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 mb-2",placeholder:"Enter SKU"}),s.jsx("button",{type:"button",onClick:C,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:"Generate SKU"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"barcode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Barcode (Optional)"}),s.jsx("input",{type:"text",id:"barcode",name:"barcode",value:P.barcode,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 mb-2",placeholder:"Enter barcode"}),s.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:"Generate Barcode"})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(rp,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Pricing"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"unitPrice",className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit Price (Selling Price) *"}),s.jsx("input",{type:"number",id:"unitPrice",name:"unitPrice",required:!0,min:"0",step:"0.01",value:P.unitPrice,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"costPrice",className:"block text-sm font-medium text-gray-700 mb-2",children:"Cost Price (Purchase Price)"}),s.jsx("input",{type:"number",id:"costPrice",name:"costPrice",min:"0",step:"0.01",value:P.costPrice,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]})]})]}),!j&&s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(Ie,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Initial Stock"})]}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Add Stock to Store"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"newStoreId",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Store"}),s.jsxs("select",{id:"newStoreId",value:f.storeId,onChange:O=>E(L=>({...L,storeId:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Select store"}),n.map(O=>s.jsxs("option",{value:O.id,children:[O.name," (",O.type==="main"?"Main Store":"Sub-Store",")"]},O.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"newQuantity",className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity"}),s.jsx("input",{type:"number",id:"newQuantity",min:"0",value:f.quantity,onChange:O=>E(L=>({...L,quantity:parseInt(O.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),s.jsx("div",{className:"flex items-end",children:s.jsx("button",{type:"button",onClick:H,disabled:!f.storeId||f.quantity<=0,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add Stock"})})]})]}),P.initialStock.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Stock Entries"}),s.jsx("div",{className:"space-y-2",children:P.initialStock.map((O,L)=>{const U=n.find(M=>M.id===O.storeId);return s.jsxs("div",{className:"flex items-center justify-between bg-white border border-gray-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"font-medium text-gray-900",children:(U==null?void 0:U.name)||"Unknown Store"}),s.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",(U==null?void 0:U.type)==="main"?"Main Store":"Sub-Store",")"]}),s.jsxs("span",{className:"text-sm text-gray-600 ml-4",children:["Quantity: ",O.quantity," ",P.unit]})]}),s.jsx("button",{type:"button",onClick:()=>W(L),className:"text-red-600 hover:text-red-800 p-1",children:s.jsx(Hi,{className:"h-4 w-4"})})]},L)})})]}),P.initialStock.length===0&&s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-gray-500 text-sm",children:"No initial stock added yet"}),s.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Add stock to one or more stores above"})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(Rt,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Stock Management"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"minStockLevel",className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Stock Level"}),s.jsx("input",{type:"number",id:"minStockLevel",name:"minStockLevel",min:"0",value:P.minStockLevel,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"0"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Alert when stock falls below this level"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"maxStockLevel",className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Stock Level"}),s.jsx("input",{type:"number",id:"maxStockLevel",name:"maxStockLevel",min:"0",value:P.maxStockLevel,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"0"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Maximum recommended stock level"})]})]})]}),j&&s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(Ie,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Current Stock by Store"})]}),s.jsxs("div",{className:"space-y-4",children:[n.length===0?s.jsx("p",{className:"text-gray-500 text-sm",children:"No stores available. Please add stores first."}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(O=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900",children:O.name}),s.jsx("p",{className:"text-sm text-gray-500",children:O.type==="main"?"Main Store":"Sub-Store"})]}),s.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${O.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:O.isActive?"Active":"Inactive"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"number",min:"0",value:b[O.id]||0,onChange:L=>{const U=parseInt(L.target.value)||0;A(O.id,U)},disabled:v,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50"}),s.jsx("span",{className:"text-sm text-gray-500",children:P.unit})]}),b[O.id]!==void 0&&s.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Current: ",b[O.id]," ",P.unit]})]},O.id))}),s.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Note:"})," Stock quantities are updated immediately when you change the values above. Use inventory transfers to move stock between stores."]})})]})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),s.jsx("input",{type:"text",id:"tags",name:"tags",value:P.tags,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter tags separated by commas"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Separate multiple tags with commas"})]}),s.jsx("div",{className:"flex items-center",children:s.jsxs("div",{className:"flex items-center h-5",children:[s.jsx("input",{id:"isActive",name:"isActive",type:"checkbox",checked:P.isActive,onChange:D,className:"focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Active Product"})]})})]})}),s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx("button",{type:"button",onClick:()=>e("/app/inventory/products"),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),s.jsxs("button",{type:"submit",disabled:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[d?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):s.jsx(Hr,{className:"h-4 w-4 mr-2"}),d?j?"Updating Product...":"Adding Product...":j?"Update Product":"Add Product"]})]})]})]})},PP=()=>{const{stockItems:t,stockLoading:e,products:r,stores:n,getProductById:i,getLowStockItems:a}=zt(),[o,c]=_.useState(""),[u,d]=_.useState("all"),[m,p]=_.useState("all"),[x,j]=_.useState("name"),I=cr(),b=_.useMemo(()=>n.find(w=>w.type==="main"),[n]),R=_.useMemo(()=>t.filter(w=>w.storeId===(b==null?void 0:b.id)),[t,b==null?void 0:b.id]),v=_.useMemo(()=>Array.from(new Set(r.map(w=>w.category))).filter(Boolean),[r]),y=_.useMemo(()=>a(b==null?void 0:b.id),[a,b==null?void 0:b.id,t,r]),P=[..._.useMemo(()=>R.map(w=>{const T=i(w.productId);return{...w,product:T}}).filter(w=>w.product),[R,r]).filter(w=>{const T=w.product,A=T.name.toLowerCase().includes(o.toLowerCase())||T.sku.toLowerCase().includes(o.toLowerCase())||T.category.toLowerCase().includes(o.toLowerCase()),D=u==="all"||T.category===u;let C=!0;if(m!=="all")switch(m){case"low":C=w.currentStock<=T.minStockLevel;break;case"out":C=w.currentStock===0;break;case"good":C=w.currentStock>T.minStockLevel;break}return A&&D&&C})].sort((w,T)=>{const A=w.product,D=T.product;switch(x){case"name":return A.name.localeCompare(D.name);case"stock":return w.currentStock-T.currentStock;case"category":return A.category.localeCompare(D.category);default:return 0}}),F=(w,T)=>w===0?{status:"Out of Stock",color:"text-red-600",bg:"bg-red-100"}:w<=T?{status:"Low Stock",color:"text-yellow-600",bg:"bg-yellow-100"}:{status:"In Stock",color:"text-green-600",bg:"bg-green-100"},N=w=>I(w);return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):b?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Main Store Inventory"}),s.jsxs("p",{className:"text-gray-600",children:[b.name," - ",b.address]})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs(xe,{to:"/app/inventory/transfers",className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[s.jsx(ki,{className:"w-4 h-4 mr-2"}),"Transfers"]}),s.jsxs(xe,{to:"/app/inventory/products/add",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Product"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Ie,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Items"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:R.length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ve,{className:"h-6 w-6 text-green-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"In Stock"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:R.filter(w=>w.currentStock>0).length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Rt,{className:"h-6 w-6 text-yellow-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Low Stock"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:y.length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(oa,{className:"h-6 w-6 text-red-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Out of Stock"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:R.filter(w=>w.currentStock===0).length})]})})]})})})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search inventory...",value:o,onChange:w=>c(w.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{value:u,onChange:w=>d(w.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Categories"}),v.map(w=>s.jsx("option",{value:w,children:w},w))]}),s.jsxs("select",{value:m,onChange:w=>p(w.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Stock Levels"}),s.jsx("option",{value:"good",children:"Good Stock"}),s.jsx("option",{value:"low",children:"Low Stock"}),s.jsx("option",{value:"out",children:"Out of Stock"})]}),s.jsxs("select",{value:x,onChange:w=>j(w.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"name",children:"Sort by Name"}),s.jsx("option",{value:"stock",children:"Sort by Stock"}),s.jsx("option",{value:"category",children:"Sort by Category"})]})]})]})}),s.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Current Stock"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reserved"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Available"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(w=>{const T=w.product,A=F(w.currentStock,T.minStockLevel);return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:s.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx("span",{className:"text-sm font-medium text-blue-600",children:T.name.charAt(0)})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:["SKU: ",T.sku]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:T.category}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-sm text-gray-900 mr-2",children:w.currentStock}),s.jsx("span",{className:"text-sm text-gray-500",children:T.unit})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Min: ",T.minStockLevel," | Max: ",T.maxStockLevel]})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:w.reservedStock}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:w.availableStock}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N(T.unitPrice)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${A.bg} ${A.color}`,children:A.status})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(xe,{to:`/app/inventory/products/edit/${T.id}`,className:"text-blue-600 hover:text-blue-900",children:s.jsx(Pr,{className:"h-4 w-4"})}),s.jsx(xe,{to:`/app/inventory/products/${T.id}`,className:"text-indigo-600 hover:text-indigo-900",children:s.jsx(ki,{className:"h-4 w-4"})})]})})]},w.id)})})]})}),P.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ie,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No inventory found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:o||u!=="all"||m!=="all"?"Try adjusting your search or filter criteria.":"No products have been added to the main store inventory yet."}),!o&&u==="all"&&m==="all"&&s.jsx("div",{className:"mt-6",children:s.jsxs(xe,{to:"/app/inventory/products/add",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Product"]})})]})]})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ie,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No Main Store Found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Please configure your main store in the store settings."})]})},RP=()=>{var N,w,T;const{transfers:t,transfersLoading:e,products:r,stores:n,getStoreById:i,getProductById:a,updateTransferStatus:o}=zt(),[c,u]=_.useState(""),[d,m]=_.useState("all"),[p,x]=_.useState("date"),[j,I]=_.useState(null),[b,R]=_.useState(!1),v=_.useMemo(()=>t.filter(A=>{var re;const D=a(A.productId),C=i(A.fromStoreId),S=i(A.toStoreId),H=(D==null?void 0:D.name.toLowerCase().includes(c.toLowerCase()))||(C==null?void 0:C.name.toLowerCase().includes(c.toLowerCase()))||(S==null?void 0:S.name.toLowerCase().includes(c.toLowerCase()))||((re=A.notes)==null?void 0:re.toLowerCase().includes(c.toLowerCase())),W=d==="all"||A.status===d;return H&&W}),[t,c,d,r,n]),y=_.useMemo(()=>[...v].sort((A,D)=>{switch(p){case"date":return new Date(D.requestedAt).getTime()-new Date(A.requestedAt).getTime();case"status":return A.status.localeCompare(D.status);case"quantity":return D.quantity-A.quantity;default:return 0}}),[v,p]),f=A=>{switch(A){case"pending":return s.jsx(at,{className:"h-4 w-4 text-yellow-600"});case"in-transit":return s.jsx(Wi,{className:"h-4 w-4 text-blue-600"});case"completed":return s.jsx(ve,{className:"h-4 w-4 text-green-600"});case"cancelled":return s.jsx(Hi,{className:"h-4 w-4 text-red-600"});default:return s.jsx(Ci,{className:"h-4 w-4 text-gray-600"})}},E=A=>{switch(A){case"pending":return"bg-yellow-100 text-yellow-800";case"in-transit":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},P=async A=>{if(j)try{await o(j.id,A),R(!1),I(null)}catch(D){console.error("Error updating transfer status:",D)}},F=A=>new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory Transfers"}),s.jsx("p",{className:"text-gray-600",children:"Manage product transfers between stores"})]}),s.jsxs(xe,{to:"/app/inventory/transfers/create",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"New Transfer"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ki,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Transfers"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(at,{className:"h-6 w-6 text-yellow-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(A=>A.status==="pending").length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Wi,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"In Transit"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(A=>A.status==="in-transit").length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ve,{className:"h-6 w-6 text-green-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Completed"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(A=>A.status==="completed").length})]})})]})})})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search transfers...",value:c,onChange:A=>u(A.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{value:d,onChange:A=>m(A.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"in-transit",children:"In Transit"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]}),s.jsxs("select",{value:p,onChange:A=>x(A.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"date",children:"Sort by Date"}),s.jsx("option",{value:"status",children:"Sort by Status"}),s.jsx("option",{value:"quantity",children:"Sort by Quantity"})]})]})]})}),s.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transfer Details"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Requested"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(A=>{const D=a(A.productId),C=i(A.fromStoreId),S=i(A.toStoreId);return!D||!C||!S?null:s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:s.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx(Ie,{className:"h-5 w-5 text-blue-600"})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:["SKU: ",D.sku]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-medium",children:C.name}),s.jsx(ki,{className:"h-4 w-4 mx-2 text-gray-400"}),s.jsx("span",{className:"font-medium",children:S.name})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[C.type==="main"?"Main Store":"Sub Store","  ",S.type==="main"?"Main Store":"Sub Store"]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[A.quantity," ",D.unit]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[f(A.status),s.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${E(A.status)}`,children:A.status.charAt(0).toUpperCase()+A.status.slice(1).replace("-"," ")})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F(A.requestedAt)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsx("button",{onClick:()=>{I(A),R(!0)},className:"text-blue-600 hover:text-blue-900",children:"Manage"})})]},A.id)})})]})}),y.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ki,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No transfers found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:c||d!=="all"?"Try adjusting your search or filter criteria.":"No inventory transfers have been created yet."}),!c&&d==="all"&&s.jsx("div",{className:"mt-6",children:s.jsxs(xe,{to:"/app/inventory/transfers/create",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Create Transfer"]})})]})]}),b&&j&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:s.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:s.jsxs("div",{className:"mt-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Manage Transfer"}),s.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(Hi,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Product:"})," ",(N=a(j.productId))==null?void 0:N.name]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"From:"})," ",(w=i(j.fromStoreId))==null?void 0:w.name]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"To:"})," ",(T=i(j.toStoreId))==null?void 0:T.name]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Quantity:"})," ",j.quantity]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Status:"})," ",j.status]})]}),j.notes&&s.jsx("div",{children:s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Notes:"})," ",j.notes]})}),s.jsxs("div",{className:"flex space-x-2",children:[j.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>P("in-transit"),className:"flex-1 px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700",children:"Approve & Ship"}),s.jsx("button",{onClick:()=>P("cancelled"),className:"flex-1 px-3 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700",children:"Cancel"})]}),j.status==="in-transit"&&s.jsx("button",{onClick:()=>P("completed"),className:"flex-1 px-3 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700",children:"Mark Complete"})]})]})]})})})]})},DP=()=>{const{products:t,stores:e,stockItems:r,createTransfer:n}=zt(),i=Zt(),[a,o]=_.useState(""),[c,u]=_.useState(""),[d,m]=_.useState(""),[p,x]=_.useState(""),[j,I]=_.useState(""),[b,R]=_.useState(!1),v=_.useMemo(()=>{if(!a||!d)return 0;const E=r.find(P=>P.storeId===a&&P.productId===d);return(E==null?void 0:E.availableStock)??(E==null?void 0:E.currentStock)??0},[r,a,d]),y=a&&c&&d&&p&&a!==c&&Number(p)>0&&Number(p)<=v,f=async()=>{if(y){R(!0);try{await n({fromStoreId:a,toStoreId:c,productId:d,quantity:Number(p),status:"pending",requestedBy:"system",requestedAt:new Date().toISOString(),notes:j}),i("/app/inventory/transfers")}finally{R(!1)}}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(xe,{to:"/app/inventory/transfers",className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(Jt,{className:"h-5 w-5 text-gray-600"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create Transfer"})]})}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Store"}),s.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2",value:a,onChange:E=>o(E.target.value),children:[s.jsx("option",{value:"",children:"Select store"}),e.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Store"}),s.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2",value:c,onChange:E=>u(E.target.value),children:[s.jsx("option",{value:"",children:"Select store"}),e.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product"}),s.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2",value:d,onChange:E=>m(E.target.value),children:[s.jsx("option",{value:"",children:"Select product"}),t.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),s.jsx("input",{type:"number",min:"0",className:"w-full border border-gray-300 rounded-lg px-3 py-2",value:p,onChange:E=>x(E.target.value===""?"":Number(E.target.value))}),a&&d&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Available in from-store: ",v]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),s.jsx("textarea",{className:"w-full border border-gray-300 rounded-lg px-3 py-2",value:j,onChange:E=>I(E.target.value)})]}),s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{onClick:f,disabled:!y||b,className:"inline-flex items-center px-4 py-2 rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[s.jsx(Hr,{className:"h-4 w-4 mr-2"})," ",b?"Creating...":"Create Transfer"]})})]})]})},OP=()=>{const{stores:t,storesLoading:e,deleteStore:r}=zt(),[n,i]=_.useState(""),[a,o]=_.useState("all"),[c,u]=_.useState("name"),[d,m]=_.useState(null),x=[...t.filter(b=>{const R=b.name.toLowerCase().includes(n.toLowerCase())||b.address.toLowerCase().includes(n.toLowerCase())||b.city.toLowerCase().includes(n.toLowerCase())||b.manager&&b.manager.toLowerCase().includes(n.toLowerCase()),v=a==="all"||b.type===a;return R&&v})].sort((b,R)=>{var v,y,f,E;switch(c){case"name":return b.name.localeCompare(R.name);case"type":return b.type.localeCompare(R.type);case"date":return new Date(((y=(v=R.createdAt)==null?void 0:v.toDate)==null?void 0:y.call(v))||R.createdAt).getTime()-new Date(((E=(f=b.createdAt)==null?void 0:f.toDate)==null?void 0:E.call(f))||b.createdAt).getTime();default:return 0}}),j=async b=>{try{await r(b),m(null)}catch(R){console.error("Error deleting store:",R)}},I=b=>b?(b.toDate?b.toDate():new Date(b)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A";return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Store Management"}),s.jsx("p",{className:"text-gray-600",children:"Manage your stores and locations"})]}),s.jsxs(xe,{to:"/app/inventory/stores/add",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Store"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(pt,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Stores"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(pt,{className:"h-6 w-6 text-green-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Main Stores"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(b=>b.type==="main").length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(pt,{className:"h-6 w-6 text-purple-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Sub-Stores"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(b=>b.type==="sub").length})]})})]})})})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search stores...",value:n,onChange:b=>i(b.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{value:a,onChange:b=>o(b.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Types"}),s.jsx("option",{value:"main",children:"Main Stores"}),s.jsx("option",{value:"sub",children:"Sub-Stores"})]}),s.jsxs("select",{value:c,onChange:b=>u(b.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"name",children:"Sort by Name"}),s.jsx("option",{value:"type",children:"Sort by Type"}),s.jsx("option",{value:"date",children:"Sort by Date"})]})]})]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(b=>s.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:b.name}),s.jsx("p",{className:"text-sm text-gray-500",children:b.type==="main"?"Main Store":"Sub-Store"})]}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${b.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.isActive?"Active":"Inactive"})]}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Mn,{className:"h-4 w-4 mr-2 text-gray-400"}),s.jsx("span",{className:"truncate",children:b.address})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Mn,{className:"h-4 w-4 mr-2 text-gray-400"}),s.jsx("span",{children:b.city})]}),b.manager&&s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Sr,{className:"h-4 w-4 mr-2 text-gray-400"}),s.jsx("span",{children:b.manager})]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"text-sm text-gray-500",children:["Created: ",I(b.createdAt)]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(xe,{to:`/app/inventory/stores/edit/${b.id}`,className:"text-indigo-600 hover:text-indigo-900",children:s.jsx(Pr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>m(b.id||""),className:"text-red-600 hover:text-red-900",children:s.jsx(Tt,{className:"h-4 w-4"})})]})]})]})},b.id))}),x.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(pt,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No stores found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n||a!=="all"?"Try adjusting your search or filter criteria.":"No stores have been added yet."}),!n&&a==="all"&&s.jsx("div",{className:"mt-6",children:s.jsxs(xe,{to:"/app/inventory/stores/add",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Store"]})})]}),d&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:s.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:s.jsxs("div",{className:"mt-3 text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:s.jsx(Tt,{className:"h-6 w-6 text-red-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mt-4",children:"Delete Store"}),s.jsx("div",{className:"mt-2 px-7 py-3",children:s.jsx("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this store? This action cannot be undone and will remove all associated inventory data."})}),s.jsxs("div",{className:"items-center px-4 py-3",children:[s.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md shadow-sm hover:bg-gray-400 mr-2",children:"Cancel"}),s.jsx("button",{onClick:()=>j(d),className:"px-4 py-2 bg-red-600 text-white text-base font-medium rounded-md shadow-sm hover:bg-red-700",children:"Delete"})]})]})})})]})},LP=()=>{const{products:t,stockItems:e,stores:r,getStoreById:n,getProductById:i}=zt(),[a,o]=_.useState(""),[c,u]=_.useState("all"),[d,m]=_.useState("stock"),p=_.useMemo(()=>e.filter(R=>{const v=i(R.productId);if(!v)return!1;const y=R.currentStock<=v.minStockLevel,f=v.name.toLowerCase().includes(a.toLowerCase())||v.sku.toLowerCase().includes(a.toLowerCase()),E=c==="all"||R.storeId===c;return y&&f&&E}),[e,t,a,c,i]),x=_.useMemo(()=>[...p].sort((R,v)=>{const y=i(R.productId),f=i(v.productId),E=n(R.storeId),P=n(v.storeId);switch(d){case"product":return(y==null?void 0:y.name.localeCompare((f==null?void 0:f.name)||""))||0;case"store":return(E==null?void 0:E.name.localeCompare((P==null?void 0:P.name)||""))||0;case"stock":return R.currentStock-v.currentStock;default:return 0}}),[p,d,i,n]),j=p.length,I=p.filter(R=>i(R.productId)&&R.currentStock===0).length,b=(R,v)=>R===0?{status:"Out of Stock",color:"text-red-600",bg:"bg-red-100"}:R<=v*.5?{status:"Critical",color:"text-red-600",bg:"bg-red-100"}:{status:"Low Stock",color:"text-yellow-600",bg:"bg-yellow-100"};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Low Stock Alerts"}),s.jsx("p",{className:"text-gray-600",children:"Monitor products that need restocking"})]}),s.jsxs(xe,{to:"/app/inventory/products/add",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Add Product"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Rt,{className:"h-6 w-6 text-yellow-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Low Stock Items"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:j})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(uP,{className:"h-6 w-6 text-red-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Out of Stock"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:I})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(pt,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Affected Stores"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:new Set(p.map(R=>R.storeId)).size})]})})]})})})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search products...",value:a,onChange:R=>o(R.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{value:c,onChange:R=>u(R.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Stores"}),r.map(R=>s.jsx("option",{value:R.id,children:R.name},R.id))]}),s.jsxs("select",{value:d,onChange:R=>m(R.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"stock",children:"Sort by Stock Level"}),s.jsx("option",{value:"product",children:"Sort by Product"}),s.jsx("option",{value:"store",children:"Sort by Store"})]})]})]})}),s.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Store"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Current Stock"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Min Level"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(R=>{const v=i(R.productId),y=n(R.storeId);if(!v||!y)return null;const f=b(R.currentStock,v.minStockLevel);return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:s.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx(Ie,{className:"h-5 w-5 text-blue-600"})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:["SKU: ",v.sku]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(pt,{className:"h-4 w-4 text-gray-400 mr-2"}),y.name]}),s.jsx("div",{className:"text-sm text-gray-500",children:y.type==="main"?"Main Store":"Sub-Store"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[R.currentStock," ",v.unit]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[v.minStockLevel," ",v.unit]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.bg} ${f.color}`,children:f.status})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(xe,{to:"/app/inventory/transfers/create",state:{productId:v.id,fromStoreId:y.id,quantity:v.minStockLevel*2},className:"text-blue-600 hover:text-blue-900",children:"Restock"}),s.jsx(xe,{to:`/app/inventory/products/edit/${v.id}`,className:"text-indigo-600 hover:text-indigo-900",children:"Edit"})]})})]},`${R.productId}-${R.storeId}`)})})]})}),x.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Rt,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No low stock alerts"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:a||c!=="all"?"Try adjusting your search or filter criteria.":"All products are adequately stocked."})]})]})]})},M0=()=>{const{storeId:t}=Bn(),e=Zt(),{stores:r,addStore:n,updateStore:i,getStoreById:a}=zt(),[o,c]=_.useState(!1),[u,d]=_.useState(""),[m,p]=_.useState(!1),[x,j]=_.useState({name:"",type:"sub",address:"",city:"",manager:"",isActive:!0});_.useEffect(()=>{if(t){p(!0);const v=a(t);v&&j({name:v.name,type:v.type,address:v.address,city:v.city,manager:v.manager||"",isActive:v.isActive})}},[t,a]);const I=v=>{const{name:y,value:f,type:E}=v.target;j(P=>({...P,[y]:E==="checkbox"?v.target.checked:f}))},b=()=>x.name.trim()?x.address.trim()?x.city.trim()?!m&&r.some(v=>v.name.toLowerCase()===x.name.toLowerCase())?(d("Store name already exists"),!1):!0:(d("City is required"),!1):(d("Address is required"),!1):(d("Store name is required"),!1),R=async v=>{if(v.preventDefault(),!!b()){c(!0),d("");try{const y={...x,manager:x.manager.trim()||void 0};y.manager||delete y.manager,m&&t?(await i(t,y),e("/app/settings/stores",{state:{message:"Store updated successfully!"}})):(await n(y),e("/app/settings/stores",{state:{message:"Store added successfully!"}}))}catch(y){console.error("Error saving store:",y),d(y.message||"Failed to save store")}finally{c(!1)}}};return s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(xe,{to:"/app/settings/stores",className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Jt,{className:"h-5 w-5 text-gray-600"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:m?"Edit Store":"Add New Store"}),s.jsx("p",{className:"text-gray-600",children:m?"Update store information":"Create a new store location"})]})]}),u&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:u}),s.jsxs("form",{onSubmit:R,className:"space-y-6",children:[s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(pt,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Store Information"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Name *"}),s.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:x.name,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter store name"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Type *"}),s.jsxs("select",{id:"type",name:"type",required:!0,value:x.type,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"sub",children:"Sub-Store"}),s.jsx("option",{value:"main",children:"Main Store"})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Main stores are primary locations, sub-stores are satellite locations"})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(pt,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Location Information"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Address *"}),s.jsx("textarea",{id:"address",name:"address",required:!0,rows:3,value:x.address,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter store address"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),s.jsx("input",{type:"text",id:"city",name:"city",required:!0,value:x.city,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter city"})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(pt,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Management"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"manager",className:"block text-sm font-medium text-gray-700 mb-2",children:"Store Manager (Optional)"}),s.jsx("input",{type:"text",id:"manager",name:"manager",value:x.manager,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter manager name"})]}),s.jsx("div",{className:"flex items-center",children:s.jsxs("div",{className:"flex items-center h-5",children:[s.jsx("input",{id:"isActive",name:"isActive",type:"checkbox",checked:x.isActive,onChange:I,className:"focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Active Store"})]})})]})]}),s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx("button",{type:"button",onClick:()=>e("/app/settings/stores"),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),s.jsxs("button",{type:"submit",disabled:o,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[o?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):s.jsx(Hr,{className:"h-4 w-4 mr-2"}),o?m?"Updating Store...":"Adding Store...":m?"Update Store":"Add Store"]})]})]})]})},MP=()=>s.jsxs(Wr,{children:[s.jsx(ee,{index:!0,element:s.jsx(Xs,{to:"/inventory/products",replace:!0})}),s.jsx(ee,{path:"products",element:s.jsx(TP,{})}),s.jsx(ee,{path:"products/:productId",element:s.jsx(AP,{})}),s.jsx(ee,{path:"products/add",element:s.jsx(L0,{})}),s.jsx(ee,{path:"products/edit/:productId",element:s.jsx(L0,{})}),s.jsx(ee,{path:"main",element:s.jsx(PP,{})}),s.jsx(ee,{path:"substores",element:s.jsx(OP,{})}),s.jsx(ee,{path:"stores/add",element:s.jsx(M0,{})}),s.jsx(ee,{path:"stores/edit/:storeId",element:s.jsx(M0,{})}),s.jsx(ee,{path:"transfers",element:s.jsx(RP,{})}),s.jsx(ee,{path:"transfers/create",element:s.jsx(DP,{})}),s.jsx(ee,{path:"alerts",element:s.jsx(LP,{})}),s.jsx(ee,{path:"*",element:s.jsx(Xs,{to:"/inventory/products",replace:!0})})]}),VP=()=>{const{customers:t,loading:e,deleteCustomer:r}=ia(),[n,i]=_.useState(""),[a,o]=_.useState("all"),[c,u]=_.useState("name"),d=cr(),[m,p]=_.useState(!1),[x,j]=_.useState(null),[I,b]=_.useState(""),[R,v]=_.useState(!1),y=_.useMemo(()=>t.filter(P=>{const F=P.firstName.toLowerCase().includes(n.toLowerCase())||P.lastName.toLowerCase().includes(n.toLowerCase())||P.email.toLowerCase().includes(n.toLowerCase())||P.phone.includes(n),N=a==="all"||a==="active"&&P.isActive||a==="inactive"&&!P.isActive;return F&&N}),[t,n,a]),f=_.useMemo(()=>[...y].sort((P,F)=>{switch(c){case"name":return`${P.firstName} ${P.lastName}`.localeCompare(`${F.firstName} ${F.lastName}`);case"date":return new Date(F.registrationDate).getTime()-new Date(P.registrationDate).getTime();case"spent":return F.totalSpent-P.totalSpent;default:return 0}}),[y,c]),E=(P,F)=>{const N=P/F*100;return N>=90?{color:"text-red-600",bg:"bg-red-50"}:N>=70?{color:"text-yellow-600",bg:"bg-yellow-50"}:{color:"text-green-600",bg:"bg-green-50"}};return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Customers"}),s.jsx("p",{className:"text-gray-600",children:"Manage your customer database"})]}),s.jsxs(xe,{to:"/customers/add",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Customer"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Sr,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Customers"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Sr,{className:"h-6 w-6 text-green-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Customers"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(P=>P.isActive).length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ps,{className:"h-6 w-6 text-yellow-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Credit Customers"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(P=>P.creditLimit>0).length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Sr,{className:"h-6 w-6 text-purple-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"New This Month"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(P=>{const F=new Date(P.registrationDate),N=new Date;return F.getMonth()===N.getMonth()&&F.getFullYear()===N.getFullYear()}).length})]})})]})})})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search customers...",value:n,onChange:P=>i(P.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{value:a,onChange:P=>o(P.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"inactive",children:"Inactive"})]}),s.jsxs("select",{value:c,onChange:P=>u(P.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"name",children:"Sort by Name"}),s.jsx("option",{value:"date",children:"Sort by Date"}),s.jsx("option",{value:"spent",children:"Sort by Total Spent"})]})]})]})}),s.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credit Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Orders"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Spent"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(P=>{var N;const F=E(P.creditUsed,P.creditLimit);return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:s.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[P.firstName.charAt(0),P.lastName.charAt(0)]})})}),s.jsxs("div",{className:"ml-4",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[P.firstName," ",P.lastName]}),s.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",((N=P.id)==null?void 0:N.slice(-8))||"N/A"]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(tl,{className:"h-4 w-4 text-gray-400 mr-2"}),P.email]}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(Mu,{className:"h-4 w-4 text-gray-400 mr-2"}),P.phone]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:P.creditLimit>0?s.jsxs("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${F.bg} ${F.color}`,children:[d(P.creditUsed)," / ",d(P.creditLimit)]}):s.jsx("span",{className:"text-gray-500 text-sm",children:"Cash Only"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:P.totalOrders}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d(P.totalSpent)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${P.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:P.isActive?"Active":"Inactive"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(xe,{to:`/app/customers/${P.id}`,className:"text-blue-600 hover:text-blue-900",children:s.jsx(rn,{className:"h-4 w-4"})}),s.jsx(xe,{to:`/app/customers/edit/${P.id}`,className:"text-indigo-600 hover:text-indigo-900",children:s.jsx(Pr,{className:"h-4 w-4"})}),s.jsx("button",{className:"text-red-600 hover:text-red-900",onClick:()=>{P.id&&(j(P.id),b(`${P.firstName} ${P.lastName}`),p(!0))},children:s.jsx(Tt,{className:"h-4 w-4"})})]})})]},P.id)})})]})}),f.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Sr,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No customers found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n||a!=="all"?"Try adjusting your search or filter criteria.":"Get started by adding your first customer."}),!n&&a==="all"&&s.jsx("div",{className:"mt-6",children:s.jsxs(xe,{to:"/customers/add",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Customer"]})})]})]}),m&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center !mt-0",children:s.jsx("div",{className:"mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:s.jsxs("div",{className:"mt-3 text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:s.jsx(Tt,{className:"h-6 w-6 text-red-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mt-4",children:"Delete Customer"}),s.jsx("div",{className:"mt-2 px-7 py-3",children:s.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete ",I,"? This action cannot be undone."]})}),s.jsxs("div",{className:"items-center px-4 py-3",children:[s.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md shadow-sm hover:bg-gray-400 mr-2",children:"Cancel"}),s.jsx("button",{onClick:async()=>{if(x){v(!0);try{await r(x),p(!1)}finally{v(!1),j(null),b("")}}},disabled:R,className:"px-4 py-2 bg-red-600 text-white text-base font-medium rounded-md shadow-sm hover:bg-red-700 disabled:opacity-50",children:R?"Deleting...":"Delete"})]})]})})})]})},V0=()=>{const t=Zt(),{customerId:e}=Bn(),{currentBusiness:r}=$t(),{addCustomer:n,updateCustomer:i,getCustomerById:a}=ia(),[o,c]=_.useState(!1),[u,d]=_.useState(""),m=!!e,[p,x]=_.useState({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",creditLimit:0,isActive:!0,notes:""}),[j,I]=_.useState(!1);_.useEffect(()=>{if(m&&!j){const y=a(e);y&&(x({firstName:y.firstName,lastName:y.lastName,email:y.email,phone:y.phone,address:y.address,city:y.city,creditLimit:y.creditLimit||0,isActive:y.isActive,notes:y.notes||""}),I(!0))}},[m,e,j]);const b=y=>{const{name:f,value:E,type:P}=y.target;x(F=>({...F,[f]:P==="checkbox"?y.target.checked:P==="number"?parseFloat(E)||0:E}))},R=()=>p.firstName.trim()?p.lastName.trim()?p.email.trim()?p.phone.trim()?p.address.trim()?p.city.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p.email)?!0:(d("Please enter a valid email address"),!1):(d("City is required"),!1):(d("Address is required"),!1):(d("Phone number is required"),!1):(d("Email is required"),!1):(d("Last name is required"),!1):(d("First name is required"),!1),v=async y=>{if(y.preventDefault(),!!R()){if(!r){d("No business selected");return}c(!0),d("");try{if(m&&e)await i(e,{...p,updatedAt:new Date().toISOString()}),t("/app/customers",{state:{message:"Customer updated successfully!"}});else{const f={...p,creditUsed:0,totalOrders:0,totalSpent:0,registrationDate:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await n(f),t("/app/customers",{state:{message:"Customer added successfully!"}})}}catch(f){console.error("Error adding customer:",f),d(f.message||"Failed to save customer")}finally{c(!1)}}};return s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>t("/app/customers"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Jt,{className:"h-5 w-5 text-gray-600"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:m?"Edit Customer":"Add New Customer"}),s.jsx("p",{className:"text-gray-600",children:m?"Update customer details":"Create a new customer account"})]})]}),u&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:u}),s.jsxs("form",{onSubmit:v,className:"space-y-6",children:[s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(UN,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Personal Information"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),s.jsx("input",{type:"text",id:"firstName",name:"firstName",required:!0,value:p.firstName,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter first name"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),s.jsx("input",{type:"text",id:"lastName",name:"lastName",required:!0,value:p.lastName,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter last name"})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(tl,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Contact Information"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),s.jsx("input",{type:"email",id:"email",name:"email",required:!0,value:p.email,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email address"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),s.jsx("input",{type:"tel",id:"phone",name:"phone",required:!0,value:p.phone,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter phone number"})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(Mn,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Address Information"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address *"}),s.jsx("input",{type:"text",id:"address",name:"address",required:!0,value:p.address,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter street address"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),s.jsx("input",{type:"text",id:"city",name:"city",required:!0,value:p.city,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter city"})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(ps,{className:"h-5 w-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Credit & Status"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"creditLimit",className:"block text-sm font-medium text-gray-700 mb-2",children:"Credit Limit ($)"}),s.jsx("input",{type:"number",id:"creditLimit",name:"creditLimit",min:"0",step:"0.01",value:p.creditLimit,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Set to 0 for cash-only customers"})]}),s.jsx("div",{className:"flex items-center",children:s.jsxs("div",{className:"flex items-center h-5",children:[s.jsx("input",{id:"isActive",name:"isActive",type:"checkbox",checked:p.isActive,onChange:b,className:"focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Active Customer"})]})})]})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{children:[s.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),s.jsx("textarea",{id:"notes",name:"notes",rows:4,value:p.notes,onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Any additional notes about this customer..."})]})}),s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx("button",{type:"button",onClick:()=>t("/app/customers"),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),s.jsxs("button",{type:"submit",disabled:o,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[o?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):s.jsx(Hr,{className:"h-4 w-4 mr-2"}),o?m?"Saving...":"Adding Customer...":m?"Save Changes":"Add Customer"]})]})]})]})},FP=()=>{const{customerId:t}=Bn(),e=Zt(),{currentBusiness:r}=$t(),[n,i]=_.useState(null),[a,o]=_.useState(!0),[c,u]=_.useState(""),[d,m]=_.useState(!1),[p,x]=_.useState(!1),j=cr(),I=_.useCallback(async()=>{if(!(!t||!r))try{o(!0);const E=Re(oe,r.id,"main","customers",t),P=await VA(E);if(P.exists()){const F={id:P.id,...P.data()};i(N=>N&&JSON.stringify(N)===JSON.stringify(F)?N:F)}else u("Customer not found")}catch(E){console.error("Error fetching customer:",E),u("Failed to load customer details")}finally{o(!1)}},[t,r==null?void 0:r.id]);_.useEffect(()=>{I()},[I]);const b=async()=>{if(!(!t||!r)){x(!0);try{const E=Re(oe,r.id,"main","customers",t);await Ln(E),e("/app/customers",{state:{message:"Customer deleted successfully!"}})}catch(E){console.error("Error deleting customer:",E),u("Failed to delete customer")}finally{x(!1),m(!1)}}},R=async()=>{if(!(!n||!r))try{const E=Re(oe,r.id,"main","customers",n.id);await rs(E,{isActive:!n.isActive,updatedAt:new Date}),i(P=>P?{...P,isActive:!P.isActive}:null)}catch(E){console.error("Error updating customer status:",E),u("Failed to update customer status")}},v=(E,P)=>{if(P===0)return{status:"Cash Only",color:"text-gray-600",bg:"bg-gray-100"};const F=E/P*100;return F>=90?{status:"High Risk",color:"text-red-600",bg:"bg-red-100"}:F>=70?{status:"Warning",color:"text-yellow-600",bg:"bg-yellow-100"}:{status:"Good",color:"text-green-600",bg:"bg-green-100"}},y=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});if(a)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(c||!n)return s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Rt,{className:"mx-auto h-12 w-12 text-red-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Customer not found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:c}),s.jsx("div",{className:"mt-6",children:s.jsxs(xe,{to:"/customers",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(Jt,{className:"w-4 h-4 mr-2"}),"Back to Customers"]})})]});const f=v(n.creditUsed,n.creditLimit);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>e("/app/customers"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Jt,{className:"h-5 w-5 text-gray-600"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[n.firstName," ",n.lastName]}),s.jsx("p",{className:"text-gray-600",children:"Customer Details"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${n.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:n.isActive?"Active":"Inactive"}),s.jsx("button",{onClick:R,className:`px-3 py-1 text-sm font-medium rounded-lg transition-colors ${n.isActive?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:n.isActive?"Deactivate":"Activate"}),s.jsxs(xe,{to:`/app/customers/edit/${n.id}`,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[s.jsx(Pr,{className:"h-4 w-4 mr-2"}),"Edit"]}),s.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-lg text-red-700 bg-white hover:bg-red-50",children:[s.jsx(Tt,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Ie,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Orders"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:n.totalOrders})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(rp,{className:"h-6 w-6 text-green-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Spent"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:j(n.totalSpent)})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ps,{className:"h-6 w-6 text-yellow-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Credit Used"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:j(n.creditUsed)})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(oa,{className:"h-6 w-6 text-purple-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Credit Limit"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:j(n.creditLimit)})]})})]})})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsxs("span",{className:"text-lg font-medium text-blue-600",children:[n.firstName.charAt(0),n.lastName.charAt(0)]})}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-lg font-medium text-gray-900",children:[n.firstName," ",n.lastName]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Customer ID: ",n.id.slice(-8)]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Registration Date"}),s.jsx("p",{className:"text-sm text-gray-900",children:y(n.registrationDate)})]}),n.lastOrderDate&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Last Order"}),s.jsx("p",{className:"text-sm text-gray-900",children:y(n.lastOrderDate)})]})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(tl,{className:"h-5 w-5 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),s.jsx("p",{className:"text-sm text-gray-900",children:n.email})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Mu,{className:"h-5 w-5 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Phone"}),s.jsx("p",{className:"text-sm text-gray-900",children:n.phone})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Mn,{className:"h-5 w-5 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Address"}),s.jsxs("p",{className:"text-sm text-gray-900",children:[n.address,s.jsx("br",{}),n.city]})]})]})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Credit Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Credit Limit"}),s.jsx("p",{className:"text-lg font-semibold text-gray-900",children:j(n.creditLimit)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Credit Used"}),s.jsx("p",{className:"text-lg font-semibold text-gray-900",children:j(n.creditUsed)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Credit Status"}),s.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${f.bg} ${f.color}`,children:f.status})]})]}),n.creditLimit>0&&s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[s.jsx("span",{children:"Credit Usage"}),s.jsxs("span",{children:[Math.round(n.creditUsed/n.creditLimit*100),"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:`h-2 rounded-full ${n.creditUsed/n.creditLimit>=.9?"bg-red-500":n.creditUsed/n.creditLimit>=.7?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(n.creditUsed/n.creditLimit*100,100)}%`}})})]})]}),n.notes&&s.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Notes"}),s.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:n.notes})]}),d&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center !mt-0",children:s.jsx("div",{className:"mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:s.jsxs("div",{className:"mt-3 text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:s.jsx(Tt,{className:"h-6 w-6 text-red-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mt-4",children:"Delete Customer"}),s.jsx("div",{className:"mt-2 px-7 py-3",children:s.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete ",n.firstName," ",n.lastName,"? This action cannot be undone and will remove all associated data."]})}),s.jsxs("div",{className:"items-center px-4 py-3",children:[s.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md shadow-sm hover:bg-gray-400 mr-2",children:"Cancel"}),s.jsx("button",{onClick:b,disabled:p,className:"px-4 py-2 bg-red-600 text-white text-base font-medium rounded-md shadow-sm hover:bg-red-700 disabled:opacity-50",children:p?"Deleting...":"Delete"})]})]})})})]})},UP=()=>{const{customers:t}=ia(),[e,r]=_.useState(""),[n,i]=_.useState("all"),a=cr(),o=_.useMemo(()=>t.filter(c=>{const u=`${c.firstName} ${c.lastName}`.toLowerCase().includes(e.toLowerCase())||c.email.toLowerCase().includes(e.toLowerCase())||c.phone.includes(e),d=c.creditUsed>0;return u&&(n==="all"||(n==="in_debt"?d:!d))}),[t,e,n]);return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Customer Accounts"}),s.jsx("p",{className:"text-gray-600",children:"Balances and account statements"})]})}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{value:e,onChange:c=>r(c.target.value),placeholder:"Search customers",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]}),s.jsxs("select",{value:n,onChange:c=>i(c.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All"}),s.jsx("option",{value:"in_debt",children:"In Debt"}),s.jsx("option",{value:"clear",children:"Cleared"})]})]})}),s.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credit Limit"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Current Balance"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Available Credit"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(c=>{const u=Math.max(0,(c.creditLimit||0)-(c.creditUsed||0));return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[c.firstName," ",c.lastName]}),s.jsx("div",{className:"text-sm text-gray-500",children:c.email})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a(c.creditLimit||0)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a(c.creditUsed||0)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a(u)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs(xe,{to:`/app/customers/${c.id}`,className:"inline-flex items-center px-2 py-1 rounded bg-blue-50 text-blue-700 hover:bg-blue-100",children:[s.jsx(Sr,{className:"h-4 w-4 mr-1"})," Statement"]}),s.jsxs(xe,{to:`/app/customers/edit/${c.id}`,className:"inline-flex items-center px-2 py-1 rounded bg-green-50 text-green-700 hover:bg-green-100",children:[s.jsx(ps,{className:"h-4 w-4 mr-1"})," Adjust Limit"]})]})})]},c.id)})})]})})})]})},BP=()=>{const{customers:t,updateCustomer:e,addCustomerTransaction:r,loading:n}=ia(),[i,a]=_.useState(""),[o,c]=_.useState(""),[u,d]=_.useState(""),[m,p]=_.useState(""),[x,j]=_.useState(!1),I=cr(),b=_.useMemo(()=>i.trim()?t.filter(f=>{const E=`${f.firstName} ${f.lastName}`.toLowerCase(),P=i.toLowerCase().trim();return E.includes(P)||f.email.toLowerCase().includes(P)||f.phone.includes(P)}):t,[t,i]),R=async f=>{if(u){j(!0);try{await e(f,{creditLimit:Number(u)}),d("")}catch(E){console.error("Error updating credit limit:",E)}finally{j(!1)}}},v=async f=>{if(!(!m||Number(m)<=0)){j(!0);try{await r(f,{type:"payment",amount:Number(m),note:"Manual payment"}),p("")}catch(E){console.error("Error recording payment:",E)}finally{j(!1)}}},y=f=>{if(f.creditLimit===0)return{status:"No Credit",color:"text-gray-500"};const E=f.creditUsed/f.creditLimit*100;return E<70?{status:"Good",color:"text-green-600"}:E<90?{status:"Warning",color:"text-yellow-600"}:{status:"High Risk",color:"text-red-600"}};return n?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Credit Management"}),s.jsx("p",{className:"text-gray-600",children:"Adjust limits and record payments"})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{value:i,onChange:f=>a(f.target.value),placeholder:"Search customers...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]})}),s.jsx("div",{className:"space-y-4",children:b.map(f=>{const E=o===f.id,P=y(f),F=f.creditLimit-f.creditUsed;return s.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[s.jsx("div",{className:"p-6 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>c(E?"":f.id),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(Xt,{className:"w-5 h-5 text-blue-600"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[f.firstName," ",f.lastName]}),s.jsx("p",{className:"text-sm text-gray-500",children:f.email}),s.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Credit Used:"}),s.jsx("span",{className:"font-medium ml-1",children:I(f.creditUsed)})]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Credit Limit:"}),s.jsx("span",{className:"font-medium ml-1",children:I(f.creditLimit)})]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Available:"}),s.jsx("span",{className:"font-medium ml-1",children:I(F)})]}),s.jsx("div",{className:`text-sm font-medium ${P.color}`,children:P.status})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Credit Status"}),s.jsx("div",{className:`font-medium ${P.color}`,children:P.status})]}),E?s.jsx(ON,{className:"w-5 h-5 text-gray-400"}):s.jsx(LN,{className:"w-5 h-5 text-gray-400"})]})]})}),E&&s.jsx("div",{className:"border-t border-gray-200 p-6 bg-gray-50",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg p-4",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(ps,{className:"w-5 h-5 mr-2 text-blue-600"}),"Adjust Credit Limit"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Current Limit: ",s.jsx("span",{className:"font-medium text-gray-900",children:I(f.creditLimit)})]}),s.jsx("input",{type:"number",min:"0",value:u,onChange:N=>d(N.target.value===""?"":Number(N.target.value)),placeholder:"New credit limit",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"}),s.jsxs("button",{onClick:()=>R(f.id),disabled:x,className:"inline-flex items-center px-4 py-2 rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[s.jsx(Hr,{className:"h-4 w-4 mr-2"})," ",x?"Saving...":"Save Limit"]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(D0,{className:"w-5 h-5 mr-2 text-green-600"}),"Record Payment"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Current Balance: ",s.jsx("span",{className:"font-medium text-gray-900",children:I(f.creditUsed)})]}),s.jsx("input",{type:"number",min:"0",value:m,onChange:N=>p(N.target.value===""?"":Number(N.target.value)),placeholder:"Payment amount",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500"}),s.jsxs("button",{onClick:()=>v(f.id),disabled:x,className:"inline-flex items-center px-4 py-2 rounded-md text-white bg-green-600 hover:bg-green-700 disabled:opacity-50",children:[s.jsx(D0,{className:"h-4 w-4 mr-2"})," ",x?"Processing...":"Apply Payment"]})]})]})]})})]},f.id)})}),b.length===0&&s.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[s.jsx(Xt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No customers found"}),s.jsx("p",{className:"text-gray-600",children:i?"No customers match your search criteria.":"No customers available."})]})]})},$P=()=>s.jsxs(Wr,{children:[s.jsx(ee,{index:!0,element:s.jsx(VP,{})}),s.jsx(ee,{path:"add",element:s.jsx(V0,{})}),s.jsx(ee,{path:":customerId",element:s.jsx(FP,{})}),s.jsx(ee,{path:"edit/:customerId",element:s.jsx(V0,{})}),s.jsx(ee,{path:"accounts",element:s.jsx(UP,{})}),s.jsx(ee,{path:"credit",element:s.jsx(BP,{})}),s.jsx(ee,{path:"*",element:s.jsx(Xs,{to:"/app/customers",replace:!0})})]}),zP=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Sales Dashboard"}),s.jsx("p",{className:"text-gray-600",children:"Track your sales performance"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(oa,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sales Management"}),s.jsx("p",{className:"text-gray-600",children:"Sales tracking and analytics will be implemented here"})]})})]}),qP=()=>s.jsxs(Wr,{children:[s.jsx(ee,{index:!0,element:s.jsx(zP,{})}),s.jsx(ee,{path:"create",element:s.jsx("div",{children:"Create Sale"})}),s.jsx(ee,{path:"reports",element:s.jsx("div",{children:"Sales Reports"})})]}),WP=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Transport & Delivery"}),s.jsx("p",{className:"text-gray-600",children:"Manage deliveries and transport logistics"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Wi,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Transport Management"}),s.jsx("p",{className:"text-gray-600",children:"Transport and delivery management will be implemented here"})]})})]}),HP=()=>s.jsxs(Wr,{children:[s.jsx(ee,{index:!0,element:s.jsx(WP,{})}),s.jsx(ee,{path:"active",element:s.jsx("div",{children:"Active Deliveries"})}),s.jsx(ee,{path:"management",element:s.jsx("div",{children:"Transport Management"})}),s.jsx(ee,{path:"history",element:s.jsx("div",{children:"Delivery History"})})]}),KP=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Invoicing"}),s.jsx("p",{className:"text-gray-600",children:"Manage invoices and payments"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(MN,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Invoice Management"}),s.jsx("p",{className:"text-gray-600",children:"Invoice generation and payment tracking will be implemented here"})]})})]}),GP=()=>s.jsxs(Wr,{children:[s.jsx(ee,{index:!0,element:s.jsx(KP,{})}),s.jsx(ee,{path:"generate",element:s.jsx("div",{children:"Generate Invoice"})}),s.jsx(ee,{path:"history",element:s.jsx("div",{children:"Invoice History"})}),s.jsx(ee,{path:"payments",element:s.jsx("div",{children:"Payment Tracking"})})]}),QP=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reports & Analytics"}),s.jsx("p",{className:"text-gray-600",children:"Business insights and analytics"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(RN,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Reports Dashboard"}),s.jsx("p",{className:"text-gray-600",children:"Business reports and analytics will be implemented here"})]})})]}),YP=()=>s.jsxs(Wr,{children:[s.jsx(ee,{index:!0,element:s.jsx(QP,{})}),s.jsx(ee,{path:"sales",element:s.jsx("div",{children:"Sales Reports"})}),s.jsx(ee,{path:"inventory",element:s.jsx("div",{children:"Inventory Reports"})}),s.jsx(ee,{path:"financial",element:s.jsx("div",{children:"Financial Reports"})}),s.jsx(ee,{path:"custom",element:s.jsx("div",{children:"Custom Reports"})})]}),JP=()=>{const{pendingMembers:t,approveMember:e,rejectMember:r,currentBusiness:n}=$t(),[i,a]=_.useState(!1),o=async m=>{a(!0);try{await e(m)}catch(p){console.error("Error approving member:",p)}finally{a(!1)}},c=async m=>{a(!0);try{await r(m)}catch(p){console.error("Error rejecting member:",p)}finally{a(!1)}},u=m=>{switch(m){case"admin":return"bg-red-100 text-red-800";case"packer":return"bg-blue-100 text-blue-800";case"inventory_manager":return"bg-purple-100 text-purple-800";case"sales_rep":return"bg-green-100 text-green-800";case"accountant":return"bg-yellow-100 text-yellow-800";case"customer":return"bg-pink-100 text-pink-800";default:return"bg-gray-100 text-gray-800"}},d=m=>{switch(m){case"sales_rep":return"Sales Representative";case"inventory_manager":return"Inventory Manager";case"packer":return"Packer";case"customer":return"Customer";default:return m.charAt(0).toUpperCase()+m.slice(1)}};return n?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pending Approvals"}),s.jsxs("p",{className:"text-gray-600",children:["Review and approve team member requests for ",n.name]})]}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[s.jsx(at,{className:"w-4 h-4"}),s.jsxs("span",{children:[t.length," pending request",t.length!==1?"s":""]})]})]}),t.length===0?s.jsx("div",{className:"gradient-card rounded-xl p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ve,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Pending Approvals"}),s.jsx("p",{className:"text-gray-600",children:"All team member requests have been processed"})]})}):s.jsx("div",{className:"space-y-4",children:t.map(m=>s.jsx("div",{className:"gradient-card rounded-xl p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(Xt,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:`${m.firstName} ${m.lastName}`}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${u(m.role)}`,children:d(m.role)})]}),s.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(tl,{className:"w-4 h-4"}),s.jsx("span",{children:m.email})]}),m.phone&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Mu,{className:"w-4 h-4"}),s.jsx("span",{children:m.phone})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(at,{className:"w-4 h-4"}),s.jsxs("span",{children:["Requested on ",m.joinedAt.toLocaleDateString()]})]})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:()=>c(m.id),disabled:i,className:"flex items-center space-x-2 px-4 py-2 text-red-600 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 transition-colors disabled:opacity-50",children:[s.jsx(rl,{className:"w-4 h-4"}),s.jsx("span",{children:"Reject"})]}),s.jsxs("button",{onClick:()=>o(m.id),disabled:i,className:"flex items-center space-x-2 px-4 py-2 text-white bg-green-600 border border-green-600 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[s.jsx(ve,{className:"w-4 h-4"}),s.jsx("span",{children:"Approve"})]})]})]})},m.id))})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pending Approvals"}),s.jsx("p",{className:"text-gray-600",children:"Manage team member requests"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Sr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Business Selected"}),s.jsx("p",{className:"text-gray-600",children:"Please select a business to view pending approvals"})]})})]})},XP=()=>{const{stores:t,storesLoading:e,deleteStore:r}=zt(),[n,i]=_.useState(""),[a,o]=_.useState("all"),[c,u]=_.useState("name"),[d,m]=_.useState(null),x=[...t.filter(b=>{const R=b.name.toLowerCase().includes(n.toLowerCase())||b.address.toLowerCase().includes(n.toLowerCase())||b.city.toLowerCase().includes(n.toLowerCase())||b.manager&&b.manager.toLowerCase().includes(n.toLowerCase()),v=a==="all"||b.type===a;return R&&v})].sort((b,R)=>{var v,y,f,E;switch(c){case"name":return b.name.localeCompare(R.name);case"type":return b.type.localeCompare(R.type);case"date":return new Date(((y=(v=R.createdAt)==null?void 0:v.toDate)==null?void 0:y.call(v))||R.createdAt).getTime()-new Date(((E=(f=b.createdAt)==null?void 0:f.toDate)==null?void 0:E.call(f))||b.createdAt).getTime();default:return 0}}),j=async b=>{try{await r(b),m(null)}catch(R){console.error("Error deleting store:",R)}},I=b=>b?(b.toDate?b.toDate():new Date(b)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A";return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(xe,{to:"/app/system",className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(Jt,{className:"h-5 w-5 text-gray-600"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Store Configuration"}),s.jsx("p",{className:"text-gray-600",children:"Manage all stores across your business"})]})]}),s.jsxs(xe,{to:"/app/inventory/stores/add",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Store"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(pt,{className:"h-6 w-6 text-blue-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Stores"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(pt,{className:"h-6 w-6 text-green-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Main Stores"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(b=>b.type==="main").length})]})})]})})}),s.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:s.jsx("div",{className:"p-5",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(pt,{className:"h-6 w-6 text-purple-600"})}),s.jsx("div",{className:"ml-5 w-0 flex-1",children:s.jsxs("dl",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Sub-Stores"}),s.jsx("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(b=>b.type==="sub").length})]})})]})})})]}),s.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(yr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search stores...",value:n,onChange:b=>i(b.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full"})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{value:a,onChange:b=>o(b.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Types"}),s.jsx("option",{value:"main",children:"Main Stores"}),s.jsx("option",{value:"sub",children:"Sub-Stores"})]}),s.jsxs("select",{value:c,onChange:b=>u(b.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"name",children:"Sort by Name"}),s.jsx("option",{value:"type",children:"Sort by Type"}),s.jsx("option",{value:"date",children:"Sort by Date"})]})]})]})}),s.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Store"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Manager"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(b=>{var R;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:s.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx(pt,{className:"h-5 w-5 text-blue-600"})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:b.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",((R=b.id)==null?void 0:R.slice(-8))||"N/A"]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${b.type==="main"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:b.type==="main"?"Main Store":"Sub-Store"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Mn,{className:"h-4 w-4 text-gray-400 mr-2"}),b.address]}),s.jsx("div",{className:"text-sm text-gray-500",children:b.city})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.manager?s.jsxs("div",{className:"flex items-center",children:[s.jsx(Sr,{className:"h-4 w-4 text-gray-400 mr-2"}),b.manager]}):s.jsx("span",{className:"text-gray-400",children:"No manager"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${b.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.isActive?"Active":"Inactive"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:I(b.createdAt)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(xe,{to:`/app/inventory/stores/edit/${b.id}`,className:"text-indigo-600 hover:text-indigo-900",children:s.jsx(Pr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>m(b.id||""),className:"text-red-600 hover:text-red-900",children:s.jsx(Tt,{className:"h-4 w-4"})})]})})]},b.id)})})]})}),x.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(pt,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No stores found"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n||a!=="all"?"Try adjusting your search or filter criteria.":"No stores have been added yet."}),!n&&a==="all"&&s.jsx("div",{className:"mt-6",children:s.jsxs(xe,{to:"/app/inventory/stores/add",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[s.jsx(ut,{className:"w-4 h-4 mr-2"}),"Add Store"]})})]})]}),d&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center !mt-0",children:s.jsx("div",{className:"mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:s.jsxs("div",{className:"mt-3 text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:s.jsx(Tt,{className:"h-6 w-6 text-red-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mt-4",children:"Delete Store"}),s.jsx("div",{className:"mt-2 px-7 py-3",children:s.jsx("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this store? This action cannot be undone and will remove all associated inventory data."})}),s.jsxs("div",{className:"items-center px-4 py-3",children:[s.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md shadow-sm hover:bg-gray-400 mr-2",children:"Cancel"}),s.jsx("button",{onClick:()=>j(d),className:"px-4 py-2 bg-red-600 text-white text-base font-medium rounded-md shadow-sm hover:bg-red-700",children:"Delete"})]})]})})})]})},ZP=()=>{const{approvalRoles:t,approvalUsers:e,businessUsers:r,rolesLoading:n,usersLoading:i,error:a,createApprovalRole:o,updateApprovalRole:c,deleteApprovalRole:u,assignUserToRole:d,updateApprovalUser:m,removeApprovalUser:p}=na(),[x,j]=_.useState(!1),[I,b]=_.useState(""),[R,v]=_.useState(""),[y,f]=_.useState(!1),[E,P]=_.useState(!1),[F,N]=_.useState({name:"",description:"",canApproveOrders:!1,canApproveCredit:!1,canApproveTransfers:!1,maxApprovalAmount:0,requiresSecondaryApproval:!1,secondaryApprovalAmount:0}),[w,T]=_.useState({userId:"",userName:"",userEmail:"",roleId:"",isActive:!0});_.useEffect(()=>{a&&b(a)},[a]);const A=async()=>{if(F.name.trim()){j(!0),b("");try{await o({...F,isActive:!0}),N({name:"",description:"",canApproveOrders:!1,canApproveCredit:!1,canApproveTransfers:!1,maxApprovalAmount:0,requiresSecondaryApproval:!1,secondaryApprovalAmount:0}),f(!1),v("Approval role created successfully!"),setTimeout(()=>v(""),3e3)}catch(O){b(O.message||"Failed to create approval role")}finally{j(!1)}}},D=async()=>{if(!w.userId.trim()||!w.roleId.trim())return;const O=t.find(L=>L.id===w.roleId);if(O){j(!0),b("");try{await d({...w,roleName:O.name}),T({userId:"",userName:"",userEmail:"",roleId:"",isActive:!0}),P(!1),v("User assigned to role successfully!"),setTimeout(()=>v(""),3e3)}catch(L){b(L.message||"Failed to assign user to role")}finally{j(!1)}}},C=async O=>{if(window.confirm("Are you sure you want to delete this role?")){j(!0),b("");try{await u(O),v("Approval role deleted successfully!"),setTimeout(()=>v(""),3e3)}catch(L){b(L.message||"Failed to delete approval role")}finally{j(!1)}}},S=async O=>{if(window.confirm("Are you sure you want to remove this user from approval roles?")){j(!0),b("");try{await p(O),v("User removed from approval roles successfully!"),setTimeout(()=>v(""),3e3)}catch(L){b(L.message||"Failed to remove user from approval roles")}finally{j(!1)}}},H=async O=>{const L=t.find(U=>U.id===O);if(L){j(!0),b("");try{await c(O,{isActive:!L.isActive}),v(`Role ${L.isActive?"deactivated":"activated"} successfully!`),setTimeout(()=>v(""),3e3)}catch(U){b(U.message||"Failed to update role status")}finally{j(!1)}}},W=async O=>{const L=e.find(U=>U.id===O);if(L){j(!0),b("");try{await m(O,{isActive:!L.isActive}),v(`User ${L.isActive?"deactivated":"activated"} successfully!`),setTimeout(()=>v(""),3e3)}catch(U){b(U.message||"Failed to update user status")}finally{j(!1)}}},re=async()=>{try{j(!0),v("Settings saved successfully"),setTimeout(()=>v(""),3e3)}catch(O){console.error("Error saving settings:",O),b("Failed to save settings"),setTimeout(()=>b(""),3e3)}finally{j(!1)}},ce=O=>({admin:"Full system access and administrative privileges",sales_rep:"Handles customer sales and order processing",inventory_manager:"Manages inventory, stock, and warehouse operations",packer:"Prepares and packages orders for shipment",accountant:"Handles financial records and accounting operations",customer:"Customer access to place orders and view account"})[O]||"";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Order Approval Settings"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Configure who can approve orders and transactions"})]}),s.jsx("div",{className:"flex space-x-3",children:s.jsxs("button",{onClick:re,disabled:x,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-2",children:[s.jsx(Hr,{className:"h-4 w-4"}),s.jsx("span",{children:"Save Settings"})]})})]}),R&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ve,{className:"h-5 w-5 text-green-600 mr-2"}),s.jsx("span",{className:"text-green-800",children:R})]})}),I&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Rt,{className:"h-5 w-5 text-red-600 mr-2"}),s.jsx("span",{className:"text-red-800",children:I})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Approval Roles"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Define roles and their approval permissions"})]}),s.jsxs("button",{onClick:()=>f(!y),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[s.jsx(ut,{className:"h-4 w-4"}),s.jsx("span",{children:"Add Role"})]})]})}),y&&s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Name"}),s.jsxs("select",{value:F.name,onChange:O=>{const L=O.target.value;N(U=>({...U,name:L,description:ce(L)}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"Select a role..."}),s.jsx("option",{value:"admin",children:"Admin"}),s.jsx("option",{value:"business_owner",children:"Business Owner"}),s.jsx("option",{value:"sales_rep",children:"Sales Representative"}),s.jsx("option",{value:"inventory_manager",children:"Inventory Manager"}),s.jsx("option",{value:"packer",children:"Packer"}),s.jsx("option",{value:"accountant",children:"Accountant"}),s.jsx("option",{value:"customer",children:"Customer"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("input",{type:"text",value:F.description,onChange:O=>N(L=>({...L,description:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Role description"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Approval Amount"}),s.jsx("input",{type:"number",value:F.maxApprovalAmount,onChange:O=>N(L=>({...L,maxApprovalAmount:Number(O.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Secondary Approval Amount"}),s.jsx("input",{type:"number",value:F.secondaryApprovalAmount,onChange:O=>N(L=>({...L,secondaryApprovalAmount:Number(O.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]})]}),s.jsx("div",{className:"mt-4 space-y-3",children:s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:F.canApproveOrders,onChange:O=>N(L=>({...L,canApproveOrders:O.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Can Approve Orders"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:F.canApproveCredit,onChange:O=>N(L=>({...L,canApproveCredit:O.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Can Approve Credit"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:F.canApproveTransfers,onChange:O=>N(L=>({...L,canApproveTransfers:O.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Can Approve Transfers"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:F.requiresSecondaryApproval,onChange:O=>N(L=>({...L,requiresSecondaryApproval:O.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Requires Secondary Approval"})]})]})}),s.jsxs("div",{className:"mt-4 flex space-x-3",children:[s.jsx("button",{onClick:A,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Add Role"}),s.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}),n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Permissions"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount Limits"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(O=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:O.name}),s.jsx("div",{className:"text-sm text-gray-500",children:O.description})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"space-y-1",children:[O.canApproveOrders&&s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Orders"}),O.canApproveCredit&&s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Credit"}),O.canApproveTransfers&&s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800",children:"Transfers"})]})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsxs("div",{className:"text-sm text-gray-900",children:["Max: ",O.maxApprovalAmount.toLocaleString()," TZS"]}),O.requiresSecondaryApproval&&s.jsxs("div",{className:"text-sm text-gray-500",children:["Secondary: ",O.secondaryApprovalAmount.toLocaleString()," TZS"]})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("button",{onClick:()=>H(O.id),className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${O.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:O.isActive?"Active":"Inactive"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsx("button",{onClick:()=>C(O.id),className:"text-red-600 hover:text-red-900",children:s.jsx(Tt,{className:"h-4 w-4"})})})]},O.id))})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Approval Users"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Assign users to approval roles"})]}),s.jsxs("button",{onClick:()=>P(!E),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[s.jsx(ut,{className:"h-4 w-4"}),s.jsx("span",{children:"Assign User"})]})]})}),E&&s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select User"}),s.jsxs("select",{value:w.userId,onChange:O=>{const L=r.find(U=>U.userId===O.target.value);T(U=>({...U,userId:O.target.value,userName:(L==null?void 0:L.userName)||"",userEmail:(L==null?void 0:L.userEmail)||""}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"Select User"}),r.filter(O=>O.status==="active").map(O=>s.jsxs("option",{value:O.userId,children:[O.userName," (",O.userEmail,")"]},O.userId))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Name"}),s.jsx("input",{type:"text",value:w.userName,onChange:O=>T(L=>({...L,userName:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Full Name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),s.jsx("input",{type:"email",value:w.userEmail,onChange:O=>T(L=>({...L,userEmail:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"user@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),s.jsxs("select",{value:w.roleId,onChange:O=>T(L=>({...L,roleId:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"Select Role"}),t.filter(O=>O.isActive).map(O=>s.jsx("option",{value:O.id,children:O.name},O.id))]})]})]}),s.jsxs("div",{className:"mt-4 flex space-x-3",children:[s.jsx("button",{onClick:D,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Assign User"}),s.jsx("button",{onClick:()=>P(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}),i?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(O=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Xt,{className:"h-8 w-8 text-gray-400"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:O.userName}),s.jsx("div",{className:"text-sm text-gray-500",children:O.userEmail})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:O.roleName})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm text-gray-900",children:new Date(O.assignedAt).toLocaleDateString()}),s.jsxs("div",{className:"text-sm text-gray-500",children:["by ",O.assignedBy]})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("button",{onClick:()=>W(O.id),className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${O.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:O.isActive?"Active":"Inactive"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsx("button",{onClick:()=>S(O.id),className:"text-red-600 hover:text-red-900",children:s.jsx(Tt,{className:"h-4 w-4"})})})]},O.id))})]})})]})]})},eR=()=>{var O;const{currentBusiness:t}=$t(),{businessUsers:e,fetchBusinessUsers:r}=na(),{userPermissions:n,availablePermissions:i}=aa(),[a,o]=_.useState(!1),[c,u]=_.useState(null),[d,m]=_.useState(null),[p,x]=_.useState(!1),[j,I]=_.useState([]),[b,R]=_.useState(!1),v=[{id:"admin",name:"Administrator",description:"Full system access",color:"bg-red-100 text-red-800"},{id:"business_owner",name:"Business Owner",description:"Full business access",color:"bg-purple-100 text-purple-800"},{id:"sales_rep",name:"Sales Representative",description:"Sales and customer management",color:"bg-blue-100 text-blue-800"},{id:"inventory_manager",name:"Inventory Manager",description:"Inventory and stock management",color:"bg-green-100 text-green-800"},{id:"packer",name:"Packer",description:"Order preparation and packing",color:"bg-yellow-100 text-yellow-800"},{id:"accountant",name:"Accountant",description:"Financial reports and accounting",color:"bg-indigo-100 text-indigo-800"},{id:"customer",name:"Customer",description:"Limited customer access",color:"bg-gray-100 text-gray-800"}];_.useEffect(()=>{t&&r()},[t,r]);const y=async()=>{if(t){o(!0);try{console.log("Resetting all users to default roles..."),await r(),alert("All users have been reset to their default role permissions.")}catch(L){console.error("Error resetting roles:",L),alert("Error resetting roles. Please try again.")}finally{o(!1)}}},f=L=>{if(u(L),v.find(M=>M.id===L)){const M=E(L);m(M);const V=A(L);I(V)}},E=L=>({admin:{role:"admin",permissions:i.map(M=>M.id),menuItems:["dashboard","orders","inventory","customers","sales","delivery","invoicing","reports","settings","help"],canAccessSettings:!0,canManageUsers:!0,canViewReports:!0,canManageInventory:!0,canManageOrders:!0,canManageCustomers:!0},business_owner:{role:"business_owner",permissions:i.map(M=>M.id),menuItems:["dashboard","orders","inventory","customers","sales","delivery","invoicing","reports","settings","help"],canAccessSettings:!0,canManageUsers:!0,canViewReports:!0,canManageInventory:!0,canManageOrders:!0,canManageCustomers:!0},sales_rep:{role:"sales_rep",permissions:["view_dashboard","view_orders","create_orders","edit_orders","view_customers","manage_customers","view_sales","create_sales","view_inventory"],menuItems:["dashboard","orders","customers","sales","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!0,canManageCustomers:!0},inventory_manager:{role:"inventory_manager",permissions:["view_dashboard","view_inventory","manage_inventory","view_stores","manage_stores","manage_transfers","view_orders","view_customers"],menuItems:["dashboard","inventory","orders","customers","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!0,canManageOrders:!1,canManageCustomers:!1},packer:{role:"packer",permissions:["view_dashboard","view_orders","edit_orders","prepare_orders","view_inventory","view_delivery","manage_delivery","view_settings"],menuItems:["dashboard","orders","preparation","delivery","settings","help"],canAccessSettings:!0,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!0,canManageCustomers:!1},accountant:{role:"accountant",permissions:["view_dashboard","view_orders","view_customers","view_sales","view_reports","view_financial_reports","view_inventory"],menuItems:["dashboard","orders","customers","sales","reports","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!0,canManageInventory:!1,canManageOrders:!1,canManageCustomers:!1},customer:{role:"customer",permissions:["view_dashboard","view_orders"],menuItems:["dashboard","orders","help"],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!1,canManageCustomers:!1}})[L]||{role:L,permissions:[],menuItems:[],canAccessSettings:!1,canManageUsers:!1,canViewReports:!1,canManageInventory:!1,canManageOrders:!1,canManageCustomers:!1},P=L=>{d&&m(U=>{if(!U)return U;const M=U.permissions.includes(L)?U.permissions.filter(V=>V!==L):[...U.permissions,L];return{...U,permissions:M}})},F=L=>{d&&m(U=>{if(!U)return U;const M=U.menuItems.includes(L)?U.menuItems.filter(V=>V!==L):[...U.menuItems,L];return{...U,menuItems:M}})},N=L=>{I(U=>U.includes(L)?U.filter(M=>M!==L):[...U,L])},w=()=>[...new Set(W.map(U=>U.category))],T=L=>W.filter(U=>U.category===L),A=L=>({admin:W.map(M=>M.id),business_owner:W.map(M=>M.id),sales_rep:["dashboard","orders-list","orders-create","orders-edit","customers-list","customers-accounts","sales-dashboard"],inventory_manager:["dashboard","inventory-main","inventory-products","inventory-stores","orders-list","customers-list"],packer:["dashboard","orders-list","preparation-queue","delivery-management"],accountant:["dashboard","orders-list","customers-list","sales-dashboard","reports-sales","reports-financial"],customer:["dashboard","orders-list"]})[L]||[],D=async()=>{if(d){x(!0);try{console.log("Saving role permissions:",d),await new Promise(L=>setTimeout(L,1e3)),alert("Role permissions updated successfully!"),u(null),m(null)}catch(L){console.error("Error saving role permissions:",L),alert("Error saving role permissions. Please try again.")}finally{x(!1)}}},C=()=>[...new Set(i.map(U=>U.category))],S=L=>i.filter(U=>U.category===L),H=[{id:"dashboard",name:"Dashboard"},{id:"orders",name:"Orders"},{id:"inventory",name:"Inventory"},{id:"customers",name:"Customers"},{id:"sales",name:"Sales"},{id:"preparation",name:"Preparation"},{id:"delivery",name:"Delivery"},{id:"invoicing",name:"Invoicing"},{id:"reports",name:"Reports"},{id:"settings",name:"Settings"},{id:"help",name:"Help"}],W=[{id:"dashboard",name:"Dashboard",description:"Main dashboard with overview statistics",category:"Main",requiredPermissions:["view_dashboard"]},{id:"orders-list",name:"Orders List",description:"View all orders and order management",category:"Orders",requiredPermissions:["view_orders"]},{id:"orders-create",name:"Create Order",description:"Create new orders",category:"Orders",requiredPermissions:["create_orders"]},{id:"orders-edit",name:"Edit Order",description:"Edit existing orders",category:"Orders",requiredPermissions:["edit_orders"]},{id:"orders-approve",name:"Approve Orders",description:"Approve pending orders",category:"Orders",requiredPermissions:["approve_orders"]},{id:"inventory-main",name:"Main Store",description:"Main store inventory management",category:"Inventory",requiredPermissions:["view_inventory"]},{id:"inventory-products",name:"Product Catalog",description:"Manage product catalog",category:"Inventory",requiredPermissions:["manage_inventory"]},{id:"inventory-stores",name:"Store Management",description:"Manage stores and locations",category:"Inventory",requiredPermissions:["manage_stores"]},{id:"customers-list",name:"Customer List",description:"View and manage customers",category:"Customers",requiredPermissions:["view_customers"]},{id:"customers-accounts",name:"Customer Accounts",description:"Manage customer accounts and credit",category:"Customers",requiredPermissions:["view_customer_accounts"]},{id:"sales-dashboard",name:"Sales Dashboard",description:"Sales overview and analytics",category:"Sales",requiredPermissions:["view_sales"]},{id:"preparation-queue",name:"Preparation Queue",description:"Order preparation and packing",category:"Preparation",requiredPermissions:["prepare_orders"]},{id:"delivery-management",name:"Delivery Management",description:"Manage deliveries and transport",category:"Delivery",requiredPermissions:["manage_delivery"]},{id:"reports-sales",name:"Sales Reports",description:"Generate and view sales reports",category:"Reports",requiredPermissions:["view_reports"]},{id:"reports-financial",name:"Financial Reports",description:"Financial reports and analytics",category:"Reports",requiredPermissions:["view_financial_reports"]},{id:"settings-users",name:"User Management",description:"Manage users and roles",category:"Settings",requiredPermissions:["manage_users"]},{id:"settings-system",name:"System Settings",description:"System configuration and settings",category:"Settings",requiredPermissions:["manage_system"]},{id:"settings-approvals",name:"Pending Approvals",description:"Manage pending user approvals",category:"Settings",requiredPermissions:["view_approvals"]}],re=L=>{const U=v.find(M=>M.id===L);return(U==null?void 0:U.color)||"bg-gray-100 text-gray-800"},ce=L=>({active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",suspended:"bg-red-100 text-red-800"})[L]||"bg-gray-100 text-gray-800";return n!=null&&n.canManageUsers?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Roles Management"}),s.jsx("p",{className:"text-gray-600",children:"Manage role permissions and access control for your business."})]}),s.jsx("button",{onClick:y,disabled:a,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:a?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Resetting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(cP,{className:"w-4 h-4 mr-2"}),"Reset to Default Roles"]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white shadow rounded-lg",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Available Roles"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Click on a role to configure its permissions"})]}),s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"space-y-3",children:v.map(L=>{const U=E(L.id),M=!1;return s.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${c===L.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,onClick:()=>f(L.id),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L.color}`,children:L.name}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:L.description}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:[U.permissions.length," permissions"]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[U.menuItems.length," menu items"]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[A(L.id).length," pages"]}),M]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[M,s.jsx(Pr,{className:"w-4 h-4 text-gray-400"})]})]})},L.id)})})})]}),c&&d&&s.jsxs("div",{className:"bg-white shadow rounded-lg",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Configure ",(O=v.find(L=>L.id===c))==null?void 0:O.name," Permissions"]}),s.jsx("p",{className:"text-sm text-gray-500",children:"Set what this role can access and do"}),s.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(ve,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Current Default Permissions"})]}),s.jsx("div",{className:"text-xs text-blue-700",children:s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Menu Access:"})," ",E(c).menuItems.length," items"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Permissions:"})," ",E(c).permissions.length," permissions"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Page Access:"})," ",A(c).length," pages"]})]})})]})]}),s.jsxs("div",{className:"p-6 space-y-6 max-h-96 overflow-y-auto",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Menu Access"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:H.map(L=>{const U=d.menuItems.includes(L.id),M=E(c).menuItems.includes(L.id);return s.jsxs("label",{className:`flex items-center space-x-2 p-2 border rounded hover:bg-gray-50 cursor-pointer ${M&&!U?"bg-blue-50 border-blue-200":""}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"checkbox",checked:U,onChange:()=>F(L.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),M&&s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-600 rounded-full flex items-center justify-center",children:s.jsx(ve,{className:"w-2 h-2 text-white"})})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm text-gray-700",children:L.name}),M&&s.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[s.jsx(ve,{className:"w-2 h-2 mr-1"}),"Default"]})]})]},L.id)})})]}),C().map(L=>s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:[L," Permissions"]}),s.jsx("div",{className:"space-y-2",children:S(L).map(U=>{const M=d.permissions.includes(U.id),V=E(c).permissions.includes(U.id);return s.jsxs("label",{className:`flex items-start space-x-3 p-3 border rounded hover:bg-gray-50 cursor-pointer ${V&&!M?"bg-blue-50 border-blue-200":""}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"checkbox",checked:M,onChange:()=>P(U.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mt-0.5"}),V&&s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-600 rounded-full flex items-center justify-center",children:s.jsx(ve,{className:"w-2 h-2 text-white"})})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.name}),V&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[s.jsx(ve,{className:"w-3 h-3 mr-1"}),"Default"]})]}),s.jsx("div",{className:"text-xs text-gray-500",children:U.description})]})]},U.id)})})]},L)),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Page Access Control"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Control which specific pages this role can access"})]}),s.jsxs("button",{onClick:()=>R(!b),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[b?"Hide":"Show"," Page Control"]})]}),b&&s.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ci,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"Page Access Control"})]}),s.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"This controls which specific pages users with this role can access. Users will only see pages they have permission to view."})]}),w().map(L=>s.jsxs("div",{children:[s.jsxs("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:[L," Pages"]}),s.jsx("div",{className:"space-y-2",children:T(L).map(U=>{const M=j.includes(U.id),V=A(c).includes(U.id);return s.jsxs("label",{className:`flex items-start space-x-3 p-3 border rounded hover:bg-gray-50 cursor-pointer ${V&&!M?"bg-blue-50 border-blue-200":""}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"checkbox",checked:M,onChange:()=>N(U.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mt-0.5"}),V&&s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-600 rounded-full flex items-center justify-center",children:s.jsx(ve,{className:"w-2 h-2 text-white"})})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.name}),V&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[s.jsx(ve,{className:"w-3 h-3 mr-1"}),"Default"]})]}),s.jsx("div",{className:"text-xs text-gray-500",children:U.description}),s.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Required: ",U.requiredPermissions.join(", ")]})]})]},U.id)})})]},L))]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[s.jsx("button",{onClick:()=>{u(null),m(null),I([]),R(!1)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),s.jsx("button",{onClick:D,disabled:p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:p?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Hr,{className:"w-4 h-4 mr-2"}),"Save Permissions"]})})]})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Business Users"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Current users and their assigned roles"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(L=>{var U;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:s.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx("span",{className:"text-sm font-medium text-blue-600",children:L.userName?L.userName.charAt(0).toUpperCase():L.userEmail.charAt(0).toUpperCase()})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:L.userName||"No Name"}),s.jsx("div",{className:"text-sm text-gray-500",children:L.userEmail})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${re(L.role)}`,children:((U=L.role)==null?void 0:U.replace("_"," ").toUpperCase())||"No Role"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ce(L.status)}`,children:L.status==="active"?s.jsxs(s.Fragment,{children:[s.jsx(ve,{className:"w-3 h-3 mr-1"}),"Active"]}):L.status==="pending"?s.jsxs(s.Fragment,{children:[s.jsx(Ci,{className:"w-3 h-3 mr-1"}),"Pending"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ci,{className:"w-3 h-3 mr-1"}),"Inactive"]})})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:L.joinedAt?new Date(L.joinedAt).toLocaleDateString():"Unknown"}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[s.jsx("button",{onClick:()=>f(L.role||"customer"),className:"text-blue-600 hover:text-blue-900 mr-3",children:"Edit Role"}),s.jsx("button",{className:"text-red-600 hover:text-red-900",children:"Remove"})]})]},L.id)})})]})})]})]}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx(FN,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600",children:"You don't have permission to manage roles and permissions."})]})})},tR=()=>{var y;const{userPermissions:t}=aa(),{currentBusiness:e}=$t(),{stores:r,fetchStores:n}=zt(),{businessUsers:i,fetchBusinessUsers:a}=na(),{currentUser:o}=Ar(),[c,u]=_.useState([]),[d]=_.useState(!1),[m,p]=_.useState(!1),[x,j]=_.useState(null),I=i.find(f=>f.userId===(o==null?void 0:o.uid));_.useEffect(()=>{e&&(n(),a())},[e,n,a]),_.useEffect(()=>{I!=null&&I.assignedStores&&u(I.assignedStores)},[I]);const b=f=>{u(E=>E.includes(f)?E.filter(P=>P!==f):[...E,f])},R=async()=>{if(!(!o||!I)){p(!0),j(null);try{console.log("Saving store assignments:",c),await new Promise(f=>setTimeout(f,1e3)),j({type:"success",text:"Store assignments updated successfully!"})}catch(f){console.error("Error saving settings:",f),j({type:"error",text:"Failed to save settings. Please try again."})}finally{p(!1)}}},v=()=>{if(!t)return null;switch(t.role){case"packer":return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(pt,{className:"w-5 h-5 text-blue-600 mr-2"}),s.jsx("h3",{className:"text-lg font-medium text-blue-900",children:"Store Assignments"})]}),s.jsx("p",{className:"text-blue-700 mt-2",children:"Select the stores where you operate. You'll be assigned orders that contain items from these stores."})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Available Stores"}),s.jsx("div",{className:"space-y-3",children:r.map(f=>s.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:c.includes(f.id),onChange:()=>b(f.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.name}),s.jsx("div",{className:"text-xs text-gray-500",children:f.address})]}),s.jsx("div",{className:"text-xs text-gray-400",children:c.includes(f.id)?s.jsxs("span",{className:"text-green-600 flex items-center",children:[s.jsx(ve,{className:"w-3 h-3 mr-1"}),"Assigned"]}):s.jsx("span",{className:"text-gray-400",children:"Not assigned"})})]},f.id))})]})]});case"inventory_manager":return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(pt,{className:"w-5 h-5 text-green-600 mr-2"}),s.jsx("h3",{className:"text-lg font-medium text-green-900",children:"Inventory Management"})]}),s.jsx("p",{className:"text-green-700 mt-2",children:"Manage inventory across all stores and oversee stock levels."})]}),s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Inventory manager settings will be implemented here."})]});case"sales_rep":return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Xt,{className:"w-5 h-5 text-purple-600 mr-2"}),s.jsx("h3",{className:"text-lg font-medium text-purple-900",children:"Sales Settings"})]}),s.jsx("p",{className:"text-purple-700 mt-2",children:"Configure your sales preferences and customer management settings."})]}),s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Sales representative settings will be implemented here."})]});default:return s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Role-specific settings are not available for your current role."})}};return d?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Role Settings"}),s.jsxs("p",{className:"text-gray-600 mt-2",children:["Configure settings specific to your role: ",(y=t==null?void 0:t.role)==null?void 0:y.replace("_"," ").toUpperCase()]})]}),(t==null?void 0:t.role)==="packer"&&s.jsxs("button",{onClick:R,disabled:m,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2 disabled:opacity-50",children:[s.jsx(Hr,{className:"w-4 h-4"}),s.jsx("span",{children:m?"Saving...":"Save Settings"})]})]}),x&&s.jsxs("div",{className:`p-4 rounded-lg flex items-center ${x.type==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:[x.type==="success"?s.jsx(ve,{className:"w-5 h-5 mr-2"}):s.jsx(Ci,{className:"w-5 h-5 mr-2"}),s.jsx("span",{children:x.text})]}),v()]})},rR=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"System Administration"}),s.jsx("p",{className:"text-gray-600",children:"Manage system settings and configuration"})]}),s.jsx("div",{className:"gradient-card rounded-xl p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(sp,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"System Settings"}),s.jsx("p",{className:"text-gray-600",children:"System configuration and administration will be implemented here"})]})})]}),sR=()=>s.jsxs(Wr,{children:[s.jsx(ee,{index:!0,element:s.jsx(rR,{})}),s.jsx(ee,{path:"approvals",element:s.jsx(JP,{})}),s.jsx(ee,{path:"users",element:s.jsx(eR,{})}),s.jsx(ee,{path:"my-role",element:s.jsx(tR,{})}),s.jsx(ee,{path:"system",element:s.jsx("div",{children:"System Settings"})}),s.jsx(ee,{path:"stores",element:s.jsx(XP,{})}),s.jsx(ee,{path:"order-approval",element:s.jsx(ZP,{})})]});function nR(){return s.jsx(gP,{children:s.jsx($A,{children:s.jsx(qA,{children:s.jsx(zA,{children:s.jsx(JA,{children:s.jsx(HA,{children:s.jsx(KA,{children:s.jsx(QA,{children:s.jsx(YA,{children:s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsxs(Wr,{children:[s.jsx(ee,{path:"/login",element:s.jsx(xP,{})}),s.jsx(ee,{path:"/register",element:s.jsx(yP,{})}),s.jsx(ee,{path:"/business-setup",element:s.jsx(vP,{})}),s.jsx(ee,{path:"/",element:s.jsx(Xs,{to:"/dashboard",replace:!0})}),s.jsxs(ee,{path:"/",element:s.jsx(dP,{children:s.jsx(fP,{})}),children:[s.jsx(ee,{path:"dashboard",element:s.jsx(wP,{})}),s.jsx(ee,{path:"orders/*",element:s.jsx(EP,{})}),s.jsx(ee,{path:"preparation/*",element:s.jsx(IP,{})}),s.jsx(ee,{path:"inventory/*",element:s.jsx(MP,{})}),s.jsx(ee,{path:"customers/*",element:s.jsx($P,{})}),s.jsx(ee,{path:"sales/*",element:s.jsx(qP,{})}),s.jsx(ee,{path:"transport/*",element:s.jsx(HP,{})}),s.jsx(ee,{path:"invoicing/*",element:s.jsx(GP,{})}),s.jsx(ee,{path:"reports/*",element:s.jsx(YP,{})}),s.jsx(ee,{path:"settings/*",element:s.jsx(sR,{})}),s.jsx(ee,{path:"help",element:s.jsx("div",{children:"Help & Support"})})]}),s.jsx(ee,{path:"*",element:s.jsx(Xs,{to:"/login",replace:!0})})]})})})})})})})})})})})}$d.createRoot(document.getElementById("root")).render(s.jsx(Q0.StrictMode,{children:s.jsx(B1,{children:s.jsx(nR,{})})}));
